
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

- **Rule 1**: **Modifiers containing terminal amino groups (-NH₂) on aliphatic chains of four or more carbons predict a high Fe/Hf value.**

  - *Explanation*: Compounds like **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, and **(2S)-6-acetamido-2-aminohexanoic acid** have amino groups at the end of long aliphatic chains, leading to high Fe/Hf values. These terminal amino groups can coordinate effectively with the metal sites, enhancing Fe incorporation.

- **Rule 2**: **Modifiers with sulfur-containing functional groups (e.g., thiol -SH, thioether -S-) predict a high Fe/Hf value.**

  - *Explanation*: Sulfur atoms have unshared electron pairs that can coordinate strongly with metal ions. Modifiers such as **4-sulfanylbenzoic acid**, **3-sulfanylpropanoic acid**, and the methionine derivative **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid** fit this rule and are associated with high Fe/Hf values.

- **Rule 3**: **Aromatic carboxylic acids substituted at the para position with strong electron-withdrawing groups (e.g., nitro, bromomethyl) predict a high Fe/Hf value.**

  - *Explanation*: Electron-withdrawing groups enhance the acidity of the carboxylic acid and can facilitate stronger interactions with metal sites. Modifiers like **4-nitrobenzoic acid** and **4-(bromomethyl)benzoic acid** have such substituents and correspond to high Fe/Hf values.

- **Rule 4**: **Aromatic carboxylic acids substituted at the para position with electron-donating groups (e.g., amino, hydroxy, alkyl groups) predict a low Fe/Hf value.**

  - *Explanation*: Electron-donating groups reduce the acidity of the carboxylic acid, leading to weaker coordination with metal ions. Modifiers such as **4-aminobenzoic acid**, **4-methylbenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, and **3-(4-hydroxyphenyl)propanoic acid** fit this rule and are associated with low Fe/Hf values.

- **Rule 5**: **Modifiers containing pyridine rings connected via the 4-position predict a high Fe/Hf value, whereas pyridine carboxylic acids predict a low Fe/Hf value.**

  - *Explanation*: Pyridine nitrogen can coordinate with metal centers. When connected through the 4-position, as in **4-pyridin-4-ylbenzoic acid** and **4-pyridin-4-ylbutanoic acid**, the pyridine ring is free to interact with Fe ions, leading to high Fe/Hf values. In **pyridine-3-carboxylic acid**, the nitrogen is adjacent to the carboxyl group, which may hinder coordination, resulting in a low Fe/Hf value.

- **Rule 6**: **Modifiers with fluorinated alkyl chains or perfluorinated groups predict a low Fe/Hf value.**

  - *Explanation*: Fluorinated groups are highly electronegative and can reduce the electron density available for coordination with metal ions. Compounds like **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid** and **4-[(2,2,2-trifluoroacetyl)amino]butanoic acid** fit this rule and correspond to low Fe/Hf values.

- **Rule 7**: **Simple aliphatic carboxylic acids without additional coordinating functional groups predict a low Fe/Hf value.**

  - *Explanation*: **Octanoic acid** and **4-oxoheptanedioic acid** lack functional groups that can strongly coordinate with metal ions beyond the carboxylic acid group, leading to low Fe/Hf values.

- **Rule 8**: **Modifiers with multiple hydroxyl groups (polyols) predict a low Fe/Hf value.**

  - *Explanation*: While hydroxyl groups can coordinate with metals, multiple hydroxyls increase steric hindrance and may lead to intramolecular hydrogen bonding, reducing availability for coordination. Examples include **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** and **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**.

- **Rule 9**: **Modifiers containing a remote hydroxyl group on a long aliphatic chain predict a high Fe/Hf value.**

  - *Explanation*: A hydroxyl group positioned away from the carboxylic acid can act as an additional coordination site without significant steric interference. **7-hydroxyheptanoic acid** fits this rule and is associated with a high Fe/Hf value.

- **Rule 10**: **Modifiers with aldehyde groups predict a low Fe/Hf value.**

  - *Explanation*: Aldehyde groups can be reactive and may not favor stable coordination with metal centers. Compounds like **4-formylbenzoic acid** and **5-formyl-2-hydroxybenzoic acid** correspond to low Fe/Hf values.

- **Rule 11**: **Amino acids with hydrophobic aromatic side chains predict a high Fe/Hf value, whereas those with polar or acidic side chains predict a low Fe/Hf value.**

  - *Explanation*: Hydrophobic aromatic groups can facilitate π-interactions with metal centers. **(2S)-2-amino-3-phenylpropanoic acid** (phenylalanine) predicts a high Fe/Hf value. In contrast, amino acids like **(2S)-2-aminopentanedioic acid** (glutamic acid) with acidic side chains predict low Fe/Hf values.

**End of Rules**---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11
0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,-1,0,0,-1
0,0,0,0,0,-1,-1,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0
1,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0
0,0,0,0,1,0,-1,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0
0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,-1,0
0,0,0,0,0,0,-1,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0
0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,-1,1,0,0
0,0,0,0,0,0,-1,-1,0,0,0
1,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.7428571428571429; Test Accuracy: 1.0
    Train Support: 0.2714285714285714; Test Support: 0.0
    Train Confidence: 0.7666666666666666; Test Confidence: 0.5
    Train Lift: 1.490740740740741; Test Lift: NONE
    Train Leverage: 0.08775510204081634; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for each rule
    
    # Rule 1: Modifiers containing terminal amino groups (-NH₂) on aliphatic chains of four or more carbons predict a high Fe/Hf value.
    # Since writing a SMARTS pattern for this rule is complex, we'll define a function to check it
    
    # Rule 2: Modifiers with sulfur-containing functional groups (e.g., thiol -SH, thioether -S-)
    thiol_pattern = Chem.MolFromSmarts('[SX2H]')
    thioether_pattern = Chem.MolFromSmarts('[#6][SX2][#6]')
    
    # Rule 3: Aromatic carboxylic acids substituted at the para position with strong electron-withdrawing groups (e.g., nitro, bromomethyl)
    ewg_patterns = [
        Chem.MolFromSmarts('c1ccc(cc1)C(=O)O'),  # Aromatic carboxylic acid
        Chem.MolFromSmarts('c1ccc(cc1)[N+](=O)[O-]'),  # Nitro group
        Chem.MolFromSmarts('c1ccc(cc1)CBr'),  # Bromomethyl group
    ]
    
    # Rule 4: Aromatic carboxylic acids substituted at the para position with electron-donating groups (e.g., amino, hydroxy, alkyl groups)
    edg_patterns = [
        Chem.MolFromSmarts('c1ccc(cc1)C(=O)O'),  # Aromatic carboxylic acid
        Chem.MolFromSmarts('c1ccc(cc1)N'),  # Amino group
        Chem.MolFromSmarts('c1ccc(cc1)O'),  # Hydroxy group
        Chem.MolFromSmarts('c1ccc(cc1)C'),  # Alkyl group
    ]
    
    # Rule 5: Modifiers containing pyridine rings connected via the 4-position predict a high Fe/Hf value, whereas pyridine carboxylic acids predict a low Fe/Hf value.
    pyridine_ring_pattern = Chem.MolFromSmarts('c1ccncc1')  # Pyridine ring
    pyridine_carboxylic_acid_pattern = Chem.MolFromSmarts('c1cncc1C(=O)O')
    
    # Rule 6: Modifiers with fluorinated alkyl chains or perfluorinated groups predict a low Fe/Hf value.
    fluorinated_pattern = Chem.MolFromSmarts('[CX4][F,Cl,Br,I]')
    
    # Rule 7: Simple aliphatic carboxylic acids without additional coordinating functional groups predict a low Fe/Hf value.
    aliphatic_carboxylic_acid_pattern = Chem.MolFromSmarts('C(=O)O')  # Carboxylic acid
    exclude_patterns_rule7 = [
        Chem.MolFromSmarts('[NX3]'),  # Amines
        Chem.MolFromSmarts('[OX2][CX4]'),  # Ethers
        Chem.MolFromSmarts('[SX2]'),  # Sulfur groups
    ]
    
    # Rule 8: Modifiers with multiple hydroxyl groups (polyols) predict a low Fe/Hf value.
    hydroxyl_pattern = Chem.MolFromSmarts('[OX2H]')
    
    # Rule 9: Modifiers containing a remote hydroxyl group on a long aliphatic chain predict a high Fe/Hf value.
    remote_hydroxyl_pattern = Chem.MolFromSmarts('[CX4][CX4][CX4][CX4][CX4][CX4][OX2H]')
    
    # Rule 10: Modifiers with aldehyde groups predict a low Fe/Hf value.
    aldehyde_pattern = Chem.MolFromSmarts('[CX3H]=O')
    
    # Rule 11: Amino acids with hydrophobic aromatic side chains predict a high Fe/Hf value, whereas those with polar or acidic side chains predict a low Fe/Hf value.
    aromatic_amino_acid_pattern = Chem.MolFromSmarts('N[C@@H](CC1=CC=CC=C1)C(=O)O')  # Phenylalanine
    polar_amino_acid_pattern = Chem.MolFromSmarts('N[C@@H](CCC(=O)O)C(=O)O')  # Glutamic acid
    
    # Initialize results list
    results = []
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If molecule cannot be parsed, append zeros
            results.append([0]*11)
            continue
        row = []
        
        # Rule 1
        def check_rule1(mol):
            found = False
            for atom in mol.GetAtoms():
                if atom.GetAtomicNum() == 7 and atom.GetDegree() == 1 and atom.GetTotalNumHs() == 2:
                    # Terminal NH2 group
                    neighbor = atom.GetNeighbors()[0]
                    if neighbor.GetAtomicNum() == 6:
                        chain_length = 1
                        current_atom = neighbor
                        visited = set([atom.GetIdx()])
                        while True:
                            neighbors = [a for a in current_atom.GetNeighbors() if a.GetAtomicNum() == 6 and a.GetIdx() not in visited]
                            if neighbors:
                                chain_length += 1
                                visited.add(current_atom.GetIdx())
                                current_atom = neighbors[0]
                            else:
                                break
                        if chain_length >= 4:
                            found = True
                            break
            return found
        if check_rule1(mol):
            row.append(1)
        else:
            row.append(0)
        
        # Rule 2
        if mol.HasSubstructMatch(thiol_pattern) or mol.HasSubstructMatch(thioether_pattern):
            row.append(1)
        else:
            row.append(0)
        
        # Rule 3
        match_rule3 = all([mol.HasSubstructMatch(pat) for pat in ewg_patterns])
        if match_rule3:
            row.append(1)
        else:
            row.append(0)
        
        # Rule 4
        match_rule4 = all([mol.HasSubstructMatch(pat) for pat in edg_patterns])
        if match_rule4:
            row.append(-1)
        else:
            row.append(0)
        
        # Rule 5
        if mol.HasSubstructMatch(pyridine_ring_pattern) and not mol.HasSubstructMatch(pyridine_carboxylic_acid_pattern):
            row.append(1)
        elif mol.HasSubstructMatch(pyridine_carboxylic_acid_pattern):
            row.append(-1)
        else:
            row.append(0)
        
        # Rule 6
        if mol.HasSubstructMatch(fluorinated_pattern):
            row.append(-1)
        else:
            row.append(0)
        
        # Rule 7
        if mol.HasSubstructMatch(aliphatic_carboxylic_acid_pattern):
            exclude = False
            for ex_pat in exclude_patterns_rule7:
                if mol.HasSubstructMatch(ex_pat):
                    exclude = True
                    break
            if not exclude:
                row.append(-1)
            else:
                row.append(0)
        else:
            row.append(0)
        
        # Rule 8
        hydroxyl_matches = mol.GetSubstructMatches(hydroxyl_pattern)
        if len(hydroxyl_matches) >= 2:
            row.append(-1)
        else:
            row.append(0)
        
        # Rule 9
        if mol.HasSubstructMatch(remote_hydroxyl_pattern):
            row.append(1)
        else:
            row.append(0)
        
        # Rule 10
        if mol.HasSubstructMatch(aldehyde_pattern):
            row.append(-1)
        else:
            row.append(0)
        
        # Rule 11
        if mol.HasSubstructMatch(aromatic_amino_acid_pattern):
            row.append(1)
        elif mol.HasSubstructMatch(polar_amino_acid_pattern):
            row.append(-1)
        else:
            row.append(0)
        
        results.append(row)
    # Create DataFrame
    df = pd.DataFrame(results, columns=[f'Rule {i+1}' for i in range(11)])
    return df
--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

- **Rule 1**: **Modifiers with terminal amino groups (-NH₂) on linear aliphatic chains of five or more carbons predict a high Fe/Hf value.**

  - *Explanation*: Compounds such as **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, and **(2S)-6-acetamido-2-aminohexanoic acid** have amino groups at the end of extended carbon chains. These terminal amino groups can effectively coordinate with metal sites, enhancing the incorporation of Fe ions and leading to high Fe/Hf ratios.

- **Rule 2**: **Modifiers containing sulfur-containing functional groups like thiols (-SH) or thioethers (-S-) predict a high Fe/Hf value.**

  - *Explanation*: Sulfur atoms have lone electron pairs that can form strong coordinate bonds with metal ions. Modifiers such as **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, and **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid** contain sulfur functionalities that enhance Fe coordination, resulting in high Fe/Hf values.

- **Rule 3**: **Aromatic carboxylic acids with electron-withdrawing groups (e.g., nitro, halogens) at the para position predict a high Fe/Hf value.**

  - *Explanation*: Electron-withdrawing substituents like **nitro (-NO₂)** in **4-nitrobenzoic acid** and **bromomethyl (-CH₂Br)** in **4-(bromomethyl)benzoic acid** increase the acidity of the carboxylic acid, facilitating stronger coordination with metal ions and leading to higher Fe/Hf ratios.

- **Rule 4**: **Modifiers featuring pyridine rings connected via the para position predict a high Fe/Hf value.**

  - *Explanation*: Pyridine nitrogen atoms can serve as excellent coordination sites for metal ions. Modifiers like **4-pyridin-4-ylbenzoic acid** and **4-pyridin-4-ylbutanoic acid** have pyridine rings linked in a way that allows the nitrogen to coordinate effectively with Fe, resulting in high Fe/Hf values.

- **Rule 5**: **Modifiers with remote hydroxyl groups (-OH) on long aliphatic chains predict a high Fe/Hf value.**

  - *Explanation*: A hydroxyl group positioned away from the carboxylic acid can act as an additional coordination site without causing steric hindrance. **7-hydroxyheptanoic acid** is an example where the remote hydroxyl enhances metal coordination, leading to a high Fe/Hf ratio.

- **Rule 6**: **Amino acids with hydrophobic aromatic side chains predict a high Fe/Hf value.**

  - *Explanation*: Hydrophobic aromatic groups can engage in π-interactions with metal centers, facilitating coordination. **(2S)-2-amino-3-phenylpropanoic acid** (phenylalanine) has a benzyl side chain that enhances Fe incorporation, resulting in a high Fe/Hf value.

- **Rule 7**: **Modifiers containing electron-donating groups (e.g., amino, hydroxy, methyl) at the para position of aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: Electron-donating substituents reduce the acidity of the carboxylic acid group, weakening its ability to coordinate with metal ions. Examples include **4-aminobenzoic acid**, **4-methylbenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, and **3-(4-hydroxyphenyl)propanoic acid**, all associated with low Fe/Hf values.

- **Rule 8**: **Modifiers with multiple hydroxyl groups (polyhydroxylated compounds) predict a low Fe/Hf value.**

  - *Explanation*: While hydroxyl groups can coordinate with metals, multiple hydroxyls can lead to intramolecular hydrogen bonding and steric hindrance, reducing their availability for metal coordination. Compounds like **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** and **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid** fall into this category, resulting in low Fe/Hf ratios.

- **Rule 9**: **Modifiers containing fluorinated alkyl chains or perfluoroalkyl groups predict a low Fe/Hf value.**

  - *Explanation*: Fluorinated groups are highly electronegative and can withdraw electron density, impairing the ability of functional groups to coordinate with metal ions. **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid** and **4-[(2,2,2-trifluoroacetyl)amino]butanoic acid** are examples that correspond to low Fe/Hf values.

- **Rule 10**: **Simple aliphatic carboxylic acids lacking additional coordinating functional groups predict a low Fe/Hf value.**

  - *Explanation*: Without functional groups capable of strong coordination, such as amino or sulfur-containing groups, these modifiers have limited interaction with metal ions. **Octanoic acid** and **4-oxoheptanedioic acid** are examples associated with low Fe/Hf ratios.

- **Rule 11**: **Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: Aldehyde groups can engage in competing reactions or reduce coordination efficacy due to their reactivity. Compounds like **4-formylbenzoic acid** and **5-formyl-2-hydroxybenzoic acid** fall under this rule and exhibit low Fe/Hf values.

- **Rule 12**: **Modifiers containing heterocyclic rings with adjacent nitrogen and carboxyl groups predict a low Fe/Hf value.**

  - *Explanation*: Steric hindrance and electron distribution in heterocycles like **pyridine-3-carboxylic acid** and **1H-pyrazole-4-carboxylic acid** may impede effective coordination with metal ions, resulting in low Fe/Hf ratios.

- **Rule 13**: **Modifiers with amide functionalities adjacent to aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: The resonance of the amide group can delocalize electron density, reducing the availability of lone pairs for metal coordination. An example is **2-[(4-hydroxybenzoyl)amino]acetic acid**, which shows a low Fe/Hf value.

**End of Rules**---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,-1
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6857142857142857; Test Accuracy: 1.0
    Train Support: 0.05142857142857143; Test Support: 0.0
    Train Confidence: 1.0; Test Confidence: 0.5
    Train Lift: 1.9673202614379086; Test Lift: NONE
    Train Leverage: 0.025306122448979597; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    """
    This function takes a list of SMILES strings and returns a DataFrame where each column represents a rule and each row corresponds to a SMILES string. Each cell contains 1 if the SMILES matches the rule and predicts a high target value, -1 if the SMILES matches the rule and predicts a low target value, and 0 otherwise.
    """

    # Define the rules with their associated SMARTS patterns and predictions
    rules = []
    
    # Rule 1: Modifiers with terminal amino groups (-NH2) on linear aliphatic chains of five or more carbons predict a high Fe/Hf value.
    # Using a SMARTS pattern to match terminal primary amine connected via a linear chain of at least five carbons to a carboxylic acid
    rule1_pattern = '[NX3;H2][CH2]{5,}[CX3](=O)[OX1H1]'
    rules.append({
        'number': 1,
        'description': 'Modifiers with terminal amino groups (-NH2) on linear aliphatic chains of five or more carbons predict a high Fe/Hf value.',
        'patterns': [rule1_pattern],
        'prediction': 1
    })

    # Rule 2: Modifiers containing sulfur-containing functional groups like thiols (-SH) or thioethers (-S-)
    # Including both thiol and thioether patterns comprehensively
    rule2_patterns = ['[SX2H]', '[SX2][#6]']  # Thiol and thioether
    rules.append({
        'number': 2,
        'description': 'Modifiers containing sulfur-containing functional groups like thiols (-SH) or thioethers (-S-) predict a high Fe/Hf value.',
        'patterns': rule2_patterns,
        'prediction': 1
    })

    # Rule 3: Aromatic carboxylic acids with electron-withdrawing groups at the para position
    # Expanded list of electron-withdrawing groups and accurate positioning
    ewg_groups = ['[N+](=O)[O-]', '[F]', '[Cl]', '[Br]', '[I]', '[CX3H1](=O)', '[C]#[N]', '[S](=O)(=O)[#6]', '[CX3](F)(F)F']
    rule3_patterns = []
    for ewg in ewg_groups:
        pattern = 'c1ccc('+ewg+')cc1C(=O)O'
        rule3_patterns.append(pattern)
    rules.append({
        'number': 3,
        'description': 'Aromatic carboxylic acids with electron-withdrawing groups (e.g., nitro, halogens) at the para position predict a high Fe/Hf value.',
        'patterns': rule3_patterns,
        'prediction': 1
    })
    
    # Rule 4: Modifiers featuring pyridine rings connected via the para position
    rule4_pattern = 'c1ccc(cc1)C2=CC=NC=C2'  # Benzene ring connected to pyridine ring
    rules.append({
        'number': 4,
        'description': 'Modifiers featuring pyridine rings connected via the para position predict a high Fe/Hf value.',
        'patterns': [rule4_pattern],
        'prediction': 1
    })

    # Rule 5: Modifiers with remote hydroxyl groups (-OH) on long aliphatic chains
    # Adjusted pattern to allow for chains of variable length beyond three carbons
    rule5_pattern = '[OX2H][CH2]{3,}[CX3](=O)[OX1H1]'
    rules.append({
        'number': 5,
        'description': 'Modifiers with remote hydroxyl groups (-OH) on long aliphatic chains predict a high Fe/Hf value.',
        'patterns': [rule5_pattern],
        'prediction': 1
    })

    # Rule 6: Amino acids with hydrophobic aromatic side chains
    # Generalized pattern to include any amino acid with an aromatic side chain
    rule6_pattern = '[NX3;H2][CX4H]([CX4][c])[CX3](=O)[OX1H1]'
    rules.append({
        'number': 6,
        'description': 'Amino acids with hydrophobic aromatic side chains predict a high Fe/Hf value.',
        'patterns': [rule6_pattern],
        'prediction': 1
    })

    # Rule 7: Modifiers with electron-donating groups at the para position of aromatic rings
    # Expanded EDG list and ensured correct para substitution
    edg_groups = ['[NH2]', '[OH]', '[OCH3]', '[CH3]']  # Amino, hydroxyl, methoxy, methyl
    rule7_patterns = []
    for edg in edg_groups:
        pattern = 'c1ccc('+edg+')cc1C(=O)O'
        rule7_patterns.append(pattern)
    rules.append({
        'number': 7,
        'description': 'Modifiers with electron-donating groups (e.g., amino, hydroxy, methyl) at the para position of aromatic rings predict a low Fe/Hf value.',
        'patterns': rule7_patterns,
        'prediction': -1
    })

    # Rule 8: Modifiers with multiple hydroxyl groups (polyhydroxylated compounds)
    # Modified pattern to include phenolic OH groups
    def matches_rule8(mol):
        hydroxyl_pattern = Chem.MolFromSmarts('[OX2H]')
        matches = mol.GetSubstructMatches(hydroxyl_pattern, uniquify=False)
        if len(matches) >= 3:
            return True
        else:
            return False
    rules.append({
        'number': 8,
        'description': 'Modifiers with multiple hydroxyl groups predict a low Fe/Hf value.',
        'function': matches_rule8,
        'prediction': -1
    })

    # Rule 9: Modifiers containing fluorinated alkyl chains or perfluoroalkyl groups
    # Used a more general pattern to match perfluoroalkyl chains
    rule9_pattern = '[CX4]([F])([F])[F]'
    rules.append({
        'number': 9,
        'description': 'Modifiers containing fluorinated alkyl chains or perfluoroalkyl groups predict a low Fe/Hf value.',
        'patterns': [rule9_pattern],
        'prediction': -1
    })

    # Rule 10: Simple aliphatic carboxylic acids lacking additional coordinating functional groups
    # Expanded exclude list to include other coordinating groups
    exclude_groups_rule10 = ['[NX3]', '[OX2H]', '[SX2]', '[c]', '[PX4]', '[Cl]', '[Br]', '[I]', '[F]', '[S]', '[P]']  # Exclude amines, hydroxyls, thiols, aromatics, halogens, sulfur, phosphorus
    rules.append({
        'number': 10,
        'description': 'Simple aliphatic carboxylic acids lacking additional coordinating functional groups predict a low Fe/Hf value.',
        'patterns': ['[CX3](=O)[OX1H1]'],
        'exclude_patterns': exclude_groups_rule10,
        'prediction': -1
    })

    # Rule 11: Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings
    # Adjusted pattern to match aldehyde directly attached to aromatic ring
    rule11_pattern = 'c[CH]=O'
    rules.append({
        'number': 11,
        'description': 'Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings predict a low Fe/Hf value.',
        'patterns': [rule11_pattern],
        'prediction': -1
    })

    # Rule 12: Modifiers containing heterocyclic rings with adjacent nitrogen and carboxyl groups
    # Generalized patterns to include other heterocycles
    rule12_patterns = ['[n][c][c](C(=O)O)[c][c]', '[n][c](C(=O)O)[c][c][c]']
    rules.append({
        'number': 12,
        'description': 'Modifiers containing heterocyclic rings with adjacent nitrogen and carboxyl groups predict a low Fe/Hf value.',
        'patterns': rule12_patterns,
        'prediction': -1
    })

    # Rule 13: Modifiers with amide functionalities adjacent to aromatic rings
    # Used a more general pattern
    rule13_pattern = 'cC(=O)N'
    rules.append({
        'number': 13,
        'description': 'Modifiers with amide functionalities adjacent to aromatic rings predict a low Fe/Hf value.',
        'patterns': [rule13_pattern],
        'prediction': -1
    })

    # Compile SMARTS patterns
    for rule in rules:
        if 'patterns' in rule:
            rule['compiled_patterns'] = [Chem.MolFromSmarts(pat) for pat in rule['patterns']]
        if 'exclude_patterns' in rule:
            rule['compiled_exclude_patterns'] = [Chem.MolFromSmarts(pat) for pat in rule['exclude_patterns']]

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        # Standardize molecule
        Chem.SanitizeMol(mol)
        row = []
        for rule in rules:
            try:
                match = False
                if 'function' in rule:
                    # Use custom function for matching
                    match = rule['function'](mol)
                else:
                    # Check exclude patterns if any
                    if 'compiled_exclude_patterns' in rule:
                        for epat in rule['compiled_exclude_patterns']:
                            if mol.HasSubstructMatch(epat):
                                match = False
                                break
                        else:
                            match = True
                    else:
                        match = True
                    if match:
                        # Check required patterns
                        for pat in rule['compiled_patterns']:
                            if mol.HasSubstructMatch(pat):
                                match = True
                            else:
                                match = False
                                break
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception:
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f"Rule {rule['number']}" for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

- **Rule 1**: **Modifiers with terminal amino groups (-NH₂) on linear aliphatic chains of five or more carbons predict a high Fe/Hf value.**

  - *Explanation*: Compounds such as **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, and **(2S)-6-acetamido-2-aminohexanoic acid** have terminal amino groups on extended aliphatic chains. The amino group can effectively coordinate with metal sites, enhancing the incorporation of Fe ions into the catalyst, leading to high Fe/Hf ratios.

- **Rule 2**: **Modifiers containing sulfur functional groups, such as thiols (-SH) or thioethers (-S-), predict a high Fe/Hf value.**

  - *Explanation*: Sulfur atoms provide lone pair electrons that can strongly coordinate with metal ions, particularly Fe. Examples include **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, and **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**. The presence of sulfur enhances Fe coordination, resulting in high Fe/Hf values.

- **Rule 3**: **Aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro, bromomethyl) at the para position predict a high Fe/Hf value.**

  - *Explanation*: Electron-withdrawing groups increase the acidity of the carboxylic acid, facilitating stronger coordination with metal ions. Compounds like **4-nitrobenzoic acid** and **4-(bromomethyl)benzoic acid** fit this rule and exhibit high Fe/Hf ratios due to enhanced metal-binding capabilities.

- **Rule 4**: **Modifiers containing pyridine rings connected via the para position predict a high Fe/Hf value.**

  - *Explanation*: The nitrogen atom in the pyridine ring has a lone pair that can effectively coordinate with metal ions. Modifiers such as **4-pyridin-4-ylbenzoic acid** and **4-pyridin-4-ylbutanoic acid** have pyridine rings linked in a way that allows the nitrogen to coordinate with Fe, leading to high Fe/Hf values.

- **Rule 5**: **Modifiers with amino acids possessing sulfur-containing side chains predict a high Fe/Hf value.**

  - *Explanation*: Amino acids like **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid** (a derivative of methionine) contain sulfur in their side chains. The sulfur atom enhances coordination with Fe ions due to its ability to donate electron density, resulting in high Fe/Hf values.

- **Rule 6**: **Modifiers with terminal hydroxyl groups (-OH) on long aliphatic chains (seven or more carbons) predict a high Fe/Hf value.**

  - *Explanation*: Remote hydroxyl groups can act as additional coordination sites without causing significant steric hindrance. **7-hydroxyheptanoic acid** is an example where the hydroxyl group facilitates Fe coordination, leading to a high Fe/Hf ratio.

- **Rule 7**: **Modifiers with electron-donating groups (e.g., amino, hydroxy, methyl) at the para position of aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: Electron-donating substituents decrease the acidity of the carboxylic acid group, weakening its ability to coordinate with metal ions. Examples include **4-aminobenzoic acid**, **4-methylbenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, and **3-(4-hydroxyphenyl)propanoic acid**, all associated with low Fe/Hf values due to reduced coordination efficacy.

- **Rule 8**: **Modifiers with multiple hydroxyl groups (polyhydroxylated compounds) predict a low Fe/Hf value.**

  - *Explanation*: While individual hydroxyl groups can coordinate with metals, multiple hydroxyls can lead to intramolecular hydrogen bonding and steric hindrance, reducing their availability for metal coordination. Compounds like **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** and **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid** fall into this category, resulting in low Fe/Hf ratios.

- **Rule 9**: **Modifiers with perfluorinated alkyl chains or trifluoromethyl groups predict a low Fe/Hf value.**

  - *Explanation*: The strong electronegativity of fluorine atoms withdraws electron density, impairing the ability of coordinating groups to donate electrons to metal ions. Examples are **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid** and **4-[(2,2,2-trifluoroacetyl)amino]butanoic acid**, which lead to low Fe/Hf values due to reduced coordination propensity.

- **Rule 10**: **Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: Aldehyde groups are reactive and may engage in side reactions or reduce the effective coordination with metal ions. Compounds like **4-formylbenzoic acid** and **5-formyl-2-hydroxybenzoic acid** exhibit low Fe/Hf values because the aldehyde can hinder metal binding.

- **Rule 11**: **Modifiers with heterocyclic rings containing nitrogen adjacent to carboxylic acid predict a low Fe/Hf value if the nitrogen is not easily accessible for coordination.**

  - *Explanation*: In compounds like **pyridine-3-carboxylic acid** and **1H-pyrazole-4-carboxylic acid**, the nitrogen atom may not be favorably positioned for effective coordination with Fe ions due to steric hindrance or electronic factors, leading to low Fe/Hf ratios.

- **Rule 12**: **Modifiers with amide groups adjacent to aromatic rings predict a low Fe/Hf value.**

  - *Explanation*: The resonance stabilization in amide groups delocalizes the lone pair electrons on the nitrogen, reducing their availability for coordination with metal ions. **2-[(4-hydroxybenzoyl)amino]acetic acid** is an example associated with low Fe/Hf ratios due to diminished coordination capability.

- **Rule 13**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.**

  - *Explanation*: Without functional groups capable of strong coordination (e.g., amino, sulfur, or aromatic nitrogen), these modifiers have limited interaction with Fe ions. **Octanoic acid** and **4-oxoheptanedioic acid** are examples that correspond to low Fe/Hf values due to the lack of coordinating sites.

- **Rule 14**: **Modifiers with non-conjugated ketone groups adjacent to carboxylic acids predict a low Fe/Hf value.**

  - *Explanation*: Ketone groups near carboxylic acids can form stable chelate rings with metal ions, but may not favor Fe incorporation into the catalyst. **4-oxoheptanedioic acid** demonstrates this behavior, resulting in a low Fe/Hf ratio.

- **Rule 15**: **Modifiers with bulky or rigid hydrophobic side chains on amino acids tend to predict a low Fe/Hf value.**

  - *Explanation*: Bulky hydrophobic side chains, such as the indole group in **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan), may hinder coordination due to steric effects, leading to reduced Fe incorporation and a low Fe/Hf value.

**End of Rules**---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6857142857142857; Test Accuracy: 1.0
    Train Support: 0.05238095238095238; Test Support: 0.0
    Train Confidence: 1.0; Test Confidence: 0.5
    Train Lift: 1.9825708061002179; Test Lift: NONE
    Train Leverage: 0.02598639455782313; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups based on the rules
    
    # Rule 1: Terminal amino groups (-NH2) on linear aliphatic chains of five or more carbons
    primary_amino_chain = '[NX3;H2][CH2]{4,}[CH3]'
    
    # Rule 2: Sulfur functional groups, such as thiols (-SH) or thioethers (-S-)
    thiol = '[SX2H]'
    thioether = '[#6][SX2][#6]'
    
    # Rule 3: Aromatic carboxylic acids with strong electron-withdrawing groups at the para position
    aromatic_nitro_para = '[cH]1ccc([N+](=O)[O-])cc1C(=O)[O,H]'
    aromatic_bromo_para = '[cH]1ccc(Br)cc1C(=O)[O,H]'
    aromatic_bromomethyl_para = '[cH]1ccc(CBr)cc1C(=O)[O,H]'
    
    # Rule 4: Pyridine rings connected via the para position
    pyridine_para = '[c]1ccc([c]2ccncc2)cc1'
    
    # Rule 5: Amino acids possessing sulfur-containing side chains
    sulfur_amino_acid = '[NX3;H2][CX4;!$(C=O)]{0,1}[CX4][SX2][CX4]'
    
    # Rule 6: Terminal hydroxyl groups (-OH) on long aliphatic chains (seven or more carbons)
    terminal_hydroxyl_chain = '[OX2H][CH2]{6,}[CH3]'
    
    # Rule 7: Electron-donating groups at the para position of aromatic rings
    aromatic_edg_para = '[cH]1ccc([NX3H2,OX2H,CH3])cc1C(=O)[O,H]'
    
    # Rule 8: Multiple hydroxyl groups (polyhydroxylated compounds)
    multiple_hydroxyls = '[OX2H]'
    
    # Rule 9: Perfluorinated alkyl chains or trifluoromethyl groups
    trifluoromethyl = '[CX4](F)(F)F'
    perfluoro_alkyl = '[CX4](F)(F)[CX4](F)(F)F'
    longer_perfluoro_alkyl = '[CX4](F)(F)[CX4](F)(F)[CX4](F)(F)F'
    
    # Rule 10: Aldehyde groups (-CHO) adjacent to aromatic rings
    aromatic_aldehyde = '[c][CX3H]=O'
    
    # Rule 11: Heterocyclic rings containing nitrogen adjacent to carboxylic acid
    heterocyclic_nitrogen_carboxy = '[n][a][a][a][CX3](=O)[OX2H1]'
    
    # Rule 12: Amide groups adjacent to aromatic rings
    aromatic_amide = '[c][CX3](=O)[NX3;H]'
    
    # Rule 13: Simple aliphatic carboxylic acids without additional coordinating groups
    simple_aliphatic_acid = '[CX4;H3][CH2]{2,}[CX3](=O)[OX2H1]'
    exclude_coordination_sites = ['[NX3;!$(N=C)]', '[OX2H]', '[SX2]', '[c]']
    
    # Rule 14: Non-conjugated ketone groups adjacent to carboxylic acids
    ketone_adjacent_carboxy = '[CX3](=O)[CX2][CX3](=O)[OX2H1]'
    
    # Rule 15: Bulky or rigid hydrophobic side chains on amino acids
    bulky_amino_acid = '[NX3][CX4H]([CX3](=O)[OX2H1])[CX4](C)[c]'
    
    # Compile all patterns into the rules
    rules = [
        {
            'number': 1,
            'description': 'Modifiers with terminal amino groups (-NH2) on linear aliphatic chains of five or more carbons predict a high Fe/Hf value.',
            'patterns': [primary_amino_chain],
            'prediction': 1,
        },
        {
            'number': 2,
            'description': 'Modifiers containing sulfur functional groups, such as thiols (-SH) or thioethers (-S-), predict a high Fe/Hf value.',
            'patterns': [thiol, thioether],
            'prediction': 1,
        },
        {
            'number': 3,
            'description': 'Aromatic carboxylic acids with strong electron-withdrawing groups at the para position predict a high Fe/Hf value.',
            'patterns': [aromatic_nitro_para, aromatic_bromo_para, aromatic_bromomethyl_para],
            'prediction': 1,
        },
        {
            'number': 4,
            'description': 'Modifiers containing pyridine rings connected via the para position predict a high Fe/Hf value.',
            'patterns': [pyridine_para],
            'prediction': 1,
        },
        {
            'number': 5,
            'description': 'Modifiers with amino acids possessing sulfur-containing side chains predict a high Fe/Hf value.',
            'patterns': [sulfur_amino_acid],
            'prediction': 1,
        },
        {
            'number': 6,
            'description': 'Modifiers with terminal hydroxyl groups (-OH) on long aliphatic chains (seven or more carbons) predict a high Fe/Hf value.',
            'patterns': [terminal_hydroxyl_chain],
            'prediction': 1,
        },
        {
            'number': 7,
            'description': 'Modifiers with electron-donating groups at the para position of aromatic rings predict a low Fe/Hf value.',
            'patterns': [aromatic_edg_para],
            'prediction': -1,
        },
        {
            'number': 8,
            'description': 'Modifiers with multiple hydroxyl groups (polyhydroxylated compounds) predict a low Fe/Hf value.',
            'patterns': [multiple_hydroxyls],
            'count_threshold': {'[OX2H]': 2},
            'prediction': -1,
        },
        {
            'number': 9,
            'description': 'Modifiers with perfluorinated alkyl chains or trifluoromethyl groups predict a low Fe/Hf value.',
            'patterns': [trifluoromethyl, perfluoro_alkyl, longer_perfluoro_alkyl],
            'prediction': -1,
        },
        {
            'number': 10,
            'description': 'Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings predict a low Fe/Hf value.',
            'patterns': [aromatic_aldehyde],
            'prediction': -1,
        },
        {
            'number': 11,
            'description': 'Modifiers with heterocyclic rings containing nitrogen adjacent to carboxylic acid predict a low Fe/Hf value if the nitrogen is not easily accessible for coordination.',
            'patterns': [heterocyclic_nitrogen_carboxy],
            'prediction': -1,
        },
        {
            'number': 12,
            'description': 'Modifiers with amide groups adjacent to aromatic rings predict a low Fe/Hf value.',
            'patterns': [aromatic_amide],
            'prediction': -1,
        },
        {
            'number': 13,
            'description': 'Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.',
            'patterns': [simple_aliphatic_acid],
            'exclude_patterns': exclude_coordination_sites,
            'prediction': -1,
        },
        {
            'number': 14,
            'description': 'Modifiers with non-conjugated ketone groups adjacent to carboxylic acids predict a low Fe/Hf value.',
            'patterns': [ketone_adjacent_carboxy],
            'prediction': -1,
        },
        {
            'number': 15,
            'description': 'Modifiers with bulky or rigid hydrophobic side chains on amino acids tend to predict a low Fe/Hf value.',
            'patterns': [bulky_amino_acid],
            'prediction': -1,
        },
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for smarts in rule.get('patterns', []):
            try:
                pat = Chem.MolFromSmarts(smarts)
                if pat is not None:
                    compiled_patterns.append(pat)
            except:
                pass
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        exclude_patterns = rule.get('exclude_patterns', [])
        compiled_exclude_patterns = []
        for smarts in exclude_patterns:
            try:
                pat = Chem.MolFromSmarts(smarts)
                if pat is not None:
                    compiled_exclude_patterns.append(pat)
            except:
                pass
        rule['compiled_exclude_patterns'] = compiled_exclude_patterns
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        row = []
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            row = [0]*len(rules)
        else:
            for rule in rules:
                try:
                    match = True
                    # Check exclude patterns if any
                    for pat in rule.get('compiled_exclude_patterns', []):
                        if mol.HasSubstructMatch(pat):
                            match = False
                            break
                    if not match:
                        row.append(0)
                        continue
                    # Initialize pattern match flag
                    pattern_match = False
                    # Check required patterns
                    for pat in rule['compiled_patterns']:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            # If a count threshold is specified for this pattern
                            if 'count_threshold' in rule and pat.GetSmarts() in rule['count_threshold']:
                                threshold = rule['count_threshold'][pat.GetSmarts()]
                                if len(matches) >= threshold:
                                    pattern_match = True
                                    break
                            elif rule.get('count_threshold', {}) and pat.GetSmarts() == '[OX2H]':
                                threshold = rule['count_threshold']['[OX2H]']
                                if len(matches) >= threshold:
                                    pattern_match = True
                                    break
                            else:
                                pattern_match = True
                                break
                        else:
                            pattern_match = False
                    if pattern_match:
                        row.append(rule['prediction'])
                    else:
                        row.append(0)
                except:
                    # In case of any error, append 0
                    row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=['Rule {}'.format(rule['number']) for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers containing sulfur functional groups (thiols -SH or thioethers -S-) along with a carboxylate group predict a high Fe/Hf value.**

   - **Explanation**: Sulfur atoms have lone pairs that strongly coordinate with Fe ions, enhancing their incorporation into the catalyst. Examples include **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, and **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**. The combination of sulfur and carboxylate groups provides multiple coordination sites, leading to high Fe/Hf ratios.

2. **Rule 2**: **Modifiers containing amino groups (-NH₂) and carboxylate groups (amino acids), especially those with additional coordinating groups, predict a high Fe/Hf value.**

   - **Explanation**: The presence of both amino and carboxylate groups allows these molecules to act as bidentate ligands, effectively coordinating with Fe ions. Examples include **5-aminopentanoic acid**, **(2S)-2-aminobutanedioic acid** (aspartic acid), and **(2S)-2-aminopentanedioic acid** (glutamic acid). The additional carboxylate groups in aspartic and glutamic acids provide more coordination sites, enhancing Fe incorporation.

3. **Rule 3**: **Modifiers containing pyridine rings where the nitrogen atom is available for coordination predict a high Fe/Hf value.**

   - **Explanation**: The nitrogen atom in the pyridine ring has a lone pair that can coordinate with Fe ions. When the pyridine ring is attached in a way that allows the nitrogen to be accessible, as in **4-pyridin-4-ylbenzoic acid** and **4-pyridin-4-ylbutanoic acid**, it enhances Fe binding. This leads to high Fe/Hf values due to the formation of stable coordination complexes.

4. **Rule 4**: **Aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro -NO₂, halomethyl -CH₂Br) adjacent to the carboxylate predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing its ability to coordinate with Fe ions. Compounds like **4-nitrobenzoic acid** and **4-(bromomethyl)benzoic acid** fit this rule. The increased electron deficiency of the aromatic ring promotes stronger interactions with Fe ions, resulting in high Fe/Hf ratios.

5. **Rule 5**: **Modifiers with multiple carboxylate groups predict a high Fe/Hf value.**

   - **Explanation**: Multiple carboxylate groups provide several coordination sites for Fe ions, enhancing metal binding. Examples include **(2S)-2-aminobutanedioic acid** (aspartic acid) and **(2S)-2-aminopentanedioic acid** (glutamic acid). The additional carboxylate groups increase the likelihood of Fe coordination, leading to high Fe/Hf values.

6. **Rule 6**: **Modifiers with simple aliphatic carboxylic acids lacking additional coordinating functional groups predict a low Fe/Hf value.**

   - **Explanation**: Without functional groups capable of strong coordination (beyond the carboxylate), these modifiers have limited ability to incorporate Fe ions effectively. Examples include **octanoic acid** and **4-oxoheptanedioic acid**, which show low Fe/Hf ratios due to minimal coordination sites.

7. **Rule 7**: **Modifiers containing multiple hydroxyl groups (polyhydroxylated compounds) on aliphatic chains predict a low Fe/Hf value.**

   - **Explanation**: Multiple hydroxyl groups can form intramolecular hydrogen bonds and create steric hindrance, reducing their availability to coordinate with Fe ions. Compounds like **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** demonstrate this effect, leading to low Fe/Hf values.

8. **Rule 8**: **Modifiers with nitrogen-containing heterocycles where the nitrogen's lone pair is involved in aromaticity (e.g., pyridines where nitrogen is part of the aromatic system) predict a low Fe/Hf value.**

   - **Explanation**: When the nitrogen's lone pair participates in the aromatic system, it is less available for metal coordination. Compounds like **pyridine-3-carboxylic acid** and **1H-pyrazole-4-carboxylic acid** exemplify this rule. The decreased availability of the nitrogen lone pair leads to low Fe/Hf ratios.

9. **Rule 9**: **Modifiers containing fluorinated alkyl chains, especially perfluorinated groups, predict a low Fe/Hf value.**

   - **Explanation**: Fluorine atoms are highly electronegative and withdraw electron density, diminishing the coordinating ability of functional groups. Examples include **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**. The reduced electron density on coordinating atoms results in low Fe/Hf values.

10. **Rule 10**: **Modifiers with aromatic rings bearing electron-donating groups (e.g., amino -NH₂, hydroxy -OH, methoxy -OCH₃) without additional strong coordinating groups predict a low Fe/Hf value.**

    - **Explanation**: Electron-donating groups can decrease the acidity of the carboxylic acid, weakening its coordination ability with Fe ions. Examples are **4-aminobenzoic acid**, **4-methylbenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, and **3-(4-hydroxyphenyl)propanoic acid**. The reduced electron deficiency of the aromatic ring results in lower Fe incorporation and low Fe/Hf ratios.

11. **Rule 11**: **Modifiers with aliphatic chains containing ether linkages (e.g., polyethylene glycol chains) predict a high Fe/Hf value.**

    - **Explanation**: Ether oxygen atoms have lone pairs that can coordinate with Fe ions. **2-[2-(2-methoxyethoxy)ethoxy]acetic acid** contains multiple ether linkages providing several coordination sites. This enhances Fe incorporation into the catalyst, resulting in a high Fe/Hf ratio.

12. **Rule 12**: **Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings predict a low Fe/Hf value.**

    - **Explanation**: Aldehyde groups are reactive and can engage in side reactions, reducing the availability of coordinating groups. Compounds such as **4-formylbenzoic acid** and **5-formyl-2-hydroxybenzoic acid** have diminished metal-binding capacity due to the presence of the aldehyde group, resulting in low Fe/Hf ratios.

13. **Rule 13**: **Modifiers with bulky or sterically hindered groups adjacent to potential coordination sites predict a low Fe/Hf value.**

    - **Explanation**: Steric hindrance can impede effective coordination with Fe ions. **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan) has a bulky indole ring that may hinder coordination, leading to a low Fe/Hf ratio.

14. **Rule 14**: **Modifiers containing methoxy groups (-OCH₃) on aromatic rings along with additional coordinating groups predict a high Fe/Hf value.**

    - **Explanation**: Methoxy groups can donate electron density through resonance, enhancing the coordinating ability of adjacent functional groups. **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid** is an example where methoxy-substituted aromatic rings contribute to increased Fe binding, leading to a high Fe/Hf value.

15. **Rule 15**: **Modifiers with long aliphatic chains terminating in hydroxyl groups (-OH) along with a carboxylate group predict a high Fe/Hf value.**

    - **Explanation**: The terminal hydroxyl group and carboxylate can coordinate with Fe ions, providing multiple coordination sites. **7-hydroxyheptanoic acid** is an example where the hydroxyl and carboxylate groups act synergistically to enhance Fe coordination, resulting in a high Fe/Hf value.

**End of Rules**

---

These rules illustrate the relationship between molecular modifiers' substructures and the Fe/Hf value in the catalyst. The focus is on combining multiple functional groups within the modifiers to predict the Fe/Hf ratio effectively. The rules consider underlying physicochemical properties such as coordination chemistry, electronic effects, and steric hindrance to explain how different functional groups influence Fe incorporation into the catalyst. This set of rules balances broader coverage with specific structural features, providing a comprehensive understanding of the factors affecting the Fe/Hf values.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
0,1,0,0,1,0,-1,0,0,0,1,0,0,0,0
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,1
0,0,0,1,1,0,-1,0,0,0,0,0,0,0,0
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,1
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,-1,-1,0,0,0,0,0,0,0,1
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,1
0,0,1,0,1,0,-1,-1,0,0,0,0,0,0,0
0,0,0,0,1,-1,-1,0,0,0,0,0,0,0,1
1,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,1,0,0,0,0
0,0,1,0,1,0,-1,-1,0,0,0,0,0,0,0
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,-1,-1,0,-1,0,0,0,0,0,1
0,1,0,0,1,0,-1,-1,0,0,0,0,-1,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
1,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,-1,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,-1,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,1,0,1,0,-1,-1,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
1,1,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,1,0,1,0,-1,-1,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,1,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,-1,-1,0,0,0,0,0,0,0,1
0,0,0,0,1,0,-1,0,-1,0,0,0,0,0,0
0,0,0,0,1,-1,-1,0,0,0,0,0,0,0,1
0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,1
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,1
0,1,0,0,1,0,-1,0,0,0,0,0,0,0,1

---------------------------------------------------------------


    Train Accuracy: 0.7142857142857143; Test Accuracy: 1.0
    Train Support: 0.14285714285714285; Test Support: 0.5
    Train Confidence: 0.8888888888888888; Test Confidence: 0.75
    Train Lift: 1.8300653594771243; Test Lift: NONE
    Train Leverage: 0.05959183673469389; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups
    # Carboxylic acid group (-COOH)
    carboxylic_acid = '[CX3](=O)[OX1-,OX2H1]'
    
    # Thiol group (-SH)
    thiol = '[SX2H]'
    
    # Thioether group (-S-)
    thioether = '[SX2;!$(S=[O,N])]([#6])[#6]'
    
    # Primary amine (-NH2)
    primary_amine = '[NX3H2;!$([N][!C])]'  # Exclude amines attached to non-carbon atoms
    
    # Hydroxyl group (-OH)
    hydroxyl_group = '[OX2H]'
    
    # Ether linkage in aliphatic chains (-O-)
    ether_linkage = '[CX4;!$(C=O)][OX2][CX4;!$(C=O)]'  # Exclude carbonyls adjacent to oxygen
    
    # Aromatic ring
    aromatic_ring = '[a]'
    
    # Pyridine ring
    pyridine_ring = 'n1ccccc1'
    
    # Nitro group attached to aromatic ring
    nitro_on_aromatic = '[c][NX3](=O)=O'
    
    # Halomethyl group attached to aromatic ring
    halomethyl_on_aromatic = '[c][CH2][F,Cl,Br,I]'
    
    # Methoxy group on aromatic ring
    methoxy_on_aromatic = '[c][OX2][CH3]'
    
    # Electron-donating groups on aromatic ring (hydroxy, amino, methoxy)
    edg_on_aromatic = ['[c][NX3H2]', '[c][OX2H]', '[c][OX2][CH3]']
    
    # Indole ring (tryptophan)
    indole_ring = '[nH]1c2ccccc2cc1'
    
    # Fluorinated alkyl chain (perfluorinated groups)
    perfluoro_alkyl = '[CX4]([F])([F])[F]'
    
    # Long aliphatic chain terminating in hydroxyl group
    long_aliphatic_chain_oh = '[C$(*-[#6]);!R][C$(*-[#6]);!R][C$(*-[#6]);!R][C$(*-[#6]);!R][C$(*-[#6]);!R][OX2H]'
    
    # Nitrogen-containing heterocycles with lone pair in aromaticity
    aromatic_nitrogen_heterocycles = ['n1cccc1', 'c1nccc1', 'c1ccncc1', 'c1ncc[nH]1', 'c1cncn1', 'c1ncnc1']
    
    # Define the rules with their associated patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'High Fe/Hf Value: Modifiers containing sulfur functional groups (thiols -SH or thioethers -S-) along with a carboxylate group.',
            'patterns': [
                [thiol, thioether],  # Thiol or thioether
                [carboxylic_acid]  # Carboxylic acid group
            ],
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'High Fe/Hf Value: Modifiers containing amino groups (-NH2) and carboxylate groups.',
            'patterns': [
                [primary_amine],  # Primary amine
                [carboxylic_acid]  # Carboxylic acid group
            ],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'High Fe/Hf Value: Modifiers containing pyridine rings where the nitrogen atom is available for coordination.',
            'patterns': [
                [pyridine_ring]
            ],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'High Fe/Hf Value: Aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro -NO2, halomethyl -CH2Br) on the aromatic ring.',
            'patterns': [
                [nitro_on_aromatic, halomethyl_on_aromatic],  # EWG on aromatic ring
                [aromatic_ring],
                [carboxylic_acid]
            ],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'High Fe/Hf Value: Modifiers with multiple carboxylate groups.',
            'patterns': [
                [carboxylic_acid]
            ],
            'count_threshold': {carboxylic_acid: 2},  # At least 2 carboxylic acid groups
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Low Fe/Hf Value: Modifiers with simple aliphatic carboxylic acids lacking additional coordinating functional groups.',
            'patterns': [
                [carboxylic_acid]
            ],
            'exclude_patterns': [
                ['[N]'],  # Exclude any nitrogen-containing groups
                ['[S]'],  # Exclude any sulfur-containing groups
                [ether_linkage],  # Exclude ether linkages
                ['[c]']  # Exclude aromatic atoms
            ],
            'prediction': -1
        },
        {
            'number': 7,
            'description': 'Low Fe/Hf Value: Modifiers containing multiple hydroxyl groups (polyols) on aliphatic chains.',
            'patterns': [
                [hydroxyl_group]
            ],
            'count_threshold': {hydroxyl_group: 2},  # At least 2 hydroxyl groups
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Low Fe/Hf Value: Modifiers with nitrogen-containing heterocycles where nitrogen’s lone pair is involved in aromaticity.',
            'patterns': [
                aromatic_nitrogen_heterocycles
            ],
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'Low Fe/Hf Value: Modifiers containing fluorinated alkyl chains, especially perfluorinated groups.',
            'patterns': [
                [perfluoro_alkyl]
            ],
            'prediction': -1
        },
        {
            'number': 10,
            'description': 'Low Fe/Hf Value: Modifiers with aromatic rings bearing electron-donating groups (e.g., amino -NH2, hydroxy -OH, methoxy -OCH3), without additional strong coordinating groups.',
            'patterns': [
                edg_on_aromatic,
                [aromatic_ring]
            ],
            'exclude_patterns': [
                [carboxylic_acid, primary_amine, thiol, thioether, ether_linkage]  # Exclude other coordinating groups
            ],
            'prediction': -1
        },
        {
            'number': 11,
            'description': 'High Fe/Hf Value: Modifiers with ether linkages in aliphatic chains.',
            'patterns': [
                [ether_linkage]
            ],
            'prediction': 1
        },
        {
            'number': 12,
            'description': 'Low Fe/Hf Value: Modifiers with aldehyde groups (-CHO) adjacent to aromatic rings.',
            'patterns': [
                ['[c][CX3H]=O']  # Aldehyde attached to aromatic ring
            ],
            'prediction': -1
        },
        {
            'number': 13,
            'description': 'Low Fe/Hf Value: Modifiers with bulky or sterically hindered groups adjacent to potential coordination sites.',
            'patterns': [
                [indole_ring],  # Bulky indole ring
                [primary_amine, carboxylic_acid]  # Coordination sites
            ],
            'prediction': -1
        },
        {
            'number': 14,
            'description': 'High Fe/Hf Value: Modifiers containing methoxy groups (-OCH3) on aromatic rings along with additional coordinating groups.',
            'patterns': [
                [methoxy_on_aromatic],
                [primary_amine, carboxylic_acid, hydroxyl_group]  # Additional coordinating groups
            ],
            'prediction': 1
        },
        {
            'number': 15,
            'description': 'High Fe/Hf Value: Modifiers with long aliphatic chains terminating in hydroxyl groups (-OH) along with a carboxylate group.',
            'patterns': [
                [long_aliphatic_chain_oh],
                [carboxylic_acid]
            ],
            'prediction': 1
        }
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for group in rule.get('patterns', []):
            compiled_group = [Chem.MolFromSmarts(p) for p in group]
            compiled_patterns.append(compiled_group)
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_excludes = []
            for group in rule['exclude_patterns']:
                compiled_group = [Chem.MolFromSmarts(p) for p in group]
                compiled_excludes.append(compiled_group)
            rule['compiled_exclude_patterns'] = compiled_excludes
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for group in rule['compiled_exclude_patterns']:
                        for pat in group:
                            if mol.HasSubstructMatch(pat):
                                match = False
                                break
                        if not match:
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for compiled_group in rule['compiled_patterns']:
                    group_match = False
                    for pat in compiled_group:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            # If a count threshold is specified for this pattern
                            count_threshold = rule.get('count_threshold', {})
                            smarts_pat = Chem.MolToSmarts(pat)
                            threshold = count_threshold.get(smarts_pat, 1)
                            if len(matches) >= threshold:
                                group_match = True
                                break
                            else:
                                # Not enough matches to meet the threshold
                                continue
                        else:
                            continue
                    if not group_match:
                        match = False
                        break
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers containing an aliphatic amino group (-NH₂) on a flexible aliphatic chain, along with a carboxylic acid group (-COOH), predict a high Fe/Hf value.**

   - **Explanation**: The presence of an amino group on a flexible chain allows effective coordination with Fe ions. The amino group donates electron density, enhancing Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**: **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, **(2S)-6-acetamido-2-aminohexanoic acid**.

   - **Counterexamples (Low Fe/Hf)**: **4-aminobenzoic acid** (amino group attached directly to an aromatic ring, reducing flexibility and coordination ability).

2. **Rule 2**: **Modifiers containing sulfur functional groups (thiols -SH or thioethers -S-) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Sulfur atoms have lone pairs that coordinate strongly with Fe ions. Combined with a carboxylate group, they offer multiple coordination sites, enhancing Fe incorporation.

   - **Examples (High Fe/Hf)**: **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**.

3. **Rule 3**: **Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO₂, halomethyl -CH₂Hal) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing its ability to coordinate with Fe ions. This strengthens metal-ligand interactions, promoting higher Fe incorporation.

   - **Examples (High Fe/Hf)**: **4-nitrobenzoic acid**, **4-(bromomethyl)benzoic acid**.

4. **Rule 4**: **Modifiers containing accessible pyridine rings (nitrogen heterocycles) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: The lone pair on the pyridine nitrogen can coordinate with Fe ions. When the nitrogen is accessible and not sterically hindered, it enhances Fe binding to the catalyst.

   - **Examples (High Fe/Hf)**: **4-pyridin-4-ylbenzoic acid**, **4-pyridin-4-ylbutanoic acid**.

   - **Counterexamples (Low Fe/Hf)**: **pyridine-3-carboxylic acid** (nitrogen position and possible steric hindrance reduce coordination efficiency).

5. **Rule 5**: **Modifiers with long aliphatic chains (six or more carbons) terminating in coordinating functional groups (e.g., hydroxyl -OH, amino -NH₂) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Long, flexible chains allow terminal functional groups to effectively coordinate with Fe ions, increasing coordination sites and enhancing Fe incorporation.

   - **Examples (High Fe/Hf)**: **7-hydroxyheptanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**.

6. **Rule 6**: **Modifiers containing multiple ether linkages (-O-) in their backbone and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Ether oxygen atoms have lone pairs capable of coordinating with Fe ions. Multiple ether linkages provide several coordination sites along a flexible chain.

   - **Example (High Fe/Hf)**: **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**.

7. **Rule 7**: **Modifiers that are amino acids with simple aromatic side chains and a carboxylic acid group (-COOH), where the side chain does not hinder coordination, predict a high Fe/Hf value.**

   - **Explanation**: Amino acids can act as bidentate ligands, coordinating through both amino and carboxylate groups. Simple aromatic side chains like phenyl rings do not impede Fe coordination.

   - **Example (High Fe/Hf)**: **(2S)-2-amino-3-phenylpropanoic acid** (phenylalanine).

   - **Counterexamples (Low Fe/Hf)**: **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan) – bulky indole ring may hinder coordination.

8. **Rule 8**: **Modifiers with aromatic rings bearing electron-donating groups (e.g., hydroxyl -OH, amino -NH₂) without additional strong coordinating groups predict a low Fe/Hf value.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid, reducing its ability to coordinate with Fe ions and weakening metal-ligand interactions.

   - **Examples (Low Fe/Hf)**: **4-aminobenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, **3-(4-hydroxyphenyl)propanoic acid**.

9. **Rule 9**: **Modifiers that are simple aliphatic carboxylic acids lacking additional coordinating functional groups predict a low Fe/Hf value.**

   - **Explanation**: Without extra coordination sites, these modifiers interact weakly with Fe ions, leading to lower Fe incorporation.

   - **Examples (Low Fe/Hf)**: **octanoic acid**, **4-oxoheptanedioic acid**.

10. **Rule 10**: **Modifiers containing nitrogen heterocycles where the nitrogen's lone pair is involved in aromaticity or is sterically hindered, along with a carboxylic acid group (-COOH), predict a low Fe/Hf value.**

    - **Explanation**: Lone pairs involved in aromatic systems or hindered by steric factors are less available for coordination with Fe ions, reducing the ligand's effectiveness.

    - **Examples (Low Fe/Hf)**: **pyridine-3-carboxylic acid**, **1H-pyrazole-4-carboxylic acid**.

11. **Rule 11**: **Modifiers containing multiple hydroxyl groups (polyols) along with a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: While hydroxyl groups have lone pairs, in polyols they may engage in internal hydrogen bonding or face steric hindrance, making them less effective at coordinating with Fe ions.

    - **Examples (Low Fe/Hf)**: **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**, **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**.

12. **Rule 12**: **Modifiers with perfluorinated alkyl chains attached to a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Fluorine's high electronegativity withdraws electron density from coordinating atoms, diminishing their ability to bind Fe ions.

    - **Example (Low Fe/Hf)**: **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**.

13. **Rule 13**: **Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Aldehyde groups may engage in resonance with the aromatic ring, affecting the electron density of the carboxylate group and reducing its coordination ability with Fe ions.

    - **Examples (Low Fe/Hf)**: **4-formylbenzoic acid**, **5-formyl-2-hydroxybenzoic acid**.

14. **Rule 14**: **Modifiers containing bulky or sterically hindered groups adjacent to potential coordination sites, along with a carboxylic acid group (-COOH), predict a low Fe/Hf value.**

    - **Explanation**: Steric hindrance can prevent effective interaction between the modifier and Fe ions, impeding Fe binding.

    - **Examples (Low Fe/Hf)**: **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan), **2-[(4-hydroxybenzoyl)amino]acetic acid**.

15. **Rule 15**: **Modifiers with aromatic rings bearing keto groups (=O) adjacent to the ring and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

    - **Explanation**: Keto groups can participate in coordination with Fe ions through their oxygen atoms. The proximity to the aromatic ring may stabilize the coordination complex.

    - **Example (High Fe/Hf)**: **1,3-dioxo-2-benzofuran-5-carboxylic acid**.

**End of Rules**

---

These rules have been carefully formulated by analyzing the dataset and considering underlying physicochemical principles, particularly coordination chemistry and electronic effects. Each rule combines multiple substructures to predict the Fe/Hf value effectively. The rules aim to cover a broad range of the dataset while maintaining predictive specificity. By focusing on the combination of functional groups and their influence on Fe coordination, the rules provide clear guidelines to determine whether a given modifier will lead to a high or low Fe/Hf value in the catalyst system.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,0,-1,0
1,0,0,0,0,0,1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0
1,0,0,1,0,0,1,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.8; Test Accuracy: 1.0
    Train Support: 0.09523809523809523; Test Support: 0.16666666666666666
    Train Confidence: 0.9629629629629629; Test Confidence: 0.5833333333333334
    Train Lift: 1.925381263616558; Test Lift: NONE
    Train Leverage: 0.04326530612244899; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for common functional groups

    # Carboxylic acid group (-COOH)
    carboxylic_acid = ['[CX3](=O)[OX2H1]', '[CX3](=O)[O-]']

    # Primary aliphatic amine group (-NH2)
    primary_aliphatic_amine = '[NX3;H2][C;!$(C=[O,N,S])]'  # Exclude N attached to carbonyl or similar

    # Thiol group (-SH)
    thiol = '[SX2H]'

    # Thioether group (-S-)
    thioether = '[#16X2][C]'

    # Ether linkage (-O-)
    ether_linkage = '[C][OX2][C]'

    # Multiple ether linkages for Rule 6
    multi_ether_linkage = '[C][OX2][C][OX2][C]'

    # Pyridine ring
    pyridine_ring = '[n][a][a][a][a][a]'

    # Aromatic ring with nitro group
    nitro_on_aromatic = '[c][NX3+](=O)[O-]'

    # Aromatic ring with halomethyl group
    halomethyl_on_aromatic = '[c][CH2][F,Cl,Br,I]'

    # Aromatic ring with keto group adjacent to the ring
    aromatic_keto = '[c][CX3](=O)[c]'

    # Hydroxyl group (-OH)
    hydroxyl_group = '[OX2H]'

    # Aniline (aromatic amine)
    aromatic_amine = '[NX3;H2][c]'

    # Phenol group (aromatic hydroxyl)
    phenol_group = '[c][OX2H]'

    # Aldehyde group on aromatic ring
    aldehyde_on_aromatic = '[c][CX3H](=O)'

    # Perfluorinated alkyl chain
    perfluoro_alkyl = '[C;X4;H0](F)(F)(F)'

    # Bulky group pattern for Rule 14 (e.g., indole ring)
    bulky_group = '[c][cH][c](c1ccccc1)'

    # Aromatic ring
    aromatic_ring = '[a]'

    # Exclude patterns
    amine = '[NX3]'

    sulfur_groups = ['[SX2H]', '[SX2][C]']

    halogens = '[F,Cl,Br,I]'

    # Now define rules with patterns

    rules = [
        {
            'number': 1,
            'description': 'Modifiers containing an aliphatic amino group (-NH2) on a flexible aliphatic chain, along with a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [primary_aliphatic_amine]
            ],
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers containing sulfur functional groups (thiols -SH or thioethers -S-) and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [thiol, thioether]
            ],
            'prediction':1
        },
        {
            'number':3,
            'description': 'Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO2, halomethyl -CH2Hal) and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [nitro_on_aromatic, halomethyl_on_aromatic]
            ],
            'prediction': 1
        },
        {
            'number':4,
            'description': 'Modifiers containing accessible pyridine rings (nitrogen heterocycles) and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [pyridine_ring]
            ],
            'prediction':1
        },
        {
            'number':5,
            'description': 'Modifiers with long aliphatic chains (six or more carbons) terminating in coordinating functional groups (e.g., hydroxyl -OH, amino -NH2) and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [hydroxyl_group, primary_aliphatic_amine]
            ],
            'chain_length':6,
            'prediction':1
        },
        {
            'number':6,
            'description': 'Modifiers containing multiple ether linkages (-O-) in their backbone and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [multi_ether_linkage]
            ],
            'prediction':1
        },
        {
            'number':7,
            'description': "Modifiers that are amino acids with simple aromatic side chains and a carboxylic acid group (-COOH), where the side chain does not hinder coordination.",
            'patterns': [
                carboxylic_acid,
                [primary_aliphatic_amine],
                [aromatic_ring]
            ],
            'prediction':1
        },
        {
            'number':8,
            'description': 'Modifiers with aromatic rings bearing electron-donating groups (e.g., hydroxyl -OH, amino -NH2) without additional strong coordinating groups.',
            'patterns': [
                carboxylic_acid,
                [phenol_group, aromatic_amine]
            ],
            'exclude_patterns': [
                [thiol, thioether, primary_aliphatic_amine, ether_linkage]
            ],
            'prediction':-1
        },
        {
            'number':9,
            'description': 'Modifiers that are simple aliphatic carboxylic acids lacking additional coordinating functional groups.',
            'patterns': [
                carboxylic_acid
            ],
            'exclude_patterns': [
                [amine],
                sulfur_groups,
                [ether_linkage],
                [halogens],
                [aromatic_ring]
            ],
            'prediction': -1
        },
        {
            'number':10,
            'description': 'Modifiers containing nitrogen heterocycles where the nitrogen\'s lone pair is involved in aromaticity or is sterically hindered, along with a carboxylic acid group (-COOH).',
            'patterns':[
                carboxylic_acid,
                ['[nH]1cccc1', '[n]1ccncc1']  # Examples: pyrrole, pyrazole
            ],
            'prediction': -1
        },
        {
            'number':11,
            'description': 'Modifiers containing multiple hydroxyl groups (polyols) along with a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [hydroxyl_group]
            ],
            'count_threshold': {'[OX2H]':2},
            'prediction': -1
        },
        {
            'number':12,
            'description': 'Modifiers with perfluorinated alkyl chains attached to a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [perfluoro_alkyl]
            ],
            'prediction': -1
        },
        {
            'number':13,
            'description': 'Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [aldehyde_on_aromatic]
            ],
            'prediction': -1
        },
        {
            'number':14,
            'description': 'Modifiers containing bulky or sterically hindered groups adjacent to potential coordination sites, along with a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [bulky_group]
            ],
            'prediction': -1
        },
        {
            'number':15,
            'description': 'Modifiers with aromatic rings bearing keto groups (=O) adjacent to the ring and a carboxylic acid group (-COOH).',
            'patterns': [
                carboxylic_acid,
                [aromatic_keto]
            ],
            'prediction':1
        }
    ]

    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for group in rule.get('patterns', []):
            compiled_group = [Chem.MolFromSmarts(p) for p in group]
            compiled_patterns.append(compiled_group)
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_excludes = []
            for group in rule['exclude_patterns']:
                compiled_group = [Chem.MolFromSmarts(p) for p in group]
                compiled_excludes.append(compiled_group)
            rule['compiled_exclude_patterns'] = compiled_excludes

    # Initialize results list
    results = []
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for group in rule['compiled_exclude_patterns']:
                        for pat in group:
                            if mol.HasSubstructMatch(pat):
                                match = False
                                break
                        if not match:
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for compiled_group in rule['compiled_patterns']:
                    group_match = False
                    for pat in compiled_group:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            # If a count threshold is specified for this pattern
                            if 'count_threshold' in rule and pat.GetSmarts() in rule['count_threshold']:
                                threshold = rule['count_threshold'][pat.GetSmarts()]
                                if len(matches) >= threshold:
                                    group_match = True
                                    break
                            else:
                                group_match = True
                                break
                    if not group_match:
                        match = False
                        break
                # Additional checks for some rules
                # For rule 5, need to check for chain length
                if match and rule['number'] == 5:
                    # Check for aliphatic chains of required length
                    chain_length = rule.get('chain_length',6)
                    # Use the All Smallest Set of Smallest Rings (SSSR)
                    ri = mol.GetRingInfo()
                    # Find longest chain not in rings
                    from rdkit.Chem import rdmolops
                    chains = rdmolops.GetMolFrags(mol, asMols=True, sanitizeFrags=False)
                    max_chain_length = 0
                    for chain in chains:
                        if not chain.GetRingInfo().IsInitialized() or not chain.GetRingInfo().NumRings():
                            num_carbons = sum(1 for atom in chain.GetAtoms() if atom.GetAtomicNum()==6)
                            if num_carbons > max_chain_length:
                                max_chain_length = num_carbons
                    if max_chain_length < chain_length:
                        match = False
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule["number"]}' for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers with an aliphatic chain bearing a terminal primary amino group (-NH₂) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: The flexible aliphatic chain allows the terminal amino group to effectively coordinate with Fe ions, enhancing metal incorporation into the catalyst. The primary amino group serves as a strong ligand due to its lone pair availability and minimal steric hindrance.

   - **Examples (High Fe/Hf)**: **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, **(2S)-6-acetamido-2-aminohexanoic acid**.

   - **Counterexamples (Low Fe/Hf)**: **4-aminobenzoic acid** (amino group attached directly to an aromatic ring, reducing flexibility and coordination efficiency), **(2S)-2-aminopentanedioic acid** (amino group adjacent to two carboxyl groups, which may lead to internal interactions and reduced availability for metal coordination).

2. **Rule 2**: **Modifiers containing sulfur-functional groups (thiols -SH or thioethers -S-) along with a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Sulfur atoms possess lone pairs that can coordinate strongly with Fe ions. The presence of sulfur enhances metal-ligand interactions due to its larger atomic radius and polarizability, promoting higher Fe incorporation.

   - **Examples (High Fe/Hf)**: **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**.

   - **Counterexamples (Low Fe/Hf)**: Modifiers lacking sulfur groups or with sulfur atoms sterically hindered from coordinating with Fe ions.

3. **Rule 3**: **Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO₂, halogens like bromo) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing its ability to deprotonate and coordinate with Fe ions. This strengthens metal-ligand interactions and facilitates greater Fe incorporation.

   - **Examples (High Fe/Hf)**: **4-nitrobenzoic acid**, **4-(bromomethyl)benzoic acid**.

   - **Counterexamples (Low Fe/Hf)**: **4-methylbenzoic acid** (methyl group is electron-donating, reducing acidity and coordination ability).

4. **Rule 4**: **Modifiers containing accessible pyridine nitrogen atoms (pyridyl groups) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: The lone pair on the pyridine nitrogen is available for coordination with Fe ions. When the nitrogen is not sterically hindered and is in a position conducive to coordination, it enhances Fe binding to the catalyst.

   - **Examples (High Fe/Hf)**: **4-pyridin-4-ylbenzoic acid**, **4-pyridin-4-ylbutanoic acid**.

   - **Counterexamples (Low Fe/Hf)**: **pyridine-3-carboxylic acid** (the nitrogen's position and possible steric hindrance reduce coordination efficiency).

5. **Rule 5**: **Modifiers that are aromatic amino acids with less bulky side chains and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Amino acids can act as bidentate ligands, coordinating through both the amino and carboxylate groups. Aromatic side chains that are not overly bulky do not hinder coordination with Fe ions.

   - **Example (High Fe/Hf)**: **(2S)-2-amino-3-phenylpropanoic acid** (phenylalanine has a simple phenyl side chain).

   - **Counterexamples (Low Fe/Hf)**: **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan has a bulky indole ring, causing steric hindrance and reducing coordination).

6. **Rule 6**: **Modifiers with flexible aliphatic chains bearing hydroxyl (-OH) or ether (-O-) groups distant from the carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Hydroxyl or ether groups located away from the carboxylic acid can serve as additional coordination sites without causing steric hindrance. The flexibility of the chain allows these groups to interact effectively with Fe ions.

   - **Examples (High Fe/Hf)**: **7-hydroxyheptanoic acid**, **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**.

   - **Counterexamples (Low Fe/Hf)**: Modifiers where hydroxyl groups are adjacent to the carboxylic acid, possibly causing steric hindrance or internal hydrogen bonding that reduces coordination (e.g., **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**).

7. **Rule 7**: **Modifiers lacking additional coordinating functional groups beyond the carboxylic acid (-COOH), such as simple aliphatic carboxylic acids, predict a low Fe/Hf value.**

   - **Explanation**: Without extra coordination sites, these modifiers interact weakly with Fe ions, leading to lower Fe incorporation into the catalyst. The carboxylic acid alone may not provide sufficient binding strength.

   - **Examples (Low Fe/Hf)**: **octanoic acid**, **4-oxoheptanedioic acid**.

8. **Rule 8**: **Modifiers with multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.**

   - **Explanation**: Multiple hydroxyl groups near the coordination site can engage in internal hydrogen bonding or create steric hindrance, reducing their effectiveness at coordinating with Fe ions.

   - **Examples (Low Fe/Hf)**: **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (gluconic acid), **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**.

   - **Counterexamples (High Fe/Hf)**: Modifiers with hydroxyl groups distant from the carboxylic acid (see Rule 6).

9. **Rule 9**: **Modifiers with aromatic rings bearing electron-donating groups (e.g., hydroxyl -OH, amino -NH₂) and a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid, reducing its ability to deprotonate and coordinate with Fe ions. This weakens metal-ligand interactions and lowers Fe incorporation.

   - **Examples (Low Fe/Hf)**: **4-aminobenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, **3-(4-hydroxyphenyl)propanoic acid**.

   - **Counterexamples (High Fe/Hf)**: Modifiers with electron-withdrawing groups (see Rule 3).

10. **Rule 10**: **Modifiers containing perfluorinated alkyl chains attached to a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: The highly electronegative fluorine atoms withdraw electron density from the carboxylate group, diminishing its ability to coordinate with Fe ions.

    - **Example (Low Fe/Hf)**: **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers with non-fluorinated alkyl chains bearing coordinating groups (see Rule 1).

11. **Rule 11**: **Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Aldehyde groups can engage in resonance with the aromatic ring, affecting the electron density of the carboxylate group and reducing its coordination ability with Fe ions.

    - **Examples (Low Fe/Hf)**: **4-formylbenzoic acid**, **5-formyl-2-hydroxybenzoic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers without electron-donating groups adjacent to the carboxylate (see Rule 3).

12. **Rule 12**: **Modifiers with nitrogen-containing heterocycles where the nitrogen's lone pair is less available for coordination (due to involvement in aromaticity or steric hindrance), along with a carboxylic acid group (-COOH), predict a low Fe/Hf value.**

    - **Explanation**: If the nitrogen's lone pair is delocalized in aromatic systems or sterically hindered, it cannot effectively coordinate with Fe ions, reducing the ligand's effectiveness.

    - **Examples (Low Fe/Hf)**: **1H-pyrazole-4-carboxylic acid**, **pyridine-3-carboxylic acid**.

    - **Counterexamples (High Fe/Hf)**: **4-pyridin-4-ylbenzoic acid** (nitrogen lone pair is accessible for coordination).

13. **Rule 13**: **Modifiers containing bulky or sterically hindering groups near potential coordination sites predict a low Fe/Hf value.**

    - **Explanation**: Steric hindrance can prevent effective interaction between the modifier and Fe ions, impeding Fe binding. Bulky side chains can block access to coordinating atoms.

    - **Examples (Low Fe/Hf)**: **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan), **2-[(4-hydroxybenzoyl)amino]acetic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers with less bulky side chains (see Rule 5).

14. **Rule 14**: **Modifiers with side chains containing ketone groups (carbonyl -C=O) adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Ketone groups adjacent to the carboxylate can withdraw electron density through resonance or inductive effects, reducing the carboxylate's ability to coordinate with Fe ions.

    - **Example (Low Fe/Hf)**: **4-oxoheptanedioic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers without adjacent ketone groups, or where the ketone is positioned away from the coordination site.

15. **Rule 15**: **Modifiers with ether linkages (-O-) in flexible chains and a carboxylic acid group (-COOH) can predict a high Fe/Hf value if the ether oxygen is available for coordination.**

    - **Explanation**: Ether oxygen atoms can act as additional coordination sites. In flexible chains, these oxygen atoms are accessible and can enhance metal-ligand interactions.

    - **Examples (High Fe/Hf)**: **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**, **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**.

    - **Counterexamples (Low Fe/Hf)**: Modifiers where ether oxygens are sterically hindered or not properly oriented for coordination.

**End of Rules**---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
1,0,0,0,0,1,0,0,0,0,0,0,0,0,1
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0
0,0,0,1,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,1,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,0,0,1,0,1,0,0,0,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,-1,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,1,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,1,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,-1,0,-1,0,0,0,0
0,0,0,0,0,1,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,1,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
1,1,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,1,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0
1,0,0,0,0,1,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.8285714285714286; Test Accuracy: 1.0
    Train Support: 0.10857142857142857; Test Support: 0.4
    Train Confidence: 0.9555555555555555; Test Confidence: 0.7
    Train Lift: 1.9215686274509807; Test Lift: NONE
    Train Leverage: 0.0493061224489796; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    primary_aliphatic_amine = '[NX3H2][C;!R]'
    thiol = '[SX2H]'
    thioether = '[#6][SX2][#6]'
    nitro_on_aromatic = '[c][NX3](=O)=O'
    halogen_on_aromatic = '[c][F,Cl,Br,I]'
    pyridine_ring = 'n1ccccc1'
    hydroxyl_on_aromatic = '[c][OX2H]'
    amino_on_aromatic = '[c][NX3H2]'
    ether_linkage = '[#6][OX2][#6]'
    hydroxyl_group = '[OX2H]'
    aldehyde_on_aromatic = '[c][CX3H](=O)'
    indole_ring = 'c1ccc2c(c1)ccn2'
    perfluoroalkyl = '[CX4](F)(F)(F)'

    # Define rules
    rules = [
        {
            'number': 1,
            'description': 'Modifiers with an aliphatic chain bearing a terminal primary amino group (-NH2) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [[primary_aliphatic_amine], [carboxylic_acid]],
            'exclude_patterns': [['[NX3H2][c]']],  # Exclude amine attached to aromatic carbon
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers containing sulfur-functional groups (thiols -SH or thioethers -S-) along with a carboxylic acid group (-COOH).',
            'patterns': [[thiol, thioether], [carboxylic_acid]],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO2, halogens like bromo) and a carboxylic acid group (-COOH).',
            'patterns': [[halogen_on_aromatic, nitro_on_aromatic], [carboxylic_acid]],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'Modifiers containing accessible pyridine nitrogen atoms (pyridyl groups) and a carboxylic acid group (-COOH).',
            'patterns': [[pyridine_ring], [carboxylic_acid]],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Modifiers that are aromatic amino acids with less bulky side chains and a carboxylic acid group (-COOH).',
            'patterns': [['[NX3][CX4H]([CX4])[CX3](=O)[OX2H1]'], ['[c][CX4H][NX3]']],
            'exclude_patterns': [[indole_ring]],  # Exclude bulky aromatic side chains
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Modifiers with flexible aliphatic chains bearing hydroxyl (-OH) or ether (-O-) groups distant from the carboxylic acid group (-COOH).',
            'patterns': [[ether_linkage, hydroxyl_group], [carboxylic_acid]],
            'exclude_patterns': [['[OX2H][CX3](=O)[OX2H1]']],  # Exclude hydroxyl adjacent to COOH
            'prediction': 1
        },
        {
            'number': 7,
            'description': 'Modifiers lacking additional coordinating functional groups beyond the carboxylic acid (-COOH).',
            'patterns': [[carboxylic_acid]],
            'exclude_patterns': [[primary_aliphatic_amine, thiol, thioether, ether_linkage, hydroxyl_group, '[N]', '[S]', '[P]', '[O]']],  # Exclude other donor atoms
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Modifiers with multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH).',
            'patterns': [[carboxylic_acid], [hydroxyl_group]],
            'count_threshold': {hydroxyl_group: 2},
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'Modifiers with aromatic rings bearing electron-donating groups (e.g., hydroxyl -OH, amino -NH2) and a carboxylic acid group (-COOH).',
            'patterns': [[hydroxyl_on_aromatic, amino_on_aromatic], [carboxylic_acid]],
            'prediction': -1
        },
        {
            'number': 10,
            'description': 'Modifiers containing perfluorinated alkyl chains attached to a carboxylic acid group (-COOH).',
            'patterns': [[perfluoroalkyl], [carboxylic_acid]],
            'prediction': -1
        },
        {
            'number': 11,
            'description': 'Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH).',
            'patterns': [[aldehyde_on_aromatic], [carboxylic_acid]],
            'prediction': -1
        },
        {
            'number': 12,
            'description': 'Modifiers with nitrogen-containing heterocycles where the nitrogen\'s lone pair is less available for coordination, along with a carboxylic acid group (-COOH).',
            'patterns': [['n1nccc1'], [carboxylic_acid]],
            'prediction': -1
        },
        {
            'number': 13,
            'description': 'Modifiers containing bulky or sterically hindering groups near potential coordination sites.',
            'patterns': [[indole_ring], [carboxylic_acid]],
            'prediction': -1
        },
        {
            'number': 14,
            'description': 'Modifiers with side chains containing ketone groups (carbonyl -C=O) adjacent to the carboxylic acid group (-COOH).',
            'patterns': [['[CX3](=O)[CX3](=O)[OX2H1]']],
            'prediction': -1
        },
        {
            'number': 15,
            'description': 'Modifiers with ether linkages (-O-) in flexible chains and a carboxylic acid group (-COOH) where the ether oxygen is available for coordination.',
            'patterns': [[ether_linkage], [carboxylic_acid]],
            'exclude_patterns': [['[OX2][#1]']],  # Exclude terminal ethers/hydroxyls
            'prediction': 1
        }
    ]

    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for group in rule.get('patterns', []):
            compiled_group = [Chem.MolFromSmarts(p) for p in group]
            compiled_patterns.append(compiled_group)
        rule['compiled_patterns'] = compiled_patterns
        if 'exclude_patterns' in rule:
            compiled_excludes = []
            for group in rule['exclude_patterns']:
                compiled_group = [Chem.MolFromSmarts(p) for p in group]
                compiled_excludes.append(compiled_group)
            rule['compiled_exclude_patterns'] = compiled_excludes

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0] * len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for group in rule['compiled_exclude_patterns']:
                        for pat in group:
                            if mol.HasSubstructMatch(pat):
                                match = False
                                break
                        if not match:
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for compiled_group in rule['compiled_patterns']:
                    group_match = False
                    for pat in compiled_group:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            # If a count threshold is specified for this pattern
                            if 'count_threshold' in rule and pat.GetSmarts() in rule['count_threshold']:
                                threshold = rule['count_threshold'][pat.GetSmarts()]
                                if len(matches) >= threshold:
                                    group_match = True
                                    break
                            else:
                                group_match = True
                                break
                    if not group_match:
                        match = False
                        break
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except:
                # In case of any error, append 0
                row.append(0)
        results.append(row)

    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df
--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers with flexible aliphatic chains bearing a terminal primary amino group (-NH₂) and a single carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: The flexibility of the aliphatic chain allows the terminal amino group to effectively coordinate with Fe ions. A single carboxylic acid group avoids internal interactions that could reduce the availability of the amino group for metal coordination. The primary amino group, being unhindered, serves as a strong ligand.

   - **Examples (High Fe/Hf)**: **5-aminopentanoic acid**, **7-aminoheptanoic acid**, **8-aminooctanoic acid**, **(2S)-6-acetamido-2-aminohexanoic acid**.

   - **Counterexamples (Low Fe/Hf)**:
     - **(2S)-2-aminopentanedioic acid** (glutamic acid): Contains two carboxylic acid groups adjacent to the amino group, leading to internal interactions that reduce coordination efficiency.
     - **4-aminobenzoic acid**: The amino group is attached directly to an aromatic ring, decreasing flexibility and hindering effective coordination with Fe ions.

2. **Rule 2**: **Modifiers containing sulfur-functional groups (thiols -SH or thioethers -S-) in conjunction with a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Sulfur atoms have lone pairs and a larger atomic radius, which enhances their ability to coordinate with Fe ions. The presence of sulfur-functional groups strengthens metal-ligand interactions, promoting higher Fe incorporation.

   - **Examples (High Fe/Hf)**: **3-sulfanylpropanoic acid**, **4-sulfanylbenzoic acid**, **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**.

   - **Counterexamples (Low Fe/Hf)**: Modifiers lacking accessible sulfur groups or where sulfur atoms are sterically hindered.

3. **Rule 3**: **Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO₂, halogens like bromo) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing its ability to deprotonate and coordinate with Fe ions. This leads to stronger metal-ligand interactions and increased Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**: **4-nitrobenzoic acid**, **4-(bromomethyl)benzoic acid**.

   - **Counterexamples (Low Fe/Hf)**:
     - **4-methylbenzoic acid**: Contains an electron-donating methyl group, reducing acidity and coordination ability.
     - **4-formylbenzoic acid**: The aldehyde group can engage in resonance, affecting electron density and coordination efficiency.

4. **Rule 4**: **Modifiers containing accessible pyridine nitrogen atoms (pyridyl groups) not sterically hindered, along with a carboxylic acid group (-COOH), predict a high Fe/Hf value.**

   - **Explanation**: The lone pair on the pyridine nitrogen is available for coordination with Fe ions when not involved in resonance or steric hindrance. This enhances metal-ligand interactions and Fe incorporation.

   - **Examples (High Fe/Hf)**: **4-pyridin-4-ylbenzoic acid**, **4-pyridin-4-ylbutanoic acid**.

   - **Counterexamples (Low Fe/Hf)**:
     - **pyridine-3-carboxylic acid**: The nitrogen's position may involve it in resonance with the carboxylate, reducing availability for coordination.
     - **1H-pyrazole-4-carboxylic acid**: Nitrogen atoms are involved in the aromatic system, decreasing coordination potential.

5. **Rule 5**: **Modifiers that are amino acids with aromatic side chains that are not overly bulky, possessing both an amino group (-NH₂) and a carboxylic acid group (-COOH), predict a high Fe/Hf value.**

   - **Explanation**: Amino acids can act as bidentate ligands through their amino and carboxylate groups. Aromatic side chains that are small do not cause steric hindrance, allowing effective coordination with Fe ions.

   - **Examples (High Fe/Hf)**: **(2S)-2-amino-3-phenylpropanoic acid** (phenylalanine).

   - **Counterexamples (Low Fe/Hf)**:
     - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan): The bulky indole ring creates steric hindrance, reducing coordination efficiency.
     - **(2S)-2-aminobutanedioic acid** (aspartic acid): Additional carboxylic acid group adjacent to the amino group can lead to internal interactions.

6. **Rule 6**: **Modifiers with flexible aliphatic chains bearing hydroxyl (-OH) or ether (-O-) groups located away from the carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Hydroxyl or ether groups distant from the carboxylic acid can serve as additional coordination sites without causing steric hindrance. The flexibility of the chain allows these groups to effectively interact with Fe ions.

   - **Examples (High Fe/Hf)**: **7-hydroxyheptanoic acid**, **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**, **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**.

   - **Counterexamples (Low Fe/Hf)**:
     - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (gluconic acid): Multiple hydroxyl groups adjacent to the carboxylic acid can engage in internal hydrogen bonding, reducing coordination ability.
     - **Modifiers with hydroxyl groups directly adjacent to the carboxylic acid, causing steric hindrance.**

7. **Rule 7**: **Modifiers with aliphatic or aromatic chains lacking additional coordinating functional groups beyond the carboxylic acid (-COOH) predict a low Fe/Hf value.**

   - **Explanation**: Without extra coordination sites, these modifiers interact weakly with Fe ions, resulting in lower Fe incorporation into the catalyst. A single carboxylic acid group may not provide sufficient binding strength.

   - **Examples (Low Fe/Hf)**: **octanoic acid**, **4-methylbenzoic acid**, **4-oxoheptanedioic acid**.

   - **Counterexamples (High Fe/Hf)**: Modifiers with additional functional groups capable of coordinating with Fe ions (e.g., amino, hydroxyl, sulfur groups).

8. **Rule 8**: **Modifiers with aromatic rings bearing strong electron-donating groups (e.g., hydroxyl -OH, amino -NH₂) directly attached to the ring and a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid, reducing its ability to deprotonate and coordinate with Fe ions. This weakens metal-ligand interactions and lowers Fe incorporation.

   - **Examples (Low Fe/Hf)**: **4-aminobenzoic acid**, **5-(4-hydroxyphenyl)pentanoic acid**, **3-(4-hydroxyphenyl)propanoic acid**.

   - **Counterexamples (High Fe/Hf)**: Modifiers with electron-withdrawing groups on the aromatic ring (see Rule 3).

9. **Rule 9**: **Modifiers containing multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.**

   - **Explanation**: Multiple hydroxyl groups near the coordination site can form internal hydrogen bonds or create steric hindrance, reducing the effectiveness of the modifier in coordinating with Fe ions.

   - **Examples (Low Fe/Hf)**: **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**, **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**.

   - **Counterexamples (High Fe/Hf)**: Modifiers where hydroxyl groups are positioned away from the carboxylic acid (see Rule 6).

10. **Rule 10**: **Modifiers containing perfluorinated alkyl chains attached to a carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: The highly electronegative fluorine atoms withdraw electron density from the carboxylate group, diminishing its ability to coordinate with Fe ions due to reduced electron availability.

    - **Example (Low Fe/Hf)**: **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers with non-fluorinated alkyl chains and additional coordinating groups (e.g., amino groups).

11. **Rule 11**: **Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Aldehyde groups can participate in resonance with the aromatic ring, affecting the electron density of the carboxylate group and reducing its ability to coordinate with Fe ions.

    - **Examples (Low Fe/Hf)**: **4-formylbenzoic acid**, **5-formyl-2-hydroxybenzoic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers without electron-donating groups adjacent to the carboxylate (see Rule 3).

12. **Rule 12**: **Modifiers containing bulky or sterically hindering groups near potential coordination sites predict a low Fe/Hf value.**

    - **Explanation**: Steric hindrance can prevent effective interaction between the modifier and Fe ions, impeding Fe binding. Bulky side chains can obstruct access to coordinating atoms or groups.

    - **Examples (Low Fe/Hf)**:
      - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (tryptophan): The indole ring is bulky and hinders coordination.
      - **2-[(4-hydroxybenzoyl)amino]acetic acid**: The hydroxybenzoyl group introduces steric bulk near potential coordination sites.

    - **Counterexamples (High Fe/Hf)**: Modifiers with less bulky side chains allowing better access to coordinating groups (see Rule 5).

13. **Rule 13**: **Modifiers with nitrogen-containing heterocycles where the nitrogen's lone pair is involved in aromaticity or resonance, along with a carboxylic acid group (-COOH), predict a low Fe/Hf value.**

    - **Explanation**: If the nitrogen's lone pair is delocalized within the aromatic system, it is less available for coordination with Fe ions, reducing the modifier's effectiveness.

    - **Examples (Low Fe/Hf)**: **1H-pyrazole-4-carboxylic acid**, **2-oxo-1H-pyridine-4-carboxylic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers where the nitrogen's lone pair is accessible (see Rule 4).

14. **Rule 14**: **Modifiers with side chains containing ketone groups (carbonyl -C=O) adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.**

    - **Explanation**: Ketone groups adjacent to the carboxylate can withdraw electron density through resonance or inductive effects, reducing the carboxylate's ability to coordinate with Fe ions.

    - **Example (Low Fe/Hf)**: **4-oxoheptanedioic acid**.

    - **Counterexamples (High Fe/Hf)**: Modifiers where ketone groups are distant from the carboxylic acid or absent (see Rule 6).

15. **Rule 15**: **Modifiers with flexible chains containing ether linkages (-O-) and a carboxylic acid group (-COOH) predict a high Fe/Hf value if the ether oxygen atoms are accessible for coordination.**

    - **Explanation**: Ether oxygen atoms can serve as additional coordination sites. In flexible chains, these oxygens are accessible and can enhance metal-ligand interactions with Fe ions.

    - **Examples (High Fe/Hf)**: **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**, **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**.

    - **Counterexamples (Low Fe/Hf)**: Modifiers where ether oxygens are sterically hindered or involved in internal interactions that reduce coordination ability.

**End of Rules**---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,0,0,1,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,-1,0,0,0,0,0
0,0,0,0,1,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,1,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,1,0,0,0,0,0,0,0,0,1
0,0,0,0,0,0,-1,-1,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.7428571428571429; Test Accuracy: 1.0
    Train Support: 0.34285714285714286; Test Support: 0.0
    Train Confidence: 0.8; Test Confidence: 0.5
    Train Lift: 1.5555555555555558; Test Lift: NONE
    Train Leverage: 0.12244897959183676; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups
    
    # Carboxylic acid group (-COOH)
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    
    # Primary amino group (-NH2)
    primary_amino = '[NX3H2]'
    
    # Aliphatic chain (flexible length)
    aliphatic_chain = '[CX4H2][CX4H2][CX4H2]'
    
    # Sulfur functional groups
    thiol = '[SX2H]'
    thioether = '[#16X2]([#6])[#6]'  # Sulfur atom single-bonded to two carbons
    
    # Aromatic ring with electron-withdrawing groups (nitro, halogens)
    nitro_group = '[NX3](=O)=O'
    halogens = '[F,Cl,Br,I]'
    aryl_halide = f'[c]{halogens}'
    
    # Pyridine ring with accessible nitrogen
    pyridine_ring = 'n1ccccc1'
    
    # Amino acids with aromatic side chains (not overly bulky)
    aromatic_amino_acid = '[NX3][CX4][CX4][c]'
    
    # Hydroxyl (-OH) or ether (-O-) groups distant from carboxylic acid
    distant_hydroxyl = '[OX2H][CX4H2][CX4]([CX3](=O)[OX2H1])'  # Simplified pattern
    ether_linkage = '[#6][OX2][#6]'
    
    # Long aliphatic or aromatic chains without additional coordinating groups
    aliphatic_chain_no_donor = '[CX4]([CX4])[CX4][CX4][CX4][CX3](=O)[OX2H1]'
    
    # Aromatic ring with electron-donating groups directly attached
    aromatic_with_EDG = '[c][OX2H]'
    
    # Multiple hydroxyl groups adjacent to carboxylic acid
    polyol_adjacent = '[CX3](=O)[OX2H1][CX4]([OX2H])[OX2H]'
    
    # Perfluorinated alkyl chains
    perfluoro_alkyl = '[C;X4](F)(F)F'
    
    # Aldehyde adjacent to aromatic carboxylic acid
    aldehyde_adjacent = '[c][CX3](=O)[OX2H1][CX3H](=O)'
    
    # Bulky or sterically hindering groups near coordination sites
    bulky_group = '[CX3](=O)[NX3][c][c]'
    
    # Nitrogen-containing heterocycles with lone pair in aromaticity
    aromatic_nitrogen = '[n]'
    
    # Ketone groups adjacent to carboxylic acid
    ketone_adjacent = '[CX3](=O)[CX3](=O)[OX2H1]'
    
    # Define rules with their patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'Modifiers with flexible aliphatic chains bearing a terminal primary amino group (-NH2) and a single carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [primary_amino, aliphatic_chain, carboxylic_acid],
            'count': {'[CX3](=O)[OX2H1]': 1},
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers containing sulfur-functional groups (thiols -SH or thioethers -S-) in conjunction with a carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [[thiol, thioether], carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'Modifiers with aromatic rings bearing strong electron-withdrawing groups (e.g., nitro -NO2, halogens like bromo) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [[nitro_group, aryl_halide], carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'Modifiers containing accessible pyridine nitrogen atoms (pyridyl groups) not sterically hindered, along with a carboxylic acid group (-COOH), predict a high Fe/Hf value.',
            'patterns': [pyridine_ring, carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Modifiers that are amino acids with aromatic side chains that are not overly bulky, possessing both an amino group (-NH2) and a carboxylic acid group (-COOH), predict a high Fe/Hf value.',
            'patterns': [aromatic_amino_acid, carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Modifiers with flexible aliphatic chains bearing hydroxyl (-OH) or ether (-O-) groups located away from the carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [[distant_hydroxyl, ether_linkage], carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 7,
            'description': 'Modifiers with aliphatic or aromatic chains lacking additional coordinating functional groups beyond the carboxylic acid (-COOH) predict a low Fe/Hf value.',
            'patterns': [carboxylic_acid],
            'exclude_patterns': [primary_amino, thiol, thioether, ether_linkage, nitro_group, aryl_halide, pyridine_ring, aromatic_amino_acid, distant_hydroxyl, aromatic_nitrogen],
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Modifiers with aromatic rings bearing strong electron-donating groups (e.g., hydroxyl -OH, amino -NH2) directly attached to the ring and a carboxylic acid group (-COOH) predict a low Fe/Hf value.',
            'patterns': [aromatic_with_EDG, carboxylic_acid],
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'Modifiers containing multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.',
            'patterns': [polyol_adjacent],
            'prediction': -1
        },
        {
            'number': 10,
            'description': 'Modifiers containing perfluorinated alkyl chains attached to a carboxylic acid group (-COOH) predict a low Fe/Hf value.',
            'patterns': [perfluoro_alkyl, carboxylic_acid],
            'prediction': -1
        },
        {
            'number': 11,
            'description': 'Modifiers with aldehyde groups (-CHO) adjacent to an aromatic carboxylic acid group (-COOH) predict a low Fe/Hf value.',
            'patterns': [aldehyde_adjacent],
            'prediction': -1
        },
        {
            'number': 12,
            'description': 'Modifiers containing bulky or sterically hindering groups near potential coordination sites predict a low Fe/Hf value.',
            'patterns': [bulky_group],
            'prediction': -1
        },
        {
            'number': 13,
            'description': "Modifiers with nitrogen-containing heterocycles where the nitrogen's lone pair is involved in aromaticity or resonance, along with a carboxylic acid group (-COOH), predict a low Fe/Hf value.",
            'patterns': [aromatic_nitrogen, carboxylic_acid],
            'prediction': -1
        },
        {
            'number': 14,
            'description': 'Modifiers with side chains containing ketone groups (carbonyl -C=O) adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value.',
            'patterns': [ketone_adjacent],
            'prediction': -1
        },
        {
            'number': 15,
            'description': 'Modifiers with flexible chains containing ether linkages (-O-) and a carboxylic acid group (-COOH) predict a high Fe/Hf value if the ether oxygen atoms are accessible for coordination.',
            'patterns': [ether_linkage, carboxylic_acid],
            'prediction': 1
        }
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for pat_group in rule['patterns']:
            if isinstance(pat_group, list):
                compiled_group = [Chem.MolFromSmarts(pat) for pat in pat_group]
            else:
                compiled_group = [Chem.MolFromSmarts(pat_group)]
            compiled_patterns.append(compiled_group)
        rule['compiled_patterns'] = compiled_patterns
        
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            exclude_pats = rule['exclude_patterns']
            if not isinstance(exclude_pats, list):
                exclude_pats = [exclude_pats]
            compiled_excludes = []
            for pat in exclude_pats:
                compiled_excludes.append(Chem.MolFromSmarts(pat))
            rule['compiled_exclude_patterns'] = compiled_excludes
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for pat in rule['compiled_exclude_patterns']:
                        if mol.HasSubstructMatch(pat):
                            match = False
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for group in rule['compiled_patterns']:
                    group_match = False
                    for pat in group:
                        if mol.HasSubstructMatch(pat):
                            group_match = True
                            break
                    if not group_match:
                        match = False
                        break
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers with flexible aliphatic chains (five or more carbons) terminating with a primary amino group (-NH₂) and containing a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: The primary amino group and the carboxylic acid can simultaneously coordinate with Fe ions, forming stable chelate complexes. The flexibility of the aliphatic chain minimizes steric hindrance, enhancing metal-ligand interactions and promoting Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **5-aminopentanoic acid**
     - **7-aminoheptanoic acid**
     - **8-aminooctanoic acid**
     - **(2S)-6-acetamido-2-aminohexanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Octanoic acid**: Lacks the amino group needed for chelation.
     - **(2S)-2-aminopentanedioic acid (glutamic acid)**: The presence of two carboxylic acid groups may lead to intramolecular hydrogen bonding, reducing Fe coordination efficiency.

2. **Rule 2**: **Modifiers containing an aromatic ring para-substituted with a pyridyl group (pyridine ring) and a carboxylic acid group predict a high Fe/Hf value.**

   - **Explanation**: The carboxylate oxygen and the pyridine nitrogen serve as bidentate ligands, coordinating effectively with Fe ions. The aromatic system provides rigidity, while the accessible pyridine nitrogen enhances metal binding.

   - **Examples (High Fe/Hf)**:
     - **4-pyridin-4-ylbenzoic acid**
     - **4-pyridin-4-ylbutanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Pyridine-3-carboxylic acid**: The nitrogen is adjacent to the carboxylate, leading to potential steric hindrance and reduced coordination efficiency.

3. **Rule 3**: **Modifiers with an aromatic ring para-substituted with a strong electron-withdrawing group (e.g., nitro -NO₂, bromomethyl -CH₂Br) and a carboxylic acid group predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion. This enhances the ligand's ability to coordinate with Fe ions, leading to stronger metal-ligand interactions.

   - **Examples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**
     - **4-(bromomethyl)benzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **4-methylbenzoic acid**: The methyl group is electron-donating, reducing carboxylate stability and coordination ability.

4. **Rule 4**: **Modifiers with flexible aliphatic chains (five or more carbons) containing both terminal hydroxyl (-OH) and carboxylic acid (-COOH) groups predict a high Fe/Hf value.**

   - **Explanation**: The hydroxyl and carboxylate groups can act as chelating sites, coordinating simultaneously with Fe ions. The chain flexibility allows for effective metal-ligand interactions without significant steric hindrance.

   - **Examples (High Fe/Hf)**:
     - **7-hydroxyheptanoic acid**
     - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Octanoic acid**: Lacks the hydroxyl group necessary for chelation.

5. **Rule 5**: **Modifiers containing sulfur-functional groups (thiol -SH or thioether -S-) along with additional coordinating groups such as amino (-NH₂) or carboxylic acid (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Sulfur atoms provide strong coordination sites due to their lone pairs of electrons. When combined with other coordinating groups, they enhance the overall binding affinity for Fe ions, promoting higher Fe incorporation.

   - **Examples (High Fe/Hf)**:
     - **3-sulfanylpropanoic acid**
     - **4-sulfanylbenzoic acid**
     - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking either the sulfur-functional group or additional coordinating groups.**

6. **Rule 6**: **Modifiers with multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value due to steric hindrance and internal hydrogen bonding.**

   - **Explanation**: The presence of multiple hydroxyl groups near the coordination site can lead to intramolecular hydrogen bonding or steric crowding, reducing the availability of the carboxylate oxygen for coordination with Fe ions.

   - **Examples (Low Fe/Hf)**:
     - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**
     - **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers where hydroxyl groups are positioned away from the carboxylic acid, minimizing steric effects (see Rule 4).**

7. **Rule 7**: **Modifiers containing an aromatic ring para-substituted with a strong electron-donating group (e.g., hydroxyl -OH, amino -NH₂) along with a carboxylic acid group predict a low Fe/Hf value.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid by destabilizing the carboxylate anion. This weakens the ligand's ability to coordinate with Fe ions, resulting in lower Fe incorporation.

   - **Examples (Low Fe/Hf)**:
     - **4-aminobenzoic acid**
     - **4-hydroxybenzoic acid**
     - **5-(4-hydroxyphenyl)pentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with electron-withdrawing groups enhancing coordination ability (see Rule 3).**

8. **Rule 8**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.**

   - **Explanation**: The lack of multiple coordination sites or functional groups reduces the ligand's ability to effectively bind Fe ions, leading to lower Fe incorporation.

   - **Examples (Low Fe/Hf)**:
     - **Octanoic acid**
     - **4-methylbenzoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with additional coordinating groups such as amino or hydroxyl groups (see Rules 1 and 4).**

9. **Rule 9**: **Modifiers containing nitrogen heterocycles where the nitrogen's lone pair is delocalized within an aromatic system (e.g., pyridones, pyrazoles) predict a low Fe/Hf value.**

   - **Explanation**: Delocalization of the nitrogen's lone pair reduces its availability for coordination with Fe ions, weakening metal-ligand interactions.

   - **Examples (Low Fe/Hf)**:
     - **2-oxo-1H-pyridine-4-carboxylic acid**
     - **1H-pyrazole-4-carboxylic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with nitrogen heterocycles where the nitrogen is available for coordination (see Rule 2).**

10. **Rule 10**: **Modifiers with aliphatic chains containing internal ketone groups (C=O) and terminal carboxylic acid groups (-COOH) predict a low Fe/Hf value due to steric hindrance and reduced chain flexibility.**

    - **Explanation**: The presence of internal ketone groups introduces rigidity and potential steric hindrance in the aliphatic chain, preventing effective coordination between the carboxylate oxygen and Fe ions.

    - **Examples (Low Fe/Hf)**:
      - **4-oxoheptanedioic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with flexible chains and without internal ketone groups (see Rule 1).**

**End of Rules**

---

These rules are designed to capture the key structural features of molecular modifiers that influence the Fe/Hf ratio in the catalyst. By focusing on combinations of functional groups and considering underlying physical-chemical properties, the rules provide clear predictions for the Fe/Hf value based on the modifier's structure.

- **Rules 1-5** focus on modifiers that enhance Fe incorporation due to multiple coordination sites, electron-withdrawing effects, and chain flexibility. They cover modifiers with amino groups, pyridyl substitutions, electron-withdrawing substituents, hydroxyl groups, and sulfur-containing groups.

- **Rules 6-10** highlight modifiers that result in lower Fe incorporation due to steric hindrance, electron-donating groups, lack of additional coordinating groups, delocalized nitrogen lone pairs, and internal ketone groups disrupting flexibility.

By applying these rules, researchers can predict whether a new molecular modifier is likely to result in a high or low Fe/Hf value, aiding in the design and optimization of the catalyst for the radical-mediated remote δ-C(sp³)–H bond functionalization reaction.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10
1,0,0,1,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0
1,0,0,1,0,0,0,0,0,0
0,0,0,1,0,0,-1,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0
0,0,0,0,1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,-1
0,0,0,0,0,-1,-1,0,0,0
0,0,0,0,0,-1,0,0,0,-1
0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0
1,0,0,1,0,0,0,0,0,0
1,0,0,1,0,0,0,0,0,0
1,0,0,1,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.7142857142857143; Test Accuracy: 1.0
    Train Support: 0.11428571428571428; Test Support: 0.3333333333333333
    Train Confidence: 1.0; Test Confidence: 0.6666666666666666
    Train Lift: 2.0206971677559915; Test Lift: NONE
    Train Leverage: 0.05741496598639456; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups and substructures used in rules
    
    # Carboxylic acid group (-COOH) and carboxylate anion (-COO-)
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    carboxylate_anion = '[CX3](=O)[O-]'
    carboxylic_acid_patterns = [carboxylic_acid, carboxylate_anion]
    
    # Primary aliphatic amine group (-NH2)
    primary_aliph_amine = '[NX3H2,NX4H3+;!$([N][!C])]'  # Excludes aromatic amines
    
    # Aliphatic chain of five or more carbons (simplified as chain of at least five aliphatic carbons)
    # Note: Matching exact chain length in SMARTS is complex; we'll check in code
    
    # Aromatic ring para-substituted with pyridyl group and carboxylic acid group
    # Simplified pattern for para-substituted benzene ring with pyridine and carboxylic acid
    pyridine_ring = 'c1ccncc1'
    para_substituted_aromatic = '[c]1[c][c][c][c][c]1'
    
    # Nitro group on aromatic ring
    nitro_group = '[NX3+(=O)[O-]]'
    
    # Halogen on aromatic ring
    halogen_on_aromatic = '[c][F,Cl,Br,I]'
    
    # Electron-withdrawing groups on aromatic ring
    ewg_on_aromatic = [nitro_group, halogen_on_aromatic]
    
    # Electron-donating groups on aromatic ring
    hydroxyl_on_aromatic = '[c][OX2H]'
    amino_on_aromatic = '[c][NX3H2,NX3H1]'  # Aromatic amine
    edg_on_aromatic = [hydroxyl_on_aromatic, amino_on_aromatic]
    
    # Sulfur-containing groups
    thiol = '[SX2H]'
    thioether = '[#16X2][#6]'
    sulfur_groups = [thiol, thioether]
    
    # Multiple hydroxyl groups adjacent to carboxylic acid
    # We'll check the number of hydroxyl groups in code
    hydroxyl_group = '[OX2H]'
    
    # Internal ketone group
    ketone_group = '[#6][CX3](=O)[#6]'
    
    # Nitrogen heterocycles with delocalized lone pairs
    pyridone = 'O=[n][c]1cccc1'
    pyrazole = 'n1nccc1'
    delocalized_nitrogen_heterocycles = [pyridone, pyrazole]
    
    # Define the rules with their associated patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'Modifiers with flexible aliphatic chains (five or more carbons) terminating with a primary amino group (-NH₂) and containing a carboxylic acid group (-COOH) predict a high Fe/Hf value.',
            'patterns': [
                carboxylic_acid_patterns,
                [primary_aliph_amine],
            ],
            'check_chain_length': True,
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers containing an aromatic ring para-substituted with a pyridyl group (pyridine ring) and a carboxylic acid group predict a high Fe/Hf value.',
            'patterns': [
                [para_substituted_aromatic],
                [pyridine_ring],
                carboxylic_acid_patterns
            ],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'Modifiers with an aromatic ring para-substituted with a strong electron-withdrawing group (e.g., nitro -NO₂, bromomethyl -CH₂Br) and a carboxylic acid group predict a high Fe/Hf value.',
            'patterns': [
                [para_substituted_aromatic],
                ewg_on_aromatic,
                carboxylic_acid_patterns
            ],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'Modifiers with flexible aliphatic chains (five or more carbons) containing both terminal hydroxyl (-OH) and carboxylic acid (-COOH) groups predict a high Fe/Hf value.',
            'patterns': [
                carboxylic_acid_patterns,
                [hydroxyl_group],
            ],
            'check_chain_length': True,
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Modifiers containing sulfur-functional groups (thiol -SH or thioether -S-) along with additional coordinating groups such as amino (-NH₂) or carboxylic acid (-COOH) predict a high Fe/Hf value.',
            'patterns': [
                sulfur_groups,
                carboxylic_acid_patterns + [primary_aliph_amine]
            ],
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Modifiers with multiple hydroxyl (-OH) groups directly adjacent to the carboxylic acid group (-COOH) predict a low Fe/Hf value due to steric hindrance and internal hydrogen bonding.',
            'patterns': [
                carboxylic_acid_patterns,
                [hydroxyl_group]
            ],
            'hydroxyl_count': 2,
            'prediction': -1
        },
        {
            'number': 7,
            'description': 'Modifiers containing an aromatic ring para-substituted with a strong electron-donating group (e.g., hydroxyl -OH, amino -NH₂) along with a carboxylic acid group predict a low Fe/Hf value.',
            'patterns': [
                [para_substituted_aromatic],
                edg_on_aromatic,
                carboxylic_acid_patterns
            ],
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.',
            'patterns': [
                carboxylic_acid_patterns
            ],
            'exclude_patterns': [
                [primary_aliph_amine],
                sulfur_groups,
                [hydroxyl_group]
            ],
            'prediction': -1
        },
        {
            'number': 9,
            'description': "Modifiers containing nitrogen heterocycles where the nitrogen's lone pair is delocalized within an aromatic system predict a low Fe/Hf value.",
            'patterns': [
                delocalized_nitrogen_heterocycles,
                carboxylic_acid_patterns
            ],
            'prediction': -1
        },
        {
            'number': 10,
            'description': 'Modifiers with aliphatic chains containing internal ketone groups (C=O) and terminal carboxylic acid groups (-COOH) predict a low Fe/Hf value due to steric hindrance and reduced chain flexibility.',
            'patterns': [
                carboxylic_acid_patterns,
                [ketone_group]
            ],
            'prediction': -1
        }
    ]

    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for group in rule.get('patterns', []):
            compiled_group = [Chem.MolFromSmarts(p) for p in group]
            compiled_patterns.append(compiled_group)
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_excludes = []
            for group in rule['exclude_patterns']:
                compiled_group = [Chem.MolFromSmarts(p) for p in group]
                compiled_excludes.append(compiled_group)
            rule['compiled_exclude_patterns'] = compiled_excludes

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for group in rule['compiled_exclude_patterns']:
                        for pat in group:
                            if mol.HasSubstructMatch(pat):
                                match = False
                                break
                        if not match:
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for compiled_group in rule['compiled_patterns']:
                    group_match = False
                    for pat in compiled_group:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            group_match = True
                            break
                    if not group_match:
                        match = False
                        break
                # Additional checks
                if match and rule.get('check_chain_length'):
                    # Check for aliphatic chain length
                    # Find all paths between NH2 and COOH
                    amino_atoms = [atom.GetIdx() for atom in mol.GetAtoms() if atom.GetSymbol() == 'N' and atom.GetTotalNumHs() == 2]
                    carboxy_atoms = [atom.GetIdx() for atom in mol.GetAtoms() if atom.GetSymbol() == 'C' and any([bond.GetBondTypeAsDouble() == 2 and bond.GetOtherAtom(atom).GetSymbol() == 'O' for bond in atom.GetBonds()])]
                    chain_length_ok = False
                    for amino_idx in amino_atoms:
                        for carboxy_idx in carboxy_atoms:
                            paths = Chem.rdmolops.GetShortestPath(mol, amino_idx, carboxy_idx)
                            # Count number of carbon atoms in the path (excluding functional groups)
                            carbon_count = sum(1 for idx in paths if mol.GetAtomWithIdx(idx).GetSymbol() == 'C')
                            if carbon_count >= 5:
                                chain_length_ok = True
                                break
                        if chain_length_ok:
                            break
                    if not chain_length_ok:
                        match = False
                if match and rule.get('hydroxyl_count'):
                    hydroxyl_pat = Chem.MolFromSmarts(hydroxyl_group)
                    hydroxyl_matches = mol.GetSubstructMatches(hydroxyl_pat)
                    if len(hydroxyl_matches) < rule['hydroxyl_count']:
                        match = False
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df
--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers that are aliphatic amino acids with chain lengths of five or more carbons, containing both a primary amino group (-NH₂) and a carboxylic acid group (-COOH), predict a high Fe/Hf value, provided there are no additional carboxyl groups or bulky side chains.**

   - **Explanation**: The presence of both amino and carboxylate groups allows these modifiers to chelate Fe ions effectively. The extended aliphatic chain offers flexibility for coordination without significant steric hindrance, enhancing Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **5-aminopentanoic acid**
     - **7-aminoheptanoic acid**
     - **8-aminooctanoic acid**
     - **(2S)-6-acetamido-2-aminohexanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **(2S)-2-aminopentanedioic acid (glutamic acid)**: Additional carboxyl group may form intramolecular interactions, reducing coordination efficiency.
     - **(2S)-2-amino-3-phenylpropanoic acid (phenylalanine)**: Bulky aromatic side chain hinders effective coordination.

2. **Rule 2**: **Modifiers containing both a thiol group (-SH) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.**

   - **Explanation**: Thiol groups have a strong affinity for Fe ions due to the lone pair of electrons on sulfur. Combined with the carboxylate group, these modifiers provide multiple coordination sites, enhancing Fe binding.

   - **Examples (High Fe/Hf)**:
     - **3-sulfanylpropanoic acid**
     - **4-sulfanylbenzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking thiol groups or with sterically hindered sulfur atoms that impede coordination.**

3. **Rule 3**: **Modifiers that are para-substituted benzoic acids with strong electron-withdrawing groups (e.g., nitro -NO₂, bromomethyl -CH₂Br, sulfonyl -SO₂-) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion, enhancing its ability to coordinate with Fe ions.

   - **Examples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**
     - **4-(bromomethyl)benzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **4-methylbenzoic acid**: Methyl group is electron-donating, decreasing acidity.
     - **4-aminobenzoic acid**: Amino group donates electrons, reducing carboxylate stability.

4. **Rule 4**: **Modifiers that are aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.**

   - **Explanation**: Lack of additional functional groups means fewer coordination sites for Fe ions, resulting in lower Fe incorporation.

   - **Examples (Low Fe/Hf)**:
     - **Octanoic acid**
     - **4-methylbenzoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with additional coordinating groups like amino (-NH₂) or thiol (-SH) groups (see Rules 1 and 2).**

5. **Rule 5**: **Modifiers containing multiple adjacent hydroxyl groups (-OH) near the carboxylic acid group predict a low Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding.**

   - **Explanation**: Adjacent hydroxyl groups may form intramolecular hydrogen bonds, reducing the availability of the carboxylate oxygen for Fe coordination. Steric bulk near the coordination site also hinders effective binding.

   - **Examples (Low Fe/Hf)**:
     - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**
     - **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers where hydroxyl groups are spaced away from the carboxylate group, minimizing steric effects.**

6. **Rule 6**: **Modifiers with nitrogen-containing aromatic rings (e.g., pyridine rings) that can coordinate with Fe ions predict a high Fe/Hf value.**

   - **Explanation**: The lone pair on the nitrogen atom in the aromatic ring can serve as an additional coordination site, enhancing Fe ion binding when combined with the carboxylate group.

   - **Examples (High Fe/Hf)**:
     - **4-pyridin-4-ylbenzoic acid**
     - **4-pyridin-4-ylbutanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Pyridine derivatives where nitrogen is not optimally positioned for coordination (e.g., pyridine-3-carboxylic acid).**

7. **Rule 7**: **Modifiers with bulky aromatic or aliphatic groups adjacent to the carboxylic acid predict a low Fe/Hf value due to steric hindrance affecting coordination.**

   - **Explanation**: Bulky substituents near the carboxylate can prevent Fe ions from effectively approaching and coordinating with the modifier.

   - **Examples (Low Fe/Hf)**:
     - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid**
     - **5-(4-hydroxyphenyl)pentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with smaller or more flexible side chains (see Rule 1).**

8. **Rule 8**: **Modifiers capable of forming stable five- or six-membered chelate rings upon coordination with Fe ions predict a high Fe/Hf value.**

   - **Explanation**: Chelate rings increase the stability of the Fe-modifier complex, promoting greater Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **(2S)-2-aminobutanedioic acid (aspartic acid)**
     - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers that cannot form chelate rings due to structural limitations.**

9. **Rule 9**: **Modifiers with electron-donating groups (e.g., hydroxyl -OH, amino -NH₂) on aromatic rings predict a low Fe/Hf value.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid by destabilizing the carboxylate anion, weakening its coordination with Fe ions.

   - **Examples (Low Fe/Hf)**:
     - **4-hydroxybenzoic acid**
     - **4-aminobenzoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with electron-withdrawing groups enhancing acidity (see Rule 3).**

10. **Rule 10**: **Modifiers containing ether linkages (-O-) in aliphatic chains with a terminal carboxylic acid group predict a high Fe/Hf value due to increased flexibility and potential additional coordination sites.**

    - **Explanation**: Ether oxygen atoms can act as coordination sites or increase chain flexibility, facilitating effective Fe binding.

    - **Examples (High Fe/Hf)**:
      - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**
      - **7-hydroxyheptanoic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking ether linkages or with rigid structures hindering coordination.**

11. **Rule 11**: **Modifiers containing internal aldehyde (-CHO) or ketone (=O) groups near the carboxylic acid predict a low Fe/Hf value due to potential side reactions and reduced coordination efficiency.**

    - **Explanation**: Reactive carbonyl groups can participate in side reactions or form intramolecular interactions, decreasing the availability of the carboxylate for Fe coordination.

    - **Examples (Low Fe/Hf)**:
      - **4-formylbenzoic acid**
      - **5-formyl-2-hydroxybenzoic acid**
      - **4-oxoheptanedioic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers without reactive carbonyl groups near the coordination site.**

12. **Rule 12**: **Modifiers with perfluorinated alkyl chains predict a low Fe/Hf value due to steric hindrance and decreased electron density affecting coordination.**

    - **Explanation**: Perfluorinated chains are bulky and highly electron-withdrawing, reducing electron density on coordinating atoms and hindering Fe binding.

    - **Examples (Low Fe/Hf)**:
      - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with non-fluorinated alkyl chains that are less sterically demanding.**

13. **Rule 13**: **Modifiers containing sulfur atoms in the form of thioethers (-S-) along with additional coordinating groups (e.g., amino groups) predict a high Fe/Hf value.**

    - **Explanation**: Sulfur atoms can coordinate with Fe ions, and the presence of other coordinating groups enhances Fe incorporation into the catalyst.

    - **Examples (High Fe/Hf)**:
      - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking sulfur or additional coordinating groups necessary for effective binding.**

14. **Rule 14**: **Modifiers with nitrogen heterocycles where the nitrogen's lone pair is delocalized within an aromatic system (e.g., pyridones, pyrazoles) predict a low Fe/Hf value due to reduced coordination ability.**

    - **Explanation**: Delocalization of the nitrogen's lone pair decreases its availability for coordination with Fe ions, weakening binding interactions.

    - **Examples (Low Fe/Hf)**:
      - **2-oxo-1H-pyridine-4-carboxylic acid**
      - **1H-pyrazole-4-carboxylic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with nitrogen atoms having available lone pairs for coordination (see Rule 6).**

15. **Rule 15**: **Modifiers that combine electron-withdrawing groups with multiple coordination sites (e.g., carboxylate and carbonyl groups) predict a high Fe/Hf value due to enhanced acidity and increased binding interactions.**

    - **Explanation**: Electron-withdrawing groups increase the acidity of coordinating sites, and multiple coordination points strengthen Fe binding, leading to higher Fe incorporation.

    - **Examples (High Fe/Hf)**:
      - **1,3-dioxo-2-benzofuran-5-carboxylic acid**
      - **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking electron-withdrawing groups or multiple coordination sites necessary for strong Fe binding.**

**End of Rules**

---

These rules elucidate how specific combinations of functional groups and structural features in molecular modifiers influence the Fe/Hf ratio in the catalyst. By combining multiple sub-structures and considering underlying physical-chemical properties, the rules provide clear predictions:

- **High Fe/Hf Value**:
  - Modifiers with multiple coordination sites (e.g., amino and carboxylate groups).
  - Presence of electron-withdrawing groups enhancing acidity and coordination ability.
  - Inclusion of sulfur or nitrogen atoms available for coordination.
  - Ability to form stable chelate rings.
  - Flexible aliphatic chains with ether linkages facilitating coordination.

- **Low Fe/Hf Value**:
  - Modifiers with electron-donating groups reducing acidity and weakening coordination.
  - Steric hindrance from bulky substituents near coordination sites.
  - Presence of functional groups that decrease coordination ability (e.g., multiple adjacent hydroxyls, delocalized nitrogen lone pairs).
  - Lack of additional coordinating groups, limiting Fe binding.
  - Reactive carbonyl groups near coordinating sites causing side reactions.

By applying these rules, chemists can predict the impact of different molecular modifiers on the Fe/Hf ratio in the catalyst. This understanding aids in the rational design and optimization of catalysts for the radical-mediated remote δ-C(sp³)–H bond functionalization reaction, ultimately improving reaction yields and efficiency.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
1,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,1,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,1,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
1,0,0,0,0
1,0,0,0,0
1,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6857142857142857; Test Accuracy: 0.0
    Train Support: 0.08571428571428572; Test Support: 0.0
    Train Confidence: 1.0; Test Confidence: 0.5
    Train Lift: 2.058823529411765; Test Lift: NONE
    Train Leverage: 0.044081632653061226; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    import pandas as pd
    from rdkit import Chem

    # Initialize the rules
    rules = []

    # Define SMARTS patterns
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    carboxylic_acid_anion = '[CX3](=O)[O-]'
    primary_aliph_amine = '[NX3H2][CX4]'
    aliphatic_chain_5 = '[C][C][C][C][C]'
    aromatic_atom = '[a]'
    thiol = '[SX2H]'
    pyridine_ring = '[n]1ccccc1'
    nitro_group = '[NX3](=O)[O-]'
    halogen = '[F,Cl,Br,I]'
    hydroxyl_group = '[OX2H]'
    adjacent_hydroxyl_groups = '[OX2H][CX4][OX2H]'
    aromatic_hydroxyl = '[c][OX2H]'
    ether_linkage = '[#6][OX2][#6]'
    amide_adjacent_aromatic = '[c][CX3](=O)[NX3]'
    aldehyde = '[CX3H1](=O)'
    perfluoroalkyl_chain = '[CX4](F)(F)F'
    thioether = '[#16X2][#6]'
    nitrogen_aromatic_ring = '[n]1[n][n][n][n][n]1'
    
    # Rule 1
    rules.append({
        'number': 1,
        'description': 'Rule 1: Modifiers that are aliphatic amino acids with chain lengths of five or more carbons, containing both a primary amino group (-NH2) and a carboxylic acid group (-COOH), predict a high Fe/Hf value, provided there are no additional carboxyl groups or bulky side chains.',
        'patterns': {
            'must_have': [primary_aliph_amine, carboxylic_acid, aliphatic_chain_5],
            'must_not_have': [aromatic_atom],
            'max_counts': {carboxylic_acid: 1}
        },
        'prediction': 1
    })

    # Rule 2
    rules.append({
        'number':2,
        'description':'Rule 2: Modifiers containing both a thiol group (-SH) and a carboxylic acid group (-COOH) predict a high Fe/Hf value.',
        'patterns':{
            'must_have':[thiol, carboxylic_acid]
        },
        'prediction':1
    })

    # Rule 3
    rules.append({
        'number':3,
        'description':'Rule 3: Modifiers that are para-substituted benzoic acids with strong electron-withdrawing groups (e.g., nitro -NO2, bromomethyl -CH2Br, sulfonyl -SO2-) predict a high Fe/Hf value.',
        'patterns':{
            'must_have':[carboxylic_acid_anion],
            'must_have_substructure': [aromatic_atom],
            'electron_withdrawing_group_para': [nitro_group, halogen]
        },
        'prediction':1
    })

    # Rule 4
    rules.append({
        'number':4,
        'description':'Rule 4: Modifiers that are aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.',
        'patterns':{
            'must_have': [carboxylic_acid],
            'must_not_have': ['[N]', '[S]', '[O]', aromatic_atom]
        },
        'prediction':-1
    })

    # Rule 5
    rules.append({
        'number':5,
        'description':'Rule 5: Modifiers containing multiple adjacent hydroxyl groups (-OH) near the carboxylic acid group predict a low Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding.',
        'patterns':{
            'must_have': [carboxylic_acid, adjacent_hydroxyl_groups]
        },
        'prediction':-1
    })

    # Compile SMARTS patterns
    for rule in rules:
        compiled_must_have = [Chem.MolFromSmarts(pat) for pat in rule['patterns'].get('must_have',[])]
        rule['compiled_must_have'] = compiled_must_have
        compiled_must_not_have = [Chem.MolFromSmarts(pat) for pat in rule['patterns'].get('must_not_have',[])]
        rule['compiled_must_not_have'] = compiled_must_not_have

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # Cannot parse SMILES, append zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Must have patterns
                for pat in rule.get('compiled_must_have',[]):
                    if not mol.HasSubstructMatch(pat):
                        match = False
                        break
                if not match:
                    row.append(0)
                    continue
                # Must not have patterns
                for pat in rule.get('compiled_must_not_have',[]):
                    if mol.HasSubstructMatch(pat):
                        match = False
                        break
                if not match:
                    row.append(0)
                    continue
                # Max counts
                max_counts = rule['patterns'].get('max_counts',{})
                for smarts_str, max_count in max_counts.items():
                    pat = Chem.MolFromSmarts(smarts_str)
                    matches = mol.GetSubstructMatches(pat)
                    if len(matches) > max_count:
                        match = False
                        break
                if not match:
                    row.append(0)
                    continue
                # Additional rule-specific logic can be added here
                row.append(rule['prediction'])
            except Exception as e:
                # On error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers that are straight-chain aliphatic amino acids with a terminal amino group (-NH₂) and a carboxylic acid group (-COOH) at opposite ends, especially with chain lengths of five or more carbons, predict a high Fe/Hf value.**

   - **Explanation**: The presence of both amino and carboxylate groups at opposite ends allows these modifiers to chelate Fe ions effectively. Longer aliphatic chains provide flexibility and reduce steric hindrance, enhancing Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **5-aminopentanoic acid**
     - **7-aminoheptanoic acid**
     - **8-aminooctanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **(2S)-2-aminopentanedioic acid (glutamic acid)**: Additional carboxyl group near the amino group may lead to intramolecular interactions, reducing coordination efficiency.

2. **Rule 2**: **Modifiers that are para-substituted benzoic acids with strong electron-withdrawing groups (e.g., nitro -NO₂, bromomethyl -CH₂Br, sulfanyl -SH) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion, enhancing its ability to coordinate with Fe ions. Sulfanyl groups can also directly coordinate with Fe due to the lone pair on sulfur.

   - **Examples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**
     - **4-(bromomethyl)benzoic acid**
     - **4-sulfanylbenzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **4-aminobenzoic acid**: Amino group is electron-donating, decreasing acidity and weakening coordination with Fe ions.

3. **Rule 3**: **Modifiers containing heteroaromatic rings with nitrogen atoms capable of coordinating (e.g., pyridine rings) predict a high Fe/Hf value.**

   - **Explanation**: The lone pair on the nitrogen atom in the aromatic ring can serve as an additional coordination site. This, combined with the carboxylate group, enhances Fe ion binding.

   - **Examples (High Fe/Hf)**:
     - **4-pyridin-4-ylbenzoic acid**
     - **4-pyridin-4-ylbutanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Pyridine-3-carboxylic acid**: Position of nitrogen relative to the carboxylate may hinder effective coordination, reducing Fe incorporation.

4. **Rule 4**: **Modifiers containing both a thiol group (-SH) and a carboxylic acid group (-COOH), especially when the thiol is positioned favorably for coordination, predict a high Fe/Hf value.**

   - **Explanation**: Thiol groups have a strong affinity for Fe ions due to the lone pair of electrons on sulfur. When combined with the carboxylate group, these modifiers provide multiple coordination sites, enhancing Fe binding.

   - **Examples (High Fe/Hf)**:
     - **3-sulfanylpropanoic acid**
     - **4-sulfanylbenzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking thiol groups or with thiol groups sterically hindered from coordinating effectively.**

5. **Rule 5**: **Modifiers capable of forming stable chelate rings with Fe ions through multiple coordinating groups (e.g., amino and carboxylate groups) predict a high Fe/Hf value.**

   - **Explanation**: Chelate rings increase the stability of the Fe-modifier complex, promoting greater Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **(2S)-2-aminobutanedioic acid (aspartic acid)**
     - **(2S)-2-amino-3-phenylpropanoic acid (phenylalanine)**

   - **Counterexamples (Low Fe/Hf)**:
     - **(2S)-2-aminopentanedioic acid (glutamic acid)**: Despite multiple coordination sites, steric factors or intramolecular interactions may hinder effective chelation.

6. **Rule 6**: **Modifiers with electron-donating groups (e.g., amino -NH₂, hydroxyl -OH) on aromatic rings predict a low Fe/Hf value due to decreased acidity and weakened coordination ability.**

   - **Explanation**: Electron-donating groups decrease the acidity of the carboxylic acid by destabilizing the carboxylate anion, weakening its ability to coordinate with Fe ions.

   - **Examples (Low Fe/Hf)**:
     - **4-aminobenzoic acid**
     - **4-hydroxybenzoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with electron-withdrawing groups enhancing acidity and coordination (see Rule 2).**

7. **Rule 7**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.**

   - **Explanation**: Lack of functional groups other than the carboxylate means fewer coordination sites for Fe ions, resulting in lower Fe incorporation.

   - **Examples (Low Fe/Hf)**:
     - **Octanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with added coordinating groups like amino (-NH₂) or hydroxyl (-OH) along the chain (see Rule 8).**

8. **Rule 8**: **Modifiers with long aliphatic chains containing additional coordinating groups (e.g., hydroxyl -OH, amino -NH₂) at positions favorable for coordination predict a high Fe/Hf value.**

   - **Explanation**: Additional coordinating groups increase the number of binding sites and flexibility, enhancing Fe incorporation into the catalyst.

   - **Examples (High Fe/Hf)**:
     - **7-hydroxyheptanoic acid**
     - **7-aminoheptanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers where coordinating groups are involved in intramolecular hydrogen bonding, reducing availability for Fe coordination.**

9. **Rule 9**: **Modifiers with bulky substituents adjacent to the coordinating groups (e.g., large aromatic rings near the carboxylate) predict a low Fe/Hf value due to steric hindrance affecting coordination.**

   - **Explanation**: Bulky groups can prevent Fe ions from effectively approaching and binding to the coordination sites.

   - **Examples (Low Fe/Hf)**:
     - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid (tryptophan)**
     - **5-(4-hydroxyphenyl)pentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with smaller or more flexible substituents allowing better access to coordination sites.**

10. **Rule 10**: **Modifiers with highly electron-withdrawing groups (e.g., perfluorinated alkyl chains) on aliphatic chains predict a low Fe/Hf value due to decreased electron density on coordinating atoms.**

    - **Explanation**: Electron-withdrawing groups reduce the nucleophilicity of coordinating atoms, weakening their interaction with Fe ions.

    - **Examples (Low Fe/Hf)**:
      - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where electron-withdrawing effects are balanced with strong coordinating groups.**

11. **Rule 11**: **Modifiers containing multiple adjacent hydroxyl groups (-OH) near the carboxylic acid group predict a low Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding.**

    - **Explanation**: Adjacent hydroxyl groups may form intramolecular hydrogen bonds, reducing the availability of the carboxylate oxygen for Fe coordination. Steric bulk near the coordination site also hinders effective binding.

    - **Examples (Low Fe/Hf)**:
      - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where hydroxyl groups are spaced away from the carboxylate group, minimizing steric effects.**

12. **Rule 12**: **Modifiers with ketone or aldehyde groups adjacent to the carboxylic acid predict a low Fe/Hf value due to potential side reactions and reduced coordination efficiency.**

    - **Explanation**: Carbonyl groups can engage in side reactions or form intramolecular interactions, decreasing the availability of the carboxylate for Fe coordination.

    - **Examples (Low Fe/Hf)**:
      - **4-oxoheptanedioic acid**
      - **4-formylbenzoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where carbonyl groups are part of chelating systems enhancing coordination (see Rule 13).**

13. **Rule 13**: **Modifiers capable of forming stable chelate rings involving aromatic systems and adjacent carbonyl groups predict a high Fe/Hf value due to enhanced coordination.**

    - **Explanation**: Chelation through multiple adjacent coordinating atoms increases the stability of the complex with Fe ions, promoting higher incorporation.

    - **Examples (High Fe/Hf)**:
      - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking the structural features necessary for chelation.**

14. **Rule 14**: **Modifiers containing ether linkages (-O-) within aliphatic chains and a terminal carboxylic acid group predict a high Fe/Hf value due to increased flexibility and potential additional coordination sites.**

    - **Explanation**: Ether oxygen atoms can act as coordination sites or increase chain flexibility, facilitating effective Fe binding.

    - **Examples (High Fe/Hf)**:
      - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking ether linkages or with rigid structures hindering coordination.**

15. **Rule 15**: **Modifiers with nitrogen-containing heterocycles where the nitrogen's lone pair is delocalized within an aromatic system (e.g., pyridones, pyrazoles) predict a low Fe/Hf value due to reduced coordination ability.**

    - **Explanation**: Delocalization of the nitrogen's lone pair decreases its availability for coordination with Fe ions, weakening binding interactions.

    - **Examples (Low Fe/Hf)**:
      - **2-oxo-1H-pyridine-4-carboxylic acid**
      - **1H-pyrazole-4-carboxylic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with nitrogen atoms having localized lone pairs available for coordination (see Rule 3).**

**End of Rules**

---

These rules combine multiple sub-structures and consider underlying physical-chemical properties to predict the Fe/Hf value based on the molecular modifiers' structural features:

- **High Fe/Hf Value**:
  - Modifiers with multiple coordination sites (e.g., amino and carboxylate groups).
  - Presence of electron-withdrawing groups enhancing acidity and coordination ability.
  - Inclusion of sulfur or nitrogen atoms available for coordination.
  - Ability to form stable chelate rings.
  - Flexible aliphatic chains with ether linkages or additional coordinating groups.

- **Low Fe/Hf Value**:
  - Modifiers with electron-donating groups reducing acidity and weakening coordination.
  - Steric hindrance from bulky substituents near coordination sites.
  - Presence of functional groups that decrease coordination ability (e.g., multiple adjacent hydroxyls, adjacent carbonyl groups).
  - Lack of additional coordinating groups, limiting Fe binding.
  - Nitrogen heterocycles with delocalized lone pairs reducing coordination capacity.

By applying these rules, chemists can predict the impact of different molecular modifiers on the Fe/Hf ratio in the catalyst. This understanding aids in the rational design and optimization of catalysts for the radical-mediated remote δ-C(sp³)–H bond functionalization reaction, ultimately improving reaction yields and efficiency.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 6,Rule 7,Rule 9,Rule 10
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,-1,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6285714285714286; Test Accuracy: 1.0
    Train Support: 0.17142857142857143; Test Support: 0.0
    Train Confidence: 0.8571428571428571; Test Confidence: 0.5
    Train Lift: 1.6666666666666667; Test Lift: NONE
    Train Leverage: 0.06857142857142857; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    import logging
    logging.basicConfig(level=logging.ERROR)

    # Define SMARTS patterns for functional groups and substructures
    # Carboxylic acid group (-COOH) and carboxylate anion (-COO-)
    carboxylic_acid_patterns = ['[CX3](=O)[OX2H1]', '[CX3](=O)[O-]']
    
    # Primary aliphatic amine group (-NH2) at terminal position
    # Nitrogen with degree 1, connected to carbon with degree 1
    primary_aliphatic_amine_terminal = '[NX3;H2;D1][CX4;D1]'
    
    # Electron-withdrawing groups (EWGs) in para position on benzoic acid
    # Define general pattern for para-substituted benzoic acid with EWG
    para_substituted_benzoic_acid_with_ewg = 'c1ccc([NX3](=O)=O|CBr|[SX2H])cc1C(=O)[O,N]'
    
    # Heteroaromatic rings with nitrogen atoms capable of coordinating, attached to carboxylic acid
    heteroaromatic_nitrogen_with_carboxylic_acid = '[nH0]1cccc1C(=O)[O,N]'
    
    # Thiol group (-SH) adjacent to carboxylic acid group (-COOH)
    thiol_adjacent_to_carboxylic_acid = '[SX2H][CX4][CX3](=O)[OX2H1]'
    
    # Chelating groups capable of forming stable chelate rings with Fe ions
    # e.g., amino and carboxylate groups positioned to chelate
    chelating_motif = '[NX3][CX4][CX3](=O)[O]'  # General chelating motif
    
    # Electron-donating groups (EDGs) on aromatic rings (e.g., amino, hydroxyl, methoxy, methyl)
    edg_on_aromatic_patterns = ['[c][OX2H]', '[c][NX3H2]', '[c][OX2][CH3]', '[c][CH3]']
    
    # Simple aliphatic carboxylic acids without additional coordinating groups
    # Exclude patterns for potential coordinating groups
    exclude_patterns_rule7 = ['[NX3]', '[OX2H]', '[SX2H]', '[CX4][OX2][CX4]', '[F,Cl,Br,I]', '[a]', '[#7,#8,#16]']
    
    # Bulky substituents adjacent to coordinating groups
    bulky_substituent_adjacent_to_carboxylate = '[CX3](=O)[OX2H1][CX4][#6][c]'  # Carboxylic acid adjacent to aromatic ring
    
    # Perfluorinated alkyl chains
    perfluorinated_alkyl_chain = '[CX4]([F])([F])([F])[CX4]([F])([F])[F]'  # General pattern for perfluoroalkanes
    
    # Define rules
    rules = [
        {
            'number': 1,
            'description': 'High Fe/Hf Value (True): Modifiers that are straight-chain aliphatic amino acids with a terminal amino group (-NH2) and a carboxylic acid group (-COOH) at opposite ends, with chain lengths of five or more carbons.',
            'patterns': [
                primary_aliphatic_amine_terminal,  # Terminal amino group
                carboxylic_acid_patterns  # Carboxylic acid group
            ],
            'additional_check': 'chain_length',
            'min_chain_length': 5,
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'High Fe/Hf Value (True): Para-substituted benzoic acids with strong electron-withdrawing groups (e.g., nitro -NO2, bromomethyl -CH2Br, sulfanyl -SH) in the para position.',
            'patterns': [
                para_substituted_benzoic_acid_with_ewg
            ],
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Low Fe/Hf Value (False): Modifiers with electron-donating groups (e.g., amino -NH2, hydroxyl -OH, methoxy -OCH3, methyl -CH3) on aromatic rings.',
            'patterns': [
                edg_on_aromatic_patterns,
                carboxylic_acid_patterns
            ],
            'prediction': -1
        },
        {
            'number': 7,
            'description': 'Low Fe/Hf Value (False): Simple aliphatic carboxylic acids without additional coordinating groups.',
            'patterns': [
                carboxylic_acid_patterns
            ],
            'exclude_patterns': exclude_patterns_rule7,
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'Low Fe/Hf Value (False): Modifiers with bulky substituents adjacent to the coordinating groups (e.g., large aromatic rings near the carboxylate).',
            'patterns': [
                bulky_substituent_adjacent_to_carboxylate
            ],
            'prediction': -1
        },
        {
            'number': 10,
            'description': 'Low Fe/Hf Value (False): Modifiers with highly electron-withdrawing groups (e.g., perfluorinated alkyl chains) on aliphatic chains.',
            'patterns': [
                perfluorinated_alkyl_chain,
                carboxylic_acid_patterns
            ],
            'prediction': -1
        }
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for pattern in rule.get('patterns', []):
            if isinstance(pattern, list):
                compiled_subpatterns = [Chem.MolFromSmarts(p) for p in pattern]
                compiled_patterns.append(compiled_subpatterns)
            else:
                compiled_patterns.append([Chem.MolFromSmarts(pattern)])
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_excludes = [Chem.MolFromSmarts(p) for p in rule['exclude_patterns']]
            rule['compiled_exclude_patterns'] = compiled_excludes
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for exclude_pat in rule['compiled_exclude_patterns']:
                        if mol.HasSubstructMatch(exclude_pat):
                            match = False
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for compiled_group in rule['compiled_patterns']:
                    group_match = False
                    for pat in compiled_group:
                        if pat is not None and mol.HasSubstructMatch(pat):
                            group_match = True
                            break
                    if not group_match:
                        match = False
                        break
                # Additional custom checks
                if match and rule.get('additional_check') == 'chain_length':
                    # Implement custom chain length check for Rule 1
                    min_chain_length = rule.get('min_chain_length', 5)
                    # Find terminal amino groups
                    amine_pattern = Chem.MolFromSmarts(primary_aliphatic_amine_terminal)
                    amine_matches = mol.GetSubstructMatches(amine_pattern)
                    # Find terminal carboxylic acid groups
                    carboxy_patterns = [Chem.MolFromSmarts(p) for p in carboxylic_acid_patterns]
                    carboxy_matches = []
                    for cp in carboxy_patterns:
                        carboxy_matches.extend(mol.GetSubstructMatches(cp))
                    chain_length_match = False
                    for amine_match in amine_matches:
                        amine_idx = amine_match[0]
                        for carboxy_match in carboxy_matches:
                            carboxy_idx = carboxy_match[0]
                            # Find shortest path between amine nitrogen and carboxylic acid carbon
                            path = Chem.rdmolops.GetShortestPath(mol, amine_idx, carboxy_idx)
                            # Exclude start and end atoms (N and C)
                            path = path[1:-1]
                            # Ensure all atoms in path are carbons
                            all_carbons = all(mol.GetAtomWithIdx(idx).GetAtomicNum() == 6 for idx in path)
                            # Ensure no heteroatoms in path
                            no_heteroatoms = all(len([nbr for nbr in mol.GetAtomWithIdx(idx).GetNeighbors() if nbr.GetAtomicNum() != 6 and nbr.GetIdx() not in [amine_idx, carboxy_idx]]) == 0 for idx in path)
                            # Check chain length
                            chain_length = len(path)
                            if all_carbons and no_heteroatoms and chain_length >= min_chain_length:
                                chain_length_match = True
                                break
                        if chain_length_match:
                            break
                    if not chain_length_match:
                        match = False
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                logging.error(f'Error processing SMILES {smi} with rule {rule['number']}: {e}')
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df
--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers that are linear aliphatic amino acids with a primary amino group (-NH₂) at one end and a carboxylic acid group (-COOH) at the other end, with chain lengths of four or more carbons, predict a high Fe/Hf value.**

   - **Explanation**: The presence of both amino and carboxylate groups enables bidentate ligation, effectively chelating Fe ions. Longer carbon chains provide flexibility, facilitating coordination without steric hindrance.

   - **Examples (High Fe/Hf)**:
     - **5-aminopentanoic acid**
     - **7-aminoheptanoic acid**
     - **8-aminooctanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Octanoic acid**: Lacks the amino group necessary for effective chelation.

2. **Rule 2**: **Modifiers that are benzoic acids substituted at the para position with strong electron-withdrawing groups (such as nitro (-NO₂), bromomethyl (-CH₂Br), or sulfanyl (-SH)) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing the carboxylate's ability to coordinate with Fe ions. Sulfur-containing groups can also directly coordinate with Fe due to sulfur's lone pair.

   - **Examples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**
     - **4-(bromomethyl)benzoic acid**
     - **4-sulfanylbenzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **4-methylbenzoic acid**: The methyl group is electron-donating, reducing acidity and weakening coordination ability.
     - **4-aminobenzoic acid**: The amino group is electron-donating, leading to decreased acidity and coordination.

3. **Rule 3**: **Modifiers containing pyridine rings where the nitrogen atom's lone pair is available for coordination (e.g., pyridyl-substituted benzoic acids) predict a high Fe/Hf value.**

   - **Explanation**: Nitrogen atoms in pyridine rings can act as additional coordination sites due to the availability of their lone pair electrons.

   - **Examples (High Fe/Hf)**:
     - **4-pyridin-4-ylbenzoic acid**
     - **4-pyridin-4-ylbutanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Pyridine-3-carboxylic acid**: The nitrogen's position may not be favorable for effective coordination.

4. **Rule 4**: **Modifiers that contain sulfur atoms capable of coordinating (such as thiol groups (-SH)) predict a high Fe/Hf value.**

   - **Explanation**: Sulfur is a soft Lewis base and can form strong coordination bonds with Fe ions, enhancing Fe incorporation.

   - **Examples (High Fe/Hf)**:
     - **3-sulfanylpropanoic acid**
     - **4-sulfanylbenzoic acid**
     - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking sulfur functionalities.**

5. **Rule 5**: **Modifiers with flexible ether linkages (-O-) in their aliphatic chains and a terminal carboxylic acid group predict a high Fe/Hf value due to increased flexibility and potential additional coordination via ether oxygen atoms.**

   - **Explanation**: Ether oxygen atoms can act as coordination sites, and chain flexibility allows for favorable conformations for Fe coordination.

   - **Examples (High Fe/Hf)**:
     - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers without ether linkages or with rigid structures.**

6. **Rule 6**: **Modifiers with multiple adjacent hydroxyl groups (-OH) near the carboxylic acid group predict a low Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding, which reduces coordination efficiency.**

   - **Explanation**: Adjacent hydroxyl groups can hinder Fe coordination by occupying space around coordination sites and forming intramolecular hydrogen bonds.

   - **Examples (Low Fe/Hf)**:
     - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid (gluconic acid)**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers where hydroxyl groups are absent or not adjacent to the carboxylate.**

7. **Rule 7**: **Modifiers with bulky aromatic substituents adjacent to the carboxylate group predict a low Fe/Hf value due to steric hindrance impeding Fe coordination.**

   - **Explanation**: Large substituents near coordination sites prevent effective binding of Fe ions by causing steric crowding.

   - **Examples (Low Fe/Hf)**:
     - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid (tryptophan)**
     - **5-(4-hydroxyphenyl)pentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **(2S)-2-amino-3-phenylpropanoic acid (phenylalanine)**: Smaller aromatic group allows better Fe coordination.

8. **Rule 8**: **Modifiers with electron-donating substituents (like amino (-NH₂) or hydroxyl (-OH) groups) on aromatic rings predict a low Fe/Hf value due to decreased acidity and weakened coordination ability.**

   - **Explanation**: Electron-donating groups increase electron density on the aromatic ring, reducing the acidity of the carboxylic acid and making the carboxylate a weaker ligand.

   - **Examples (Low Fe/Hf)**:
     - **4-aminobenzoic acid**
     - **4-hydroxybenzoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with electron-withdrawing groups enhancing coordination (see Rule 2).**

9. **Rule 9**: **Modifiers with highly fluorinated alkyl chains predict a low Fe/Hf value due to strong electron-withdrawing effects decreasing electron density on coordinating atoms and potentially causing steric hindrance.**

   - **Explanation**: Fluorine's high electronegativity withdraws electron density, weakening coordination bonds.

   - **Examples (Low Fe/Hf)**:
     - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers without extensive fluorination.**

10. **Rule 10**: **Modifiers with aldehyde (-CHO) or ketone (>C=O) groups adjacent to the carboxylic acid predict a low Fe/Hf value due to potential side reactions and competition for coordination with Fe ions.**

    - **Explanation**: Carbonyl groups can interact with Fe ions, but may not form stable complexes, reducing Fe incorporation.

    - **Examples (Low Fe/Hf)**:
      - **4-formylbenzoic acid**
      - **4-oxoheptanedioic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where carbonyl groups are part of chelating structures enhancing Fe coordination (see Rule 11).**

11. **Rule 11**: **Modifiers capable of forming stable chelate rings involving aromatic systems and adjacent coordinating groups (such as adjacent carbonyl and carboxylate groups) predict a high Fe/Hf value due to enhanced stability of the Fe complex.**

    - **Explanation**: Chelation increases the stability of Fe complexes via the chelate effect, promoting higher Fe incorporation.

    - **Examples (High Fe/Hf)**:
      - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers lacking structural features necessary for chelation.**

12. **Rule 12**: **Modifiers containing nitrogen heterocycles where the nitrogen's lone pair is delocalized into the aromatic system (e.g., pyridones, pyrazoles) predict a low Fe/Hf value due to reduced availability of the lone pair for coordination.**

    - **Explanation**: Delocalization reduces the nitrogen's basicity and ability to coordinate with Fe ions.

    - **Examples (Low Fe/Hf)**:
      - **1H-pyrazole-4-carboxylic acid**
      - **2-oxo-1H-pyridine-4-carboxylic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where the nitrogen's lone pair is available for coordination (see Rule 3).**

13. **Rule 13**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value due to insufficient coordination sites for effective Fe binding.**

    - **Explanation**: Without additional functional groups, the modifier provides limited coordination capabilities.

    - **Examples (Low Fe/Hf)**:
      - **Octanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with additional coordinating groups (e.g., amino, hydroxyl).**

14. **Rule 14**: **Modifiers with electron-donating alkyl substituents on aromatic rings, such as methyl groups in the para position, predict a low Fe/Hf value due to decreased acidity and weakened coordination ability.**

    - **Explanation**: Alkyl groups donate electron density, reducing carboxylic acid acidity and carboxylate coordination strength.

    - **Examples (Low Fe/Hf)**:
      - **4-methylbenzoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with electron-withdrawing substituents (see Rule 2).**

15. **Rule 15**: **Modifiers capable of intramolecular hydrogen bonding or interactions that occupy potential coordination sites predict a low Fe/Hf value due to reduced availability for Fe coordination.**

    - **Explanation**: Intramolecular interactions can hinder coordination sites, preventing effective Fe binding.

    - **Examples (Low Fe/Hf)**:
      - **5-formyl-2-hydroxybenzoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where coordinating groups are free for Fe binding without intramolecular hindrance.**

**End of Rules**

---

These rules encapsulate the relationship between the structural features of molecular modifiers and the Fe/Hf ratio in the catalyst. By considering the presence of coordinating groups, electron-withdrawing or -donating substituents, steric factors, and the potential for chelation, we can predict whether a modifier will lead to a high or low Fe/Hf value.

Modifiers predicting **High Fe/Hf Value** generally have:

- **Multiple Coordination Sites**: Amino, thiol, ether oxygen atoms, or pyridine nitrogen atoms enhance Fe coordination.
- **Electron-Withdrawing Groups**: Increase acidity and strengthen the carboxylate's ability to coordinate.
- **Chelation Capability**: Structures that can form stable chelate rings with Fe ions.
- **Structural Flexibility**: Ether linkages or flexible chains facilitate favorable conformations for coordination.

Modifiers predicting **Low Fe/Hf Value** often exhibit:

- **Electron-Donating Groups**: Decrease acidity, reducing coordination strength.
- **Steric Hindrance**: Bulky substituents near coordination sites impede Fe binding.
- **Intramolecular Interactions**: Occupy coordination sites or alter conformation unfavorably.
- **Lack of Additional Coordination Sites**: Simple carboxylic acids without extra functional groups.

By applying these rules, we can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst, aiding in the design of catalysts to optimize reaction yield and efficiency.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,-1,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,-1,0
0,0,1,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,1,0,1,0,0,-1,0,0,0,0,0,0,-1,0
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
0,0,1,0,0,0,-1,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,1,0,-1,0,0,0,0,0,0,-1,0
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,-1,0,0,0,0,0,-1,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0
0,1,0,0,0,0,-1,0,0,0,0,0,0,-1,0
0,0,1,0,0,0,-1,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,1,0,0,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,-1,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,-1,0,0,0,0,0,-1,0
1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0
1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0

---------------------------------------------------------------


    Train Accuracy: 0.8857142857142857; Test Accuracy: 1.0
    Train Support: 0.10857142857142857; Test Support: 0.1
    Train Confidence: 0.7811904761904762; Test Confidence: 0.55
    Train Lift: 1.5681644880174292; Test Lift: NONE
    Train Leverage: 0.026204081632653066; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups and structural features
    
    # Primary aliphatic amine (-NH2) at one end
    primary_aliphatic_amine = '[NX3H2,NX4+][CX4;!$(C([#7,#8])[#7,#8])][CX4;!$(C([#7,#8])[#7,#8])]'
    
    # Carboxylic acid group (-COOH) at the other end
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    
    # Linear aliphatic chain of 4 or more carbons
    linear_aliphatic_chain = 'CCCCC'
    
    # Benzoic acid core
    benzoic_acid = 'c1ccccc1C(=O)[OH]'
    
    # Electron-withdrawing groups at para position
    nitro_group_para = 'c1ccc(cc1)[N+](=O)[O-]'
    bromomethyl_group_para = 'c1ccc(cc1)CBr'
    sulfanyl_group_para = 'c1ccc(cc1)S'
    
    # Pyridine ring with available nitrogen lone pair
    pyridine_ring = '[n]1ccccc1'
    
    # Thiol group (-SH)
    thiol_group = '[SX2H]'
    
    # Ether linkage in aliphatic chain
    ether_linkage = '[#6][OX2][#6]'
    
    # Multiple adjacent hydroxyl groups near carboxylic acid
    adjacent_hydroxyls = '[#6][OX2H][#6][OX2H][#6][C](=O)[OX2H1]'
    
    # Bulky aromatic substituents adjacent to carboxylate group
    bulky_aromatic_adjacent = '[#6]([c])[C](=O)[OX2H1]'
    
    # Electron-donating substituents on aromatic rings
    amino_group_on_aromatic = 'c[NH2]'
    hydroxyl_group_on_aromatic = 'c[OH]'
    
    # Highly fluorinated alkyl chains
    highly_fluorinated_chain = 'C(F)(F)F'
    
    # Aldehyde or ketone groups adjacent to carboxylic acid
    aldehyde_adjacent = '[#6][C](=O)[#6][C](=O)[OX2H1]'
    ketone_adjacent = '[#6][C](=O)[#6][C](=O)[OX2H1]'
    
    # Chelate rings involving aromatic systems
    chelate_structure = 'c1cccc(c1)C(=O)C(=O)'
    
    # Nitrogen heterocycles with delocalized lone pair
    pyrazole = '[nH]1nccc1'
    pyridone = 'O=[n]1ccccc1'
    
    # Simple aliphatic carboxylic acids
    simple_aliphatic_acid = 'CCCCCC(=O)[OH]'
    
    # Electron-donating alkyl substituents on aromatic rings
    methyl_on_aromatic = 'c1cc(ccc1)C'
    
    # Intramolecular hydrogen bonding
    intramolecular_hbond = '[O,NH][C](=O)[OH]'
    
    # Compile SMARTS patterns
    patterns = {
        'Rule 1': {
            'patterns': [primary_aliphatic_amine, carboxylic_acid, linear_aliphatic_chain],
            'prediction': 1
        },
        'Rule 2': {
            'patterns': [benzoic_acid],
            'sub_patterns': [nitro_group_para, bromomethyl_group_para, sulfanyl_group_para],
            'prediction': 1
        },
        'Rule 3': {
            'patterns': [pyridine_ring, carboxylic_acid],
            'prediction': 1
        },
        'Rule 4': {
            'patterns': [thiol_group],
            'prediction': 1
        },
        'Rule 5': {
            'patterns': [ether_linkage, carboxylic_acid],
            'prediction': 1
        },
        'Rule 6': {
            'patterns': [adjacent_hydroxyls],
            'prediction': -1
        },
        'Rule 7': {
            'patterns': [bulky_aromatic_adjacent],
            'prediction': -1
        },
        'Rule 8': {
            'patterns': [carboxylic_acid],
            'sub_patterns': [amino_group_on_aromatic, hydroxyl_group_on_aromatic],
            'prediction': -1
        },
        'Rule 9': {
            'patterns': [highly_fluorinated_chain],
            'prediction': -1
        },
        'Rule 10': {
            'patterns': [aldehyde_adjacent, ketone_adjacent],
            'prediction': -1
        },
        'Rule 11': {
            'patterns': [chelate_structure],
            'prediction': 1
        },
        'Rule 12': {
            'patterns': [pyrazole, pyridone],
            'prediction': -1
        },
        'Rule 13': {
            'patterns': [simple_aliphatic_acid],
            'prediction': -1
        },
        'Rule 14': {
            'patterns': [methyl_on_aromatic],
            'prediction': -1
        },
        'Rule 15': {
            'patterns': [intramolecular_hbond],
            'prediction': -1
        }
    }
    
    # Compile all patterns
    compiled_patterns = {}
    for rule_name, rule_data in patterns.items():
        compiled_patterns[rule_name] = {
            'patterns': [Chem.MolFromSmarts(pat) for pat in rule_data.get('patterns', [])],
            'prediction': rule_data['prediction']
        }
        if 'sub_patterns' in rule_data:
            compiled_patterns[rule_name]['sub_patterns'] = [Chem.MolFromSmarts(pat) for pat in rule_data['sub_patterns']]
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(compiled_patterns))
            continue
        row = []
        for rule_name in compiled_patterns.keys():
            try:
                rule_match = True
                rule_info = compiled_patterns[rule_name]
                # Check main patterns
                for pat in rule_info['patterns']:
                    if not mol.HasSubstructMatch(pat):
                        rule_match = False
                        break
                # If main patterns match, check sub-patterns if any
                if rule_match and 'sub_patterns' in rule_info:
                    sub_match = False
                    for sub_pat in rule_info['sub_patterns']:
                        if mol.HasSubstructMatch(sub_pat):
                            sub_match = True
                            break
                    if not sub_match:
                        rule_match = False
                if rule_match:
                    row.append(rule_info['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=compiled_patterns.keys())
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

1. **Rule 1**: **Modifiers that are linear aliphatic amino acids with a primary amino group (-NH₂) at one end, a carboxylic acid group (-COOH) at the other end, and an unbranched carbon chain of four or more carbons predict a high Fe/Hf value.**

   - **Explanation**: The amino and carboxylate groups can coordinate with Fe ions in a bidentate manner. An extended, flexible carbon chain allows effective binding without significant steric hindrance.

   - **Examples (High Fe/Hf)**:
     - **5-aminopentanoic acid**
     - **7-aminoheptanoic acid**
     - **8-aminooctanoic acid**
     - **(2S)-6-acetamido-2-aminohexanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Octanoic acid**: Lacks the amino group necessary for coordination.
     - **(2S)-2-aminopentanedioic acid (glutamic acid)**: Additional carboxylate group may disrupt optimal coordination.

2. **Rule 2**: **Modifiers that are benzoic acids substituted at the para position with strong electron-withdrawing groups (e.g., nitro (-NO₂), bromomethyl (-CH₂Br), sulfanyl (-SH)) predict a high Fe/Hf value.**

   - **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid, enhancing the carboxylate's ability to coordinate with Fe ions. Sulfur-containing groups can directly coordinate with Fe due to sulfur's lone pairs.

   - **Examples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**
     - **4-(bromomethyl)benzoic acid**
     - **4-sulfanylbenzoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **4-methylbenzoic acid**: Methyl group is electron-donating, reducing acidity and coordination ability.
     - **4-aminobenzoic acid**: Amino group donates electrons, decreasing the carboxylate's effectiveness as a ligand.

3. **Rule 3**: **Modifiers containing a pyridine ring attached to a carboxylic acid predict a high Fe/Hf value due to the additional coordination site provided by the nitrogen atom.**

   - **Explanation**: The nitrogen atom in the pyridine ring can coordinate with Fe ions, enhancing binding.

   - **Examples (High Fe/Hf)**:
     - **4-pyridin-4-ylbenzoic acid**
     - **4-pyridin-4-ylbutanoic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Pyridine-3-carboxylic acid (nicotinic acid)**: Position of nitrogen may not favor coordination with Fe.
     - **1H-pyrazole-4-carboxylic acid**: Nitrogen's lone pair is less available due to aromatic delocalization.

4. **Rule 4**: **Modifiers with thiol groups (-SH) predict a high Fe/Hf value due to the strong coordinating ability of sulfur atoms.**

   - **Explanation**: Sulfur is a soft Lewis base and forms strong bonds with Fe ions, facilitating higher Fe incorporation.

   - **Examples (High Fe/Hf)**:
     - **3-sulfanylpropanoic acid**
     - **4-sulfanylbenzoic acid**
     - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking sulfur-containing groups.**

5. **Rule 5**: **Modifiers that are simple aliphatic or aromatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value due to insufficient coordination sites.**

   - **Explanation**: Without extra functional groups capable of binding Fe ions, these modifiers cannot effectively incorporate Fe into the catalyst.

   - **Examples (Low Fe/Hf)**:
     - **Octanoic acid**
     - **4-methylbenzoic acid**
     - **7-hydroxyheptanoic acid**: Hydroxyl group is distant and less effective for coordination.

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with amino, thiol, or pyridine groups enhancing coordination.**

6. **Rule 6**: **Modifiers with electron-donating substituents (e.g., amino (-NH₂), hydroxyl (-OH), methoxy (-OCH₃)) on aromatic rings predict a low Fe/Hf value due to decreased acidity and weakened coordination ability of the carboxylate group.**

   - **Explanation**: Electron-donating groups increase electron density on the ring, reducing the acidity of the carboxylic acid and weakening its ability to coordinate with Fe ions.

   - **Examples (Low Fe/Hf)**:
     - **4-aminobenzoic acid**
     - **4-hydroxybenzoic acid**
     - **5-(4-hydroxyphenyl)pentanoic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **4-nitrobenzoic acid**: Electron-withdrawing group enhances coordination.

7. **Rule 7**: **Modifiers capable of forming stable chelate rings through adjacent coordinating groups (e.g., carboxylate and amino or hydroxyl groups) predict a high Fe/Hf value due to enhanced complex stability.**

   - **Explanation**: Chelation increases complex stability via the chelate effect, promoting higher Fe incorporation.

   - **Examples (High Fe/Hf)**:
     - **(2S)-2-aminobutanedioic acid (aspartic acid)**
     - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

   - **Counterexamples (Low Fe/Hf)**:
     - **Modifiers lacking adjacent coordinating groups or with steric hindrance preventing chelation.**

8. **Rule 8**: **Modifiers with bulky aromatic substituents adjacent to coordination sites predict a low Fe/Hf value due to steric hindrance impeding Fe coordination.**

   - **Explanation**: Large substituents near coordination sites create spatial constraints, reducing Fe binding efficiency.

   - **Examples (Low Fe/Hf)**:
     - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid (tryptophan)**
     - **(2S)-2-amino-3-phenylpropanoic acid (phenylalanine)**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers with less bulky side chains or flexible structures.**

9. **Rule 9**: **Modifiers with multiple adjacent hydroxyl groups (-OH) near the carboxylic acid predict a low Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding reducing coordination efficiency.**

   - **Explanation**: Adjacent hydroxyl groups can occupy space around coordination sites and form hydrogen bonds, hindering Fe ion binding.

   - **Examples (Low Fe/Hf)**:
     - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid**
     - **2-[(4-hydroxybenzoyl)amino]acetic acid**

   - **Counterexamples (High Fe/Hf)**:
     - **Modifiers where hydroxyl groups are absent or positioned away from coordination sites.**

10. **Rule 10**: **Modifiers containing carbonyl groups (aldehyde (-CHO), ketone (>C=O)) adjacent to the carboxylic acid predict a low Fe/Hf value due to potential competition for coordination and less stable complex formation.**

    - **Explanation**: Carbonyl groups near the coordination site may interact with Fe ions but not form stable chelates, reducing overall Fe incorporation.

    - **Examples (Low Fe/Hf)**:
      - **4-formylbenzoic acid**
      - **4-oxoheptanedioic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where carbonyl groups contribute to stable chelation (see Rule 7).**

11. **Rule 11**: **Modifiers with highly fluorinated alkyl chains predict a low Fe/Hf value due to strong electron-withdrawing effects decreasing the ligand's electron density and coordination ability.**

    - **Explanation**: Fluorine atoms withdraw electron density, weakening the ligand's ability to donate electrons and coordinate with Fe ions.

    - **Examples (Low Fe/Hf)**:
      - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers without extensive fluorination.**

12. **Rule 12**: **Modifiers containing flexible ether linkages (-O-) in their aliphatic chains and a terminal carboxylic acid group predict a high Fe/Hf value due to increased flexibility and additional coordination via ether oxygen atoms.**

    - **Explanation**: Ether oxygen atoms can coordinate with Fe ions, and the flexibility of ether linkages allows the molecule to adopt conformations favorable for chelation.

    - **Examples (High Fe/Hf)**:
      - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers without ether linkages or with rigid structures.**

13. **Rule 13**: **Modifiers containing nitrogen atoms with lone pairs delocalized into an aromatic system (e.g., pyrazoles, pyridones) predict a low Fe/Hf value due to reduced availability for coordination.**

    - **Explanation**: Delocalization of the nitrogen's lone pair decreases its basicity and ability to coordinate with Fe ions.

    - **Examples (Low Fe/Hf)**:
      - **1H-pyrazole-4-carboxylic acid**
      - **2-oxo-1H-pyridine-4-carboxylic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers with pyridine rings where nitrogen can coordinate effectively (see Rule 3).**

14. **Rule 14**: **Modifiers capable of intramolecular hydrogen bonding that occupies potential coordination sites predict a low Fe/Hf value due to reduced availability for Fe coordination.**

    - **Explanation**: Intramolecular hydrogen bonds can tie up functional groups that would otherwise coordinate with Fe ions, decreasing coordination efficiency.

    - **Examples (Low Fe/Hf)**:
      - **5-formyl-2-hydroxybenzoic acid**
      - **5-(4-hydroxyphenyl)pentanoic acid**

    - **Counterexamples (High Fe/Hf)**:
      - **Modifiers where coordinating groups are free from intramolecular interactions.**

15. **Rule 15**: **Modifiers with aliphatic chains containing hydroxyl (-OH) groups distal from the carboxylic acid predict a high Fe/Hf value due to additional coordination sites without causing steric hindrance near the primary coordination site.**

    - **Explanation**: Hydroxyl groups away from the carboxylate can coordinate with Fe ions, enhancing Fe incorporation without interfering with carboxylate coordination.

    - **Examples (High Fe/Hf)**:
      - **7-hydroxyheptanoic acid**

    - **Counterexamples (Low Fe/Hf)**:
      - **Modifiers where hydroxyl groups are adjacent to the carboxylate causing steric hindrance (see Rule 9).**

**End of Rules**

---

These rules establish the relationship between structural features of molecular modifiers and their impact on the Fe/Hf ratio in the catalyst. By considering combinations of functional groups and underlying physicochemical properties, we can predict whether a modifier will lead to a high or low Fe/Hf value.

**Modifiers predicting a High Fe/Hf Value generally have:**

- **Multiple Coordination Sites**: Presence of amino, thiol, ether oxygen atoms, or pyridine nitrogen atoms enhances Fe coordination.
- **Electron-Withdrawing Groups**: Increase the acidity of the carboxylic acid, strengthening the carboxylate's ability to coordinate.
- **Chelation Capability**: Structures that can form stable chelate rings with Fe ions (e.g., adjacent amino and carboxylate groups).
- **Structural Flexibility**: Ether linkages or flexible chains facilitate favorable conformations for coordination.
- **Functional Groups Distal to Coordination Site**: Additional hydroxyl or amino groups positioned away from the carboxylate avoid steric hindrance while providing extra coordination sites.

**Modifiers predicting a Low Fe/Hf Value often exhibit:**

- **Electron-Donating Groups**: Amino, hydroxyl, or alkyl groups increase electron density, decreasing carboxylic acid acidity and weakening coordination strength.
- **Steric Hindrance**: Bulky substituents near coordination sites impede Fe binding due to spatial constraints.
- **Intramolecular Interactions**: Hydrogen bonding or other interactions that occupy coordination sites, reducing availability for Fe coordination.
- **Lack of Additional Coordination Sites**: Simple carboxylic acids without extra functional groups provide insufficient binding for effective Fe incorporation.
- **Delocalized Lone Pairs**: Heterocycles where nitrogen's lone pair is part of an aromatic system are less available for coordination.
- **Extensive Fluorination**: Highly fluorinated chains withdraw electron density, weakening ligand coordination ability.

By applying these rules, chemists can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst. This understanding aids in the design and selection of modifiers to optimize catalyst performance and enhance reaction yields.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6
0,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,-1,0
0,0,0,0,0,0
1,0,0,0,0,0
0,0,0,0,0,0
0,0,0,0,-1,0
0,0,0,0,0,0
0,0,0,0,-1,0
0,0,1,0,0,0
0,0,0,0,-1,0
0,0,0,1,0,0
0,0,0,0,-1,0
0,0,1,0,0,0
1,0,0,0,0,0
0,0,0,0,-1,0
1,0,0,0,0,0
0,0,0,0,-1,0
0,0,0,0,-1,0
0,0,0,1,0,0
0,0,0,0,-1,0
0,0,0,0,-1,0
0,0,0,0,-1,0
0,0,1,0,0,0
0,0,0,0,-1,0
0,0,0,0,0,0
0,0,1,0,0,0
0,0,0,0,-1,0
0,0,0,0,0,0
0,0,0,0,-1,0
0,0,0,0,0,0
0,0,0,0,-1,0
0,0,0,0,-1,0
1,0,0,0,0,0
1,0,0,0,0,0
1,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6857142857142857; Test Accuracy: 0.0
    Train Support: 0.1; Test Support: 0.0
    Train Confidence: 0.9166666666666667; Test Confidence: 0.5
    Train Lift: 1.8872549019607845; Test Lift: NONE
    Train Leverage: 0.04448979591836734; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups and substructures
    
    # General functional groups
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    carboxylate_anion = '[CX3](=O)[O-]'
    primary_amine = '[NX3H2]'
    secondary_amine = '[NX3H1][#6]'
    amino_acid_chain = '[NX3H2][CX4](CC*)C(=O)[OX2H1]'
    linear_aliphatic_chain = '[CH2][CH2][CH2][CH2]+'
    
    electron_withdrawing_groups = '[N+](=O)[O-],[Br],[SH]'
    electron_donating_groups = '[NH2],[OH],[OCH3]'
    pyridine_ring = 'n1ccccc1'
    thiol_group = '[SX2H]'
    
    # Define rules with their associated SMARTS patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'High Fe/Hf Value: Linear aliphatic amino acids with a primary amine, carboxylic acid, and an unbranched carbon chain of four or more carbons.',
            'patterns': [primary_amine, carboxylic_acid],
            'additional_checks': lambda mol: any(
                len(path) >= 6 and all(
                    mol.GetAtomWithIdx(idx).GetDegree() == 2 and mol.GetAtomWithIdx(idx).GetSymbol() == 'C'
                    for idx in path[1:-1]
                ) for path in Chem.FindAllPathsOfLengthN(mol, 6, useBonds=False)
            ),
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'High Fe/Hf Value: Benzoic acids substituted at the para position with strong electron-withdrawing groups.',
            'patterns': [
                'c1ccc(cc1)[CX3](=O)[OX2H1]',  # Benzoic acid core
                '[c][N+](=O)[O-]',  # Nitro group attached to aromatic ring
                '[c]CBr',  # Bromomethyl group attached to aromatic ring
                '[c]S[H]',  # Sulfanyl group attached to aromatic ring
            ],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'High Fe/Hf Value: Modifiers containing a pyridine ring attached to a carboxylic acid.',
            'patterns': [pyridine_ring, carboxylic_acid],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'High Fe/Hf Value: Modifiers with thiol groups (-SH).',
            'patterns': [thiol_group],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Low Fe/Hf Value: Simple aliphatic or aromatic carboxylic acids without additional coordinating groups.',
            'patterns': [carboxylic_acid],
            'exclude_patterns': [primary_amine, secondary_amine, thiol_group, pyridine_ring],
            'prediction': -1
        },
        {
            'number': 6,
            'description': 'Low Fe/Hf Value: Modifiers with electron-donating substituents on aromatic rings.',
            'patterns': [
                'c1ccc(cc1)[CX3](=O)[OX2H1]',  # Benzoic acid core
                '[c][NH2]',  # Amino group attached to aromatic ring
                '[c][OH]',   # Hydroxyl group attached to aromatic ring
                '[c][OCH3]', # Methoxy group attached to aromatic ring
            ],
            'prediction': -1
        },
        # Add additional rules following the same structure...
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for smarts in rule.get('patterns', []):
            try:
                pat = Chem.MolFromSmarts(smarts)
                compiled_patterns.append(pat)
            except:
                compiled_patterns.append(None)
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_excludes = []
            for smarts in rule['exclude_patterns']:
                try:
                    pat = Chem.MolFromSmarts(smarts)
                    compiled_excludes.append(pat)
                except:
                    compiled_excludes.append(None)
            rule['compiled_exclude_patterns'] = compiled_excludes
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'compiled_exclude_patterns' in rule:
                    for pat in rule['compiled_exclude_patterns']:
                        if pat is not None and mol.HasSubstructMatch(pat):
                            match = False
                            break
                if not match:
                    row.append(0)
                    continue
                # Check required patterns
                for pat in rule['compiled_patterns']:
                    if pat is None or not mol.HasSubstructMatch(pat):
                        match = False
                        break
                # Additional checks if any
                if match and 'additional_checks' in rule:
                    if not rule['additional_checks'](mol):
                        match = False
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except:
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule['number']}' for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

---

**Rule 1**: **Modifiers that are ω-amino aliphatic carboxylic acids predict a high Fe/Hf value.**

- **Explanation**: Linear aliphatic carboxylic acids with an amino group at the terminal (ω) position can act as bidentate ligands. The amino and carboxylate groups coordinate simultaneously with Fe ions, forming stable chelate rings that enhance Fe incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **5-aminopentanoic acid**
  - **7-aminoheptanoic acid**
  - **8-aminooctanoic acid**

- **Counterexamples (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): The amino group is too close to the carboxylate groups, leading to strained or less favorable chelate rings.

---

**Rule 2**: **Modifiers containing thiol groups (-SH) predict a high Fe/Hf value.**

- **Explanation**: Thiol groups are soft Lewis bases with a strong affinity for transition metals like Fe. The -SH group provides an additional coordination site, enhancing Fe binding and incorporation.

- **Examples (High Fe/Hf)**:
  - **3-sulfanylpropanoic acid**
  - **4-sulfanylbenzoic acid**

---

**Rule 3**: **Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro (-NO₂), halogens) para to the carboxyl group predict a high Fe/Hf value.**

- **Explanation**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion. This enhancement facilitates deprotonation and strengthens coordination with Fe ions, promoting higher Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **4-nitrobenzoic acid**
  - **4-(bromomethyl)benzoic acid**

- **Counterexamples (Low Fe/Hf)**:
  - **4-methylbenzoic acid**: The methyl group is electron-donating, decreasing acidity and weakening coordination ability.

---

**Rule 4**: **Modifiers containing pyridine rings predict a high Fe/Hf value if the nitrogen is positioned to coordinate effectively with Fe ions.**

- **Explanation**: The lone pair on the pyridine nitrogen atom can act as a coordination site for Fe ions. When the nitrogen's position allows for favorable geometry, it enhances Fe binding.

- **Examples (High Fe/Hf)**:
  - **4-pyridin-4-ylbenzoic acid**
  - **4-pyridin-4-ylbutanoic acid**

- **Counterexamples (Low Fe/Hf)**:
  - **Pyridine-3-carboxylic acid** (Nicotinic acid): The nitrogen's position may not favor effective coordination due to geometric constraints or steric hindrance.

---

**Rule 5**: **Modifiers with ether linkages (-O-) in their aliphatic chains and a terminal carboxylic acid group predict a high Fe/Hf value.**

- **Explanation**: Ether oxygen atoms can serve as additional coordination sites for Fe ions. The flexibility of ether linkages allows the molecule to adopt conformations favorable for chelation, enhancing Fe incorporation.

- **Example (High Fe/Hf)**:
  - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

---

**Rule 6**: **Modifiers that are aromatic carboxylic acids with electron-donating groups (e.g., amino (-NH₂), hydroxyl (-OH)) ortho or para to the carboxylate predict a low Fe/Hf value.**

- **Explanation**: Electron-donating groups increase electron density on the aromatic ring, decreasing the acidity of the carboxylic acid. This reduction weakens the ligand's ability to coordinate with Fe ions, leading to lower Fe incorporation.

- **Examples (Low Fe/Hf)**:
  - **4-aminobenzoic acid**
  - **4-hydroxybenzoic acid**

---

**Rule 7**: **Modifiers with multiple adjacent hydroxyl groups (-OH) near the carboxylic acid predict a low Fe/Hf value due to intramolecular hydrogen bonding and steric hindrance.**

- **Explanation**: Adjacent hydroxyl groups can form intramolecular hydrogen bonds, occupying coordination sites and hindering Fe binding. Additionally, steric bulk near the carboxylate reduces accessibility for Fe ions.

- **Example (Low Fe/Hf)**:
  - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (Gluconic acid)

---

**Rule 8**: **Modifiers with extensive fluorination in aliphatic chains predict a low Fe/Hf value due to reduced electron density for coordination.**

- **Explanation**: Fluorine atoms are highly electronegative and withdraw electron density from the ligand. This electron withdrawal weakens the ligand's ability to donate electrons and coordinate with Fe ions, resulting in reduced Fe incorporation.

- **Example (Low Fe/Hf)**:
  - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

---

**Rule 9**: **Modifiers that are simple aliphatic or aromatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.**

- **Explanation**: Lack of extra functional groups capable of coordination results in weaker Fe binding and lower incorporation into the catalyst.

- **Examples (Low Fe/Hf)**:
  - **Octanoic acid**
  - **4-methylbenzoic acid**

---

**Rule 10**: **Modifiers capable of forming stable five-membered chelate rings with Fe ions predict a high Fe/Hf value.**

- **Explanation**: Five-membered chelate rings provide optimal geometry for strong coordination with Fe ions, enhancing Fe incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **(2S)-2-aminobutanedioic acid** (Aspartic acid): The amino and carboxylate groups form a stable five-membered ring with Fe.
  - **(2S)-2-amino-3-phenylpropanoic acid** (Phenylalanine)

- **Counterexamples (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): Forms six-membered rings, which are less favorable for strong chelation.

---

**Rule 11**: **Modifiers containing electron-rich heterocycles with available lone pairs predict a high Fe/Hf value due to effective coordination.**

- **Explanation**: Heterocycles like benzofuran and benzothiazole have heteroatoms with lone pairs that can coordinate with Fe ions if they are not delocalized. This enhances Fe binding.

- **Example (High Fe/Hf)**:
  - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

- **Counterexamples (Low Fe/Hf)**:
  - **2-oxo-1H-pyridine-4-carboxylic acid**: The nitrogen's lone pair is involved in aromatic delocalization, reducing availability for coordination.

---

**Rule 12**: **Modifiers containing bulky aromatic rings or substituents near coordination sites predict a low Fe/Hf value due to steric hindrance.**

- **Explanation**: Bulky groups close to coordination sites can prevent Fe ions from effectively binding due to spatial constraints, reducing Fe incorporation.

- **Example (Low Fe/Hf)**:
  - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (Tryptophan)

---

**Rule 13**: **Modifiers with hydroxyl groups (-OH) distal from the carboxylic acid in flexible aliphatic chains predict a high Fe/Hf value.**

- **Explanation**: Hydroxyl groups located away from the carboxylate can act as additional coordination sites without causing steric hindrance. The flexibility of the chain allows optimal positioning for Fe binding.

- **Example (High Fe/Hf)**:
  - **7-hydroxyheptanoic acid**

---

**Rule 14**: **Modifiers possessing both amino and thioether groups predict a high Fe/Hf value due to multiple coordination sites.**

- **Explanation**: The presence of both amino and sulfur-containing groups provides multiple coordination points, enhancing Fe binding through chelation.

- **Example (High Fe/Hf)**:
  - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

---

**Rule 15**: **Modifiers that contain methoxy groups (-OCH₃) on aromatic rings can predict a high Fe/Hf value if the overall structure promotes coordination.**

- **Explanation**: While methoxy groups are electron-donating, in some cases they can participate in stabilizing interactions or influence the conformation to favor Fe coordination.

- **Example (High Fe/Hf)**:
  - **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**

---

**End of Rules**

---

These rules illustrate how combinations of functional groups and structural features in molecular modifiers influence the Fe/Hf ratio in the catalyst. By considering the underlying physicochemical properties, such as electron density, coordination sites, steric factors, and the ability to form chelate rings, we can predict whether a modifier will lead to a high or low Fe/Hf value.

**Modifiers predicting a High Fe/Hf Value generally have:**

- **Multiple Coordination Sites**: Presence of amino, thiol, ether oxygen atoms, or heterocyclic nitrogen/oxygen atoms enhances Fe coordination.
- **Electron-Withdrawing Groups**: Increase the acidity of the carboxylic acid, strengthening coordination with Fe ions.
- **Chelation Capability**: Ability to form stable five-membered chelate rings with Fe ions.
- **Structural Flexibility**: Flexible chains with additional coordinating groups reduce steric hindrance and facilitate coordination.
- **Available Lone Pairs on Heteroatoms**: Heterocycles with nitrogen or oxygen atoms not involved in delocalization can coordinate effectively.

**Modifiers predicting a Low Fe/Hf Value often exhibit:**

- **Electron-Donating Groups**: Amino, hydroxyl, or alkyl groups increase electron density, decreasing carboxylic acid acidity and weakening coordination strength.
- **Steric Hindrance**: Bulky substituents near coordination sites impede Fe binding.
- **Intramolecular Interactions**: Hydrogen bonding or internal reactions that occupy coordination sites reduce Fe coordination.
- **Lack of Additional Coordination Sites**: Simple carboxylic acids without extra functional groups provide insufficient binding.
- **Delocalized Lone Pairs**: Heteroatoms whose lone pairs are involved in aromatic systems, reducing availability for coordination.
- **Extensive Fluorination**: Highly fluorinated chains withdraw electron density, weakening ligand coordination ability.

By applying these rules, chemists can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst. This understanding aids in the design and selection of modifiers to optimize catalyst performance and enhance reaction yields.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12,Rule 13,Rule 14,Rule 15
1,0,0,0,1,0,0,0,-1,0,0,0,0,0,0
1,0,0,0,0,0,0,0,-1,1,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
1,0,0,0,0,0,0,0,-1,1,0,0,0,0,0
1,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,1,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,1,0,0,0,0,-1,0,1,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,1,0,0
0,1,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,0,1,0,0,0,-1,0,0,0,0,0,0
0,0,0,1,0,0,0,0,-1,0,1,-1,0,0,0
1,0,0,0,0,0,0,0,-1,1,1,-1,0,0,0
0,0,0,0,0,0,0,-1,-1,0,0,0,0,0,0
1,0,0,0,0,0,0,0,-1,1,1,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,1,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
0,0,0,1,0,0,0,0,-1,0,1,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
1,0,0,0,0,0,0,0,-1,1,0,0,0,0,0
0,0,0,1,0,0,0,0,-1,0,1,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,1
0,0,0,0,0,0,0,0,-1,1,1,-1,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,0,0,-1,0,1,-1,0,0,0
1,0,0,0,0,0,0,0,-1,0,0,0,0,0,0
1,0,0,0,0,0,0,0,-1,1,0,0,0,0,0
1,0,0,0,0,0,0,0,-1,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.7428571428571429; Test Accuracy: 1.0
    Train Support: 0.09523809523809523; Test Support: 0.3333333333333333
    Train Confidence: 0.9259259259259259; Test Confidence: 0.6666666666666666
    Train Lift: 1.9063180827886714; Test Lift: NONE
    Train Leverage: 0.039727891156462594; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups and features used in the rules

    # Carboxylic acid group (-COOH)
    carboxylic_acid = '[CX3](=O)[OX2H1]'

    # Primary aliphatic amine group (-NH2)
    primary_aliphatic_amine = '[NX3H2][CX4]'  # Nitrogen with two hydrogens attached to an sp3 carbon

    # Thiol group (-SH)
    thiol_group = '[#16X2H]'  # Sulfur with one hydrogen

    # Thioether group (-S-)
    thioether_group = '[#16X2][CX4][CX4]'  # Sulfur between two carbons

    # Nitro group (-NO2) para to carboxyl group
    para_nitro_benzene = 'c1ccc(cc1)[N+](=O)[O-]'

    # Halogen (F, Cl, Br, I) para to carboxyl group
    para_halogen_benzene = 'c1ccc(cc1)[F,Cl,Br,I]'

    # Pyridine ring with nitrogen in position to coordinate effectively
    pyridine_ring = 'n1ccccc1'

    # Ether linkage in aliphatic chains (-O-)
    ether_linkage = '[CX4][OX2][CX4]'

    # Electron-donating groups (EDGs) ortho or para to carboxylate
    ortho_para_edg = 'c1cc([NX3H2,NX3H1][CX4])[cH][cH][c]1'  # Amino group ortho or para
    ortho_para_hydroxyl = 'c1cc([OX2H])[cH][cH][c]1'  # Hydroxyl group ortho or para

    # Multiple adjacent hydroxyl groups (-OH) near carboxylic acid
    polyol = '[CX4]([OX2H])[CX4]([OX2H])[CX4](=O)[OX2H1]'

    # Extensive fluorination in aliphatic chains
    perfluoro_chain = '[CX4](F)(F)F'

    # Simple aliphatic or aromatic carboxylic acids without additional coordinating groups
    simple_carboxylic_acid = '[CX3](=O)[OX2H1]'

    # Five-membered chelate ring formation capability
    chelate_five_membered = '[NX3][CX4][CX3](=O)[OX2H1]'

    # Electron-rich heterocycles with available lone pairs
    electron_rich_heterocycle = '[c,n,o]1[c,n,o][c,n,o][c,n,o][c,n,o][c,n,o]1'

    # Bulky aromatic rings or substituents near coordination sites
    bulky_aromatic = 'c1cc(ccc1)[C,R]'

    # Hydroxyl groups (-OH) distal from carboxylic acid in flexible aliphatic chains
    distal_hydroxyl = '[OX2H][CX4][CX4][CX4][CX3](=O)[OX2H1]'

    # Amino and thioether groups
    amino_thioether = '[NX3][CX4][CX4][SX2][CX4]'

    # Methoxy groups (-OCH3) on aromatic rings
    methoxy_aromatic = 'c1cc([OX2][CH3])ccc1'

    # Compile SMARTS patterns
    patterns = {
        'Rule 1': [Chem.MolFromSmarts(primary_aliphatic_amine), Chem.MolFromSmarts(carboxylic_acid)],
        'Rule 2': [Chem.MolFromSmarts(thiol_group)],
        'Rule 3': [Chem.MolFromSmarts(para_nitro_benzene), Chem.MolFromSmarts(para_halogen_benzene)],
        'Rule 4': [Chem.MolFromSmarts(pyridine_ring)],
        'Rule 5': [Chem.MolFromSmarts(ether_linkage), Chem.MolFromSmarts(carboxylic_acid)],
        'Rule 6': [Chem.MolFromSmarts(ortho_para_edg), Chem.MolFromSmarts(ortho_para_hydroxyl)],
        'Rule 7': [Chem.MolFromSmarts(polyol), Chem.MolFromSmarts(carboxylic_acid)],
        'Rule 8': [Chem.MolFromSmarts(perfluoro_chain), Chem.MolFromSmarts(carboxylic_acid)],
        'Rule 9': [Chem.MolFromSmarts(simple_carboxylic_acid)],
        'Rule 10': [Chem.MolFromSmarts(chelate_five_membered)],
        'Rule 11': [Chem.MolFromSmarts(electron_rich_heterocycle)],
        'Rule 12': [Chem.MolFromSmarts(bulky_aromatic)],
        'Rule 13': [Chem.MolFromSmarts(distal_hydroxyl)],
        'Rule 14': [Chem.MolFromSmarts(amino_thioether)],
        'Rule 15': [Chem.MolFromSmarts(methoxy_aromatic)],
    }

    # Predictions associated with each rule (1 for high Fe/Hf value, -1 for low Fe/Hf value)
    predictions = {
        'Rule 1': 1,
        'Rule 2': 1,
        'Rule 3': 1,
        'Rule 4': 1,
        'Rule 5': 1,
        'Rule 6': -1,
        'Rule 7': -1,
        'Rule 8': -1,
        'Rule 9': -1,
        'Rule 10': 1,
        'Rule 11': 1,
        'Rule 12': -1,
        'Rule 13': 1,
        'Rule 14': 1,
        'Rule 15': 1,
    }

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(patterns))
            continue
        row = []
        for rule, pats in patterns.items():
            try:
                match = True
                for pat in pats:
                    if not mol.HasSubstructMatch(pat):
                        match = False
                        break
                if match:
                    row.append(predictions[rule])
                else:
                    row.append(0)
            except Exception:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=patterns.keys())
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

---

**Rule 1**: **Modifiers that are ω-amino aliphatic carboxylic acids with chain lengths of 5 carbons or more predict a **high** Fe/Hf value.**

- **Description**: Linear aliphatic carboxylic acids with an amino group at the terminal (omega) position and sufficient chain length coordinate effectively with Fe ions. The amino and carboxylate groups simultaneously bind to Fe, forming stable chelate rings or bonds. Longer chains provide flexibility and proper orientation for optimal coordination.

- **Examples (High Fe/Hf)**:
  - **5-aminopentanoic acid**
  - **7-aminoheptanoic acid**
  - **8-aminooctanoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): The amino group is not at the terminal position, and the presence of an additional carboxyl group may lead to less favorable coordination geometry or competing interactions.

---

**Rule 2**: **Modifiers containing thiol groups (-SH) predict a **high** Fe/Hf value.**

- **Description**: Thiol groups are soft Lewis bases with a strong affinity for transition metals like Fe. The sulfur atom provides an excellent coordination site due to its polarizability, enhancing Fe binding and incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **3-sulfanylpropanoic acid**
  - **4-sulfanylbenzoic acid**

---

**Rule 3**: **Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro (-NO₂), halogens) at the para position predict a **high** Fe/Hf value.**

- **Description**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion. This enhanced acidity facilitates deprotonation and strengthens coordination with Fe ions. Additionally, these substituents may promote π-backbonding interactions with Fe.

- **Examples (High Fe/Hf)**:
  - **4-nitrobenzoic acid**
  - **4-(bromomethyl)benzoic acid**

- **Counterexamples (Low Fe/Hf)**:
  - **4-methylbenzoic acid**: Methyl is electron-donating, decreasing acidity and weakening coordination.
  - **4-formylbenzoic acid**: Despite being electron-withdrawing, the aldehyde may not participate effectively in coordination.

---

**Rule 4**: **Modifiers containing a pyridine ring attached at the para position to a carboxylic acid predict a **high** Fe/Hf value.**

- **Description**: The lone pair on the pyridine nitrogen atom serves as an additional coordination site for Fe ions. When attached at the para position relative to the carboxyl group, the modifier can act as a bidentate ligand, forming stable chelate complexes and enhancing Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **4-pyridin-4-ylbenzoic acid**
  - **4-pyridin-4-ylbutanoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **Pyridine-3-carboxylic acid** (Nicotinic acid): The nitrogen's position does not favor bidentate coordination due to less optimal geometry.

---

**Rule 5**: **Modifiers that are aromatic carboxylic acids with electron-donating groups (e.g., hydroxyl (-OH), amino (-NH₂), methyl (-CH₃)) at the para position predict a **low** Fe/Hf value.**

- **Description**: Electron-donating groups increase electron density on the aromatic ring, decreasing the acidity of the carboxylic acid. This reduction weakens the ligand's ability to coordinate with Fe ions, leading to lower Fe incorporation.

- **Examples (Low Fe/Hf)**:
  - **4-aminobenzoic acid**
  - **4-hydroxybenzoic acid**
  - **4-methylbenzoic acid**

---

**Rule 6**: **Modifiers with multiple hydroxyl groups near the carboxylic acid predict a **low** Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding.**

- **Description**: Adjacent hydroxyl groups can form intramolecular hydrogen bonds, occupying potential coordination sites and hindering Fe binding. Steric bulk near the carboxylate reduces accessibility for Fe ions.

- **Example (Low Fe/Hf)**:
  - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (Gluconic acid)

---

**Rule 7**: **Modifiers with extensive fluorination in aliphatic chains predict a **low** Fe/Hf value due to reduced electron density for coordination.**

- **Description**: Fluorine atoms are highly electronegative and withdraw electron density from the ligand. This electron withdrawal decreases the basicity of the carboxylate group, weakening its ability to coordinate with Fe ions.

- **Example (Low Fe/Hf)**:
  - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

---

**Rule 8**: **Simple aliphatic or aromatic carboxylic acids without additional coordinating groups predict a **low** Fe/Hf value.**

- **Description**: Lack of extra functional groups capable of coordination results in weaker Fe binding and lower incorporation into the catalyst.

- **Examples (Low Fe/Hf)**:
  - **Octanoic acid**
  - **4-formylbenzoic acid**

---

**Rule 9**: **Modifiers containing ether linkages (-O-) in their aliphatic chains and a terminal carboxylic acid predict a **high** Fe/Hf value.**

- **Description**: Ether oxygen atoms can serve as additional coordination sites for Fe ions. The flexibility provided by ether linkages allows the molecule to adopt conformations favorable for chelation, enhancing Fe incorporation.

- **Example (High Fe/Hf)**:
  - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

---

**Rule 10**: **Modifiers containing methoxy groups (-OCH₃) on aromatic rings predict a **high** Fe/Hf value when combined with other coordinating functionalities.**

- **Description**: Methoxy groups are electron-donating but can influence the conformation of the molecule to favor Fe coordination, especially when other coordinating groups are present. They may participate in secondary interactions that stabilize Fe binding.

- **Example (High Fe/Hf)**:
  - **4-(3,4-dimethoxyphenyl)-4-oxobutanoic acid**

---

**Rule 11**: **Modifiers capable of forming stable five-membered chelate rings with Fe ions predict a **high** Fe/Hf value.**

- **Description**: Five-membered chelate rings provide optimal geometry for strong coordination with Fe ions, enhancing Fe incorporation into the catalyst.

- **Example (High Fe/Hf)**:
  - **(2S)-2-aminobutanedioic acid** (Aspartic acid): The amino and carboxylate groups form a stable five-membered ring with Fe.

- **Counterexample (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): Forms a larger six-membered ring, which is less favorable for strong chelation.

---

**Rule 12**: **Modifiers containing heterocycles with available nitrogen or oxygen atoms for coordination predict a **high** Fe/Hf value.**

- **Description**: Heterocycles like benzofuran with oxygen atoms or pyridine rings with nitrogen atoms not involved in aromatic delocalization can coordinate effectively with Fe ions, enhancing Fe binding.

- **Example (High Fe/Hf)**:
  - **1,3-dioxo-2-benzofuran-5-carboxylic acid**

- **Counterexample (Low Fe/Hf)**:
  - **1H-pyrazole-4-carboxylic acid**: The pyrazole nitrogen's lone pair is involved in aromaticity, reducing its availability for coordination.

---

**Rule 13**: **Modifiers possessing both amino and thioether (-S-) groups predict a **high** Fe/Hf value due to multiple coordination sites.**

- **Description**: The presence of both amino and sulfur-containing thioether groups provides multiple coordination points, enhancing Fe binding through chelation and increasing Fe incorporation.

- **Example (High Fe/Hf)**:
  - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

---

**Rule 14**: **Modifiers with terminal hydroxyl groups on aliphatic chains longer than six carbons predict a **high** Fe/Hf value due to enhanced flexibility and coordination sites.**

- **Description**: The hydroxyl group can act as an additional coordination site. Longer aliphatic chains provide flexibility, allowing the hydroxyl and carboxylate groups to simultaneously coordinate with Fe ions.

- **Example (High Fe/Hf)**:
  - **7-hydroxyheptanoic acid**

---

**Rule 15**: **Modifiers with amide functional groups in addition to amino groups predict a **high** Fe/Hf value due to increased coordination potential.**

- **Description**: Amide oxygen and nitrogen can coordinate with Fe ions. When combined with amino groups, these modifiers offer multiple coordination sites, enhancing Fe binding and incorporation.

- **Example (High Fe/Hf)**:
  - **(2S)-6-acetamido-2-aminohexanoic acid**

---

**End of Rules**

---

These rules illustrate how combinations of functional groups and structural features in molecular modifiers influence the Fe/Hf ratio in the catalyst. By considering the underlying physicochemical properties, such as coordination chemistry, electron donating/withdrawing effects, steric factors, and the ability to form chelate rings, we can predict whether a modifier will lead to a **high** or **low** Fe/Hf value.

**Modifiers predicting a High Fe/Hf value generally feature:**

- **Multiple coordination sites**: Presence of amino, thiol, ether oxygen, pyridine nitrogen, or heterocyclic nitrogen/oxygen atoms enhances Fe coordination.
- **Chelation capability**: Ability to form stable five-membered chelate rings with Fe ions.
- **Structural flexibility**: Flexible chains with additional coordinating groups reduce steric hindrance and facilitate coordination.
- **Electron-withdrawing groups at specific positions**: Increase the acidity of the carboxylic acid, strengthening coordination with Fe ions.
  
**Modifiers predicting a Low Fe/Hf value often feature:**

- **Electron-donating groups at coordination sites**: Amino, hydroxyl, or methyl groups increase electron density, decreasing carboxylic acid acidity and weakening coordination strength.
- **Steric hindrance or intramolecular interactions**: Multiple hydroxyl groups or bulky substituents near coordination sites impede Fe binding due to spatial constraints or hydrogen bonding.
- **Extensive fluorination**: Highly electronegative fluorine atoms withdraw electron density, weakening ligand coordination ability.
- **Lack of additional coordination sites**: Simple carboxylic acids without extra functional groups provide insufficient binding.

By applying these rules, chemists can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst. This understanding aids in the design and selection of modifiers to optimize catalyst performance and enhance reaction yields.

------------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 5,Rule 6
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.5142857142857142; Test Accuracy: 0.0
    Train Support: 0.0; Test Support: 0.0
    Train Confidence: 0.5; Test Confidence: 0.5
    Train Lift: 1.0; Test Lift: NONE
    Train Leverage: 0.0; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define the rules
    rules = [
        {
            'number': 1,
            'description': 'Modifiers that are ω-amino aliphatic carboxylic acids with chain lengths of 5 carbons or more predict a high Fe/Hf value.',
            'function': 'rule1_match',
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers containing thiol groups (-SH) predict a high Fe/Hf value.',
            'patterns': ['[SX2H]'],  # Thiol group
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups at the para position predict a high Fe/Hf value.',
            'function': 'rule3_match',
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Modifiers that are aromatic carboxylic acids with electron-donating groups at the para position predict a low Fe/Hf value.',
            'function': 'rule5_match',
            'prediction': -1
        },
        {
            'number': 6,
            'description': 'Modifiers with multiple hydroxyl groups near the carboxylic acid predict a low Fe/Hf value.',
            'patterns': ['[OX2H]'],  # Hydroxyl group
            'count_threshold': {'[OX2H]': 3},  # At least 3 hydroxyl groups
            'prediction': -1
        },
        # Additional rules can be added here
    ]

    # Compile SMARTS patterns
    for rule in rules:
        if 'patterns' in rule and rule['patterns']:
            rule['compiled_patterns'] = [Chem.MolFromSmarts(p) for p in rule['patterns']]
            if 'count_threshold' in rule:
                rule['pattern_counts'] = {}
                for p in rule['patterns']:
                    count = rule['count_threshold'].get(p, 1)
                    rule['pattern_counts'][p] = count

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = False
                if 'function' in rule:
                    # Use custom function to determine match
                    if rule['function'] == 'rule1_match':
                        match = rule1_match(mol)
                    elif rule['function'] == 'rule3_match':
                        match = rule3_match(mol)
                    elif rule['function'] == 'rule5_match':
                        match = rule5_match(mol)
                    # Add other custom functions as needed
                else:
                    # Use compiled patterns
                    for pat in rule['compiled_patterns']:
                        matches = mol.GetSubstructMatches(pat)
                        if matches:
                            count_needed = rule.get('pattern_counts', {}).get(pat.GetSmarts(), 1)
                            if len(matches) >= count_needed:
                                match = True
                                break
                    else:
                        match = False
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception as e:
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule["number"]}' for rule in rules])
    return df

# Custom function for Rule 1

def rule1_match(mol):
    """
    Checks if the molecule is a linear aliphatic carboxylic acid with an amino group at the terminal position and chain length of 5 carbons or more.
    """
    # Amino group at terminal position
    primary_amino = Chem.MolFromSmarts('[NX3][H][H]')
    # Carboxylic acid group
    carboxylic_acid = Chem.MolFromSmarts('[CX3](=O)[OX1H0-,OX2H1]')
    # Find amino groups
    amino_matches = mol.GetSubstructMatches(primary_amino)
    # Find carboxylic acid groups
    acid_matches = mol.GetSubstructMatches(carboxylic_acid)
    if not amino_matches or not acid_matches:
        return False
    # Check for linear aliphatic chain between amino and acid groups
    for n_match in amino_matches:
        n_atom_idx = n_match[0]
        for c_match in acid_matches:
            c_atom_idx = c_match[0]
            # Find shortest path between N and C atoms
            path = Chem.rdmolops.GetShortestPath(mol, n_atom_idx, c_atom_idx)
            # Exclude N and C atoms from the chain
            chain = path[1:-1]
            # Check chain length
            if len(chain) < 5:
                continue
            # Check if all atoms in chain are carbons
            all_carbons = all(mol.GetAtomWithIdx(idx).GetAtomicNum() == 6 for idx in chain)
            if not all_carbons:
                continue
            # Check if chain is linear (degree 2 for internal carbons)
            linear = all(mol.GetAtomWithIdx(idx).GetDegree() == 2 for idx in chain)
            if linear:
                return True
    return False

# Custom function for Rule 3

def rule3_match(mol):
    """
    Checks if the molecule is an aromatic carboxylic acid with an electron-withdrawing group at the para position.
    """
    # Aromatic carboxylic acid
    aromatic_acid = Chem.MolFromSmarts('[c][C](=O)[O;H1,-]')
    # Electron-withdrawing groups at para position
    ewg_patterns = [
        Chem.MolFromSmarts('[c][N+](=O)[O-]'),  # Nitro group
        Chem.MolFromSmarts('[c][F,Cl,Br,I]')     # Halogens
    ]
    matches = mol.GetSubstructMatches(aromatic_acid)
    if not matches:
        return False
    ring_info = mol.GetRingInfo()
    for match in matches:
        aromatic_c_idx = match[0]
        # Locate the ring containing the aromatic carbon
        rings = [ring for ring in ring_info.AtomRings() if aromatic_c_idx in ring]
        if not rings:
            continue
        ring = rings[0]
        ring_size = len(ring)
        idx_in_ring = ring.index(aromatic_c_idx)
        para_idx_in_ring = (idx_in_ring + ring_size // 2) % ring_size
        para_atom_idx = ring[para_idx_in_ring]
        para_atom = mol.GetAtomWithIdx(para_atom_idx)
        # Check for EWG at para position
        for ewg in ewg_patterns:
            if mol.HasSubstructMatch(ewg, useChirality=False, atomIdxs=[para_atom_idx]):
                return True
    return False

# Custom function for Rule 5

def rule5_match(mol):
    """
    Checks if the molecule is an aromatic carboxylic acid with an electron-donating group at the para position.
    """
    # Aromatic carboxylic acid
    aromatic_acid = Chem.MolFromSmarts('[c][C](=O)[O;H1,-]')
    # Electron-donating groups at para position
    edg_patterns = [
        Chem.MolFromSmarts('[c][NX3;H2,H1,H0]'),  # Amino group
        Chem.MolFromSmarts('[c][OX2H]'),          # Hydroxyl group
        Chem.MolFromSmarts('[c][CH3]')            # Methyl group
    ]
    matches = mol.GetSubstructMatches(aromatic_acid)
    if not matches:
        return False
    ring_info = mol.GetRingInfo()
    for match in matches:
        aromatic_c_idx = match[0]
        # Locate the ring containing the aromatic carbon
        rings = [ring for ring in ring_info.AtomRings() if aromatic_c_idx in ring]
        if not rings:
            continue
        ring = rings[0]
        ring_size = len(ring)
        idx_in_ring = ring.index(aromatic_c_idx)
        para_idx_in_ring = (idx_in_ring + ring_size // 2) % ring_size
        para_atom_idx = ring[para_idx_in_ring]
        para_atom = mol.GetAtomWithIdx(para_atom_idx)
        # Check for EDG at para position
        for edg in edg_patterns:
            if mol.HasSubstructMatch(edg, useChirality=False, atomIdxs=[para_atom_idx]):
                return True
    return False

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

---

**Rule 1**: **Modifiers that are amino acids capable of forming stable five-membered chelate rings with Fe ions predict a **high** Fe/Hf value.**

- **Description**: Amino acids where the amino group and the carboxylate group are positioned to form five-membered chelate rings enhance Fe coordination. This optimal ring size allows for strong and stable binding to Fe ions, increasing Fe incorporation into the catalyst.

- **Example (High Fe/Hf)**:
  - **(2S)-2-aminobutanedioic acid** (Aspartic acid)

- **Counterexample (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): Forms a six-membered ring, which is less favorable for chelation with Fe.

---

**Rule 2**: **Modifiers that are unbranched ω-amino acids with amino (-NH₂) and carboxylic acid (-COOH) groups at opposite ends of an aliphatic chain of five or more carbons predict a **high** Fe/Hf value.**

- **Description**: The terminal amino and carboxylate groups act as bidentate ligands, coordinating simultaneously with Fe ions. The longer aliphatic chain provides flexibility, allowing the molecule to wrap around the Fe ion and form stable chelate complexes, enhancing Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **5-aminopentanoic acid**
  - **7-aminoheptanoic acid**
  - **8-aminooctanoic acid**
  - **(2S)-6-acetamido-2-aminohexanoic acid**

---

**Rule 3**: **Modifiers containing thiol groups (-SH) predict a **high** Fe/Hf value.**

- **Description**: Thiol groups are soft Lewis bases with a strong affinity for transition metals like Fe. The sulfur atom's lone pair effectively coordinates with Fe ions, forming strong bonds and enhancing Fe incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **3-sulfanylpropanoic acid**
  - **4-sulfanylbenzoic acid**
  - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

---

**Rule 4**: **Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro (-NO₂), bromomethyl (-CH₂Br)) at the para position predict a **high** Fe/Hf value.**

- **Description**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion. This enhancement facilitates deprotonation and strengthens coordination with Fe ions, leading to higher Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **4-nitrobenzoic acid**
  - **4-(bromomethyl)benzoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **4-methylbenzoic acid**: Contains an electron-donating methyl group, reducing carboxylate acidity.

---

**Rule 5**: **Modifiers containing a pyridine ring directly connected to a carboxylic acid predict a **high** Fe/Hf value.**

- **Description**: The nitrogen atom in the pyridine ring serves as an additional coordination site for Fe ions. When the pyridine is connected to the carboxylic acid, the molecule can act as a bidentate ligand, forming stable chelate complexes and enhancing Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **4-pyridin-4-ylbenzoic acid**
  - **4-pyridin-4-ylbutanoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **Pyridine-3-carboxylic acid** (Nicotinic acid): The position of the carboxylate group relative to the nitrogen does not favor effective chelation with Fe due to less optimal geometry.

---

**Rule 6**: **Modifiers that are aromatic carboxylic acids with strong electron-donating groups (e.g., amino (-NH₂), hydroxyl (-OH), methoxy (-OCH₃), methyl (-CH₃)) at the ortho or para position predict a **low** Fe/Hf value.**

- **Description**: Electron-donating groups increase electron density on the aromatic ring and carboxylate group, decreasing the acidity of the carboxylic acid. This reduction weakens the ligand's ability to coordinate with Fe ions, leading to lower Fe incorporation.

- **Examples (Low Fe/Hf)**:
  - **4-aminobenzoic acid**
  - **4-hydroxybenzoic acid**
  - **4-methylbenzoic acid**
  - **5-formyl-2-hydroxybenzoic acid**
  - **3-(4-hydroxyphenyl)propanoic acid**
  - **5-(4-hydroxyphenyl)pentanoic acid**

---

**Rule 7**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a **low** Fe/Hf value.**

- **Description**: Lack of extra functional groups capable of coordination results in weaker Fe binding. These modifiers cannot form chelate complexes, leading to lower Fe incorporation into the catalyst.

- **Examples (Low Fe/Hf)**:
  - **Octanoic acid**
  - **4-oxoheptanedioic acid**

---

**Rule 8**: **Modifiers with multiple hydroxyl groups adjacent to the carboxylic acid group predict a **low** Fe/Hf value due to steric hindrance and intramolecular hydrogen bonding.**

- **Description**: Adjacent hydroxyl groups can form intramolecular hydrogen bonds, occupying potential coordination sites and hindering Fe binding. The steric bulk of multiple hydroxyl groups near the carboxylate reduces accessibility for Fe ions.

- **Examples (Low Fe/Hf)**:
  - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (Gluconic acid)
  - **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**

---

**Rule 9**: **Modifiers containing ether linkages (-O-) in their aliphatic chains with a terminal carboxylic acid group predict a **high** Fe/Hf value.**

- **Description**: Ether oxygen atoms can serve as additional coordination sites for Fe ions. The flexibility provided by ether linkages allows the molecule to adopt conformations favorable for chelation, enhancing Fe binding and incorporation into the catalyst.

- **Example (High Fe/Hf)**:
  - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

- **Counterexample (Low Fe/Hf)**:
  - **2-[[1,3-dihydroxy-2-(hydroxymethyl)propan-2-yl]oxy]acetic acid**: Multiple hydroxyl groups may form hydrogen bonds, decreasing coordination with Fe.

---

**Rule 10**: **Modifiers with highly fluorinated aliphatic chains predict a **low** Fe/Hf value due to reduced electron density for coordination.**

- **Description**: Highly electronegative fluorine atoms withdraw electron density from the ligand, decreasing the basicity and nucleophilicity of the coordinating groups. This electron withdrawal weakens the carboxylate's ability to coordinate with Fe ions.

- **Example (Low Fe/Hf)**:
  - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

---

**Rule 11**: **Modifiers that are amino acids with bulky aromatic side chains predict a **low** Fe/Hf value due to steric hindrance affecting Fe coordination.**

- **Description**: Bulky side chains can obstruct the approach of Fe ions to coordination sites or introduce steric strain in potential chelate rings, reducing Fe binding and incorporation into the catalyst.

- **Example (Low Fe/Hf)**:
  - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (Tryptophan)

- **Counterexample (High Fe/Hf)**:
  - **(2S)-2-amino-3-phenylpropanoic acid** (Phenylalanine): Smaller aromatic side chain allows effective coordination, predicting a high Fe/Hf value.

---

**Rule 12**: **Modifiers containing ketone groups adjacent to carboxylic acid groups predict a **low** Fe/Hf value due to competing coordination or steric hindrance.**

- **Description**: Ketone groups near the carboxylate may interfere with Fe coordination either by competing for metal binding or by introducing steric hindrance, reducing Fe incorporation into the catalyst.

- **Examples (Low Fe/Hf)**:
  - **4-formylbenzoic acid**
  - **4-oxoheptanedioic acid**

---

**End of Rules**

---

These rules illustrate how combinations of functional groups and structural features in molecular modifiers influence the Fe/Hf ratio in the catalyst. By considering the underlying physicochemical properties—such as coordination chemistry, electron-donating/withdrawing effects, steric factors, and the ability to form chelate rings—we can predict whether a modifier will lead to a **high** or **low** Fe/Hf value.

**Modifiers predicting a High Fe/Hf value generally feature:**

- **Multiple coordination sites**: Presence of amino, thiol, ether oxygen, or pyridine nitrogen groups enhances Fe coordination through chelation.
- **Chelation capability**: Ability to form stable five-membered chelate rings with Fe ions provides optimal geometry for strong binding.
- **Structural flexibility**: Flexible chains with coordinating groups reduce steric hindrance and facilitate simultaneous coordination.
- **Electron-withdrawing groups at specific positions**: Increase the acidity of the carboxylic acid, strengthening coordination with Fe ions.
- **Heterocyclic rings with coordinating atoms**: Enhance ligand binding due to available lone pairs for coordination.

**Modifiers predicting a Low Fe/Hf value often feature:**

- **Electron-donating groups at coordination sites**: Amino, hydroxyl, or methoxy groups increase electron density, decreasing acidity and weakening coordination strength.
- **Steric hindrance or intramolecular interactions**: Multiple hydroxyl groups or bulky substituents near coordination sites impede Fe binding due to spatial constraints or hydrogen bonding.
- **Highly electronegative substituents**: Fluorination withdraws electron density, reducing coordination ability.
- **Lack of additional coordination sites**: Simple carboxylic acids without extra functional groups provide insufficient binding capacity.
- **Competing functional groups**: Ketone groups adjacent to carboxylates may interfere with coordination.
- **Bulky aromatic side chains**: Large substituents can hinder effective coordination due to steric factors.

By applying these rules, chemists can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst. This understanding aids in the design and selection of modifiers to optimize catalyst performance and enhance reaction yields.

------------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11,Rule 12
1,1,0,0,0,0,0,0,1,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,-1,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,1,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,-1,0,0
0,1,0,0,0,0,0,0,0,0,-1,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,-1,-1,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
0,0,0,0,0,0,0,0,0,-1,0,0
0,0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,-1,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0
1,1,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.6857142857142857; Test Accuracy: 1.0
    Train Support: 0.3142857142857143; Test Support: 0.0
    Train Confidence: 0.7333333333333333; Test Confidence: 0.5
    Train Lift: 1.425925925925926; Test Lift: NONE
    Train Leverage: 0.09387755102040818; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define SMARTS patterns for functional groups
    
    # Carboxylic acid group (-COOH)
    carboxylic_acid = '[CX3](=O)[OX2H1]'
    
    # Amino group (-NH2)
    amino_group = '[NX3H2]'
    
    # Thiol group (-SH)
    thiol_group = '[SX2H]'
    
    # Aromatic ring
    aromatic_ring = 'c1ccccc1'
    
    # Electron-withdrawing groups (EWGs)
    nitro_group = '[$([NX3](=O)=O)]'
    halogen = '[F,Cl,Br,I]'
    bromomethyl_group = '[CH2Br]'
    
    # Electron-donating groups (EDGs)
    amino_substituent = '[NX3H2]'
    hydroxyl_group = '[OX2H]'
    methoxy_group = '[OX2][CH3]'
    methyl_group = '[CH3]'
    
    # Pyridine ring connected to carboxylic acid
    pyridine_carboxylic_acid = '[n]1ccccc1C(=O)O'
    
    # Ether linkage (-O-) in aliphatic chains
    ether_linkage = '[CX4][OX2][CX4]'
    
    # Highly fluorinated aliphatic chains
    fluorinated_chain = '[CX4](F)(F)F'
    
    # Ketone group adjacent to carboxylic acid
    ketone_adjacent_carboxylic_acid = '[CX3](=O)[CX3](=O)[OX2H1]'
    
    # Bulky aromatic side chains (e.g., indole group in tryptophan)
    indole_group = 'c1ccc2c(c1)cc[n]2'
    
    # Multiple hydroxyl groups adjacent to carboxylic acid
    polyol_adjacent_carboxylic_acid = '[CX3](=O)[OX2H1][C;X4][OX2H]'
    
    # Define the rules with their associated patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'Modifiers that are amino acids capable of forming stable five-membered chelate rings with Fe ions predict a high Fe/Hf value.',
            'patterns': [
                amino_group,
                '[CH2][CH2]',  # Two-carbon spacer
                carboxylic_acid
            ],
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'Modifiers that are unbranched ω-amino acids with amino (-NH2) and carboxylic acid (-COOH) groups at opposite ends of an aliphatic chain of five or more carbons predict a high Fe/Hf value.',
            'patterns': [
                amino_group,
                '[CH2]{3,}',  # Chain of three or more CH2 groups
                carboxylic_acid
            ],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'Modifiers containing thiol groups (-SH) predict a high Fe/Hf value.',
            'patterns': [
                thiol_group
            ],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups at the para position predict a high Fe/Hf value.',
            'patterns': [
                aromatic_ring,
                carboxylic_acid,
                '[$([c]c[c][c][c][c](C(=O)O))]',  # Aromatic carboxylic acid
                '[$([c][FX,ClX,BrX,IX,NX3](=O)=O)]'  # EWG at para position
            ],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Modifiers containing a pyridine ring directly connected to a carboxylic acid predict a high Fe/Hf value.',
            'patterns': [
                pyridine_carboxylic_acid
            ],
            'prediction': 1
        },
        {
            'number': 6,
            'description': 'Modifiers that are aromatic carboxylic acids with strong electron-donating groups at the ortho or para position predict a low Fe/Hf value.',
            'patterns': [
                aromatic_ring,
                carboxylic_acid,
                '[$([c][c][c][c][c][c](C(=O)O))]',  # Aromatic carboxylic acid
                '[$([c][NX3H2,OX2H,OX2CH3,CX4H3])]'  # EDG at ortho or para position
            ],
            'prediction': -1
        },
        {
            'number': 7,
            'description': 'Modifiers that are simple aliphatic carboxylic acids without additional coordinating groups predict a low Fe/Hf value.',
            'patterns': [
                carboxylic_acid
            ],
            'exclude_patterns': [
                amino_group,
                thiol_group,
                ether_linkage,
                '[$([NX3])]',   # Exclude any other amines
                '[$([OX2][CX4])]'  # Exclude alcohols and ethers
            ],
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Modifiers with multiple hydroxyl groups adjacent to the carboxylic acid group predict a low Fe/Hf value.',
            'patterns': [
                polyol_adjacent_carboxylic_acid
            ],
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'Modifiers containing ether linkages (-O-) in their aliphatic chains with a terminal carboxylic acid group predict a high Fe/Hf value.',
            'patterns': [
                ether_linkage,
                carboxylic_acid
            ],
            'prediction': 1
        },
        {
            'number': 10,
            'description': 'Modifiers with highly fluorinated aliphatic chains predict a low Fe/Hf value due to reduced electron density for coordination.',
            'patterns': [
                fluorinated_chain
            ],
            'prediction': -1
        },
        {
            'number': 11,
            'description': 'Modifiers that are amino acids with bulky aromatic side chains predict a low Fe/Hf value due to steric hindrance affecting Fe coordination.',
            'patterns': [
                amino_group,
                indole_group
            ],
            'prediction': -1
        },
        {
            'number': 12,
            'description': 'Modifiers containing ketone groups adjacent to carboxylic acid groups predict a low Fe/Hf value due to competing coordination or steric hindrance.',
            'patterns': [
                ketone_adjacent_carboxylic_acid
            ],
            'prediction': -1
        }
    ]
    
    # Compile SMARTS patterns
    for rule in rules:
        compiled_patterns = []
        for smarts in rule.get('patterns', []):
            try:
                pat = Chem.MolFromSmarts(smarts)
                compiled_patterns.append(pat)
            except:
                compiled_patterns.append(None)
        rule['compiled_patterns'] = compiled_patterns
        # Compile exclude patterns if any
        if 'exclude_patterns' in rule:
            compiled_exclude_patterns = []
            for smarts in rule['exclude_patterns']:
                try:
                    pat = Chem.MolFromSmarts(smarts)
                    compiled_exclude_patterns.append(pat)
                except:
                    compiled_exclude_patterns.append(None)
            rule['compiled_exclude_patterns'] = compiled_exclude_patterns
    
    # Initialize results list
    results = []
    
    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = True
                # Check exclude patterns if any
                if 'exclude_patterns' in rule:
                    for pat in rule['compiled_exclude_patterns']:
                        if pat is not None and mol.HasSubstructMatch(pat):
                            match = False
                            break
                    if not match:
                        row.append(0)
                        continue
                # Check required patterns
                for pat in rule['compiled_patterns']:
                    if pat is not None and not mol.HasSubstructMatch(pat):
                        match = False
                        break
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f"Rule {rule['number']}" for rule in rules])
    return df

--------------------------------------------------
    Target Name: Fe/Hf
    GPT Model: o1-preview-2024-09-12
    ML Model: ETC
    Current_Rules:
    **Start of Rules**

---

**Rule 1**: **Modifiers that are linear aliphatic amino acids with amino (-NH₂) and carboxylic acid (-COOH) groups at opposite ends of the chain, with a chain length of five or more carbons, predict a **high** Fe/Hf value.**

- **Description**: These modifiers act as bidentate ligands, chelating Fe ions through terminal amino and carboxylate groups. The extended carbon chain provides flexibility to form stable chelate rings, enhancing Fe incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **5-aminopentanoic acid**
  - **7-aminoheptanoic acid**
  - **8-aminooctanoic acid**
  - **(2S)-6-acetamido-2-aminohexanoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **(2S)-2-aminopentanedioic acid** (Glutamic acid): Amino and carboxyl groups are adjacent, reducing chelation ability.

---

**Rule 2**: **Modifiers containing sulfur-based functional groups, such as thiol (-SH) or thioether (-S-), predict a **high** Fe/Hf value.**

- **Description**: Sulfur atoms possess lone pairs that strongly coordinate with Fe ions. The presence of thiol or thioether groups enhances Fe binding, leading to increased Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **3-sulfanylpropanoic acid**
  - **4-sulfanylbenzoic acid**
  - **2-[[(2S)-2-amino-4-methylsulfanylbutanoyl]amino]acetic acid**

---

**Rule 3**: **Modifiers that are aromatic carboxylic acids with strong electron-withdrawing groups (e.g., nitro (-NO₂), bromo (-Br)) at the para position predict a **high** Fe/Hf value.**

- **Description**: Electron-withdrawing groups increase the acidity of the carboxylic acid by stabilizing the carboxylate anion. This enhanced acidity strengthens coordination with Fe ions, promoting greater Fe incorporation into the catalyst.

- **Examples (High Fe/Hf)**:
  - **4-nitrobenzoic acid**
  - **4-(bromomethyl)benzoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **4-methylbenzoic acid**: The electron-donating methyl group decreases acidity, weakening Fe coordination.

---

**Rule 4**: **Modifiers containing pyridine rings with nitrogen atoms available for coordination predict a **high** Fe/Hf value.**

- **Description**: The lone pair on the pyridine nitrogen serves as an additional coordination site for Fe ions. When the carboxylic acid group does not hinder the nitrogen's lone pair, the modifier can chelate Fe, enhancing Fe incorporation.

- **Examples (High Fe/Hf)**:
  - **4-pyridin-4-ylbenzoic acid**
  - **4-pyridin-4-ylbutanoic acid**

- **Counterexample (Low Fe/Hf)**:
  - **Pyridine-3-carboxylic acid** (Nicotinic acid): The carboxylate at the 3-position may interfere with nitrogen coordination due to unfavorable geometry.

---

**Rule 5**: **Modifiers that are aromatic carboxylic acids with strong electron-donating groups (e.g., hydroxyl (-OH), amino (-NH₂), methoxy (-OCH₃)) at the ortho or para positions predict a **low** Fe/Hf value.**

- **Description**: Electron-donating groups decrease the acidity of the carboxylic acid by destabilizing the carboxylate anion. This reduced acidity weakens the ability of the carboxylate to coordinate with Fe ions, leading to lower Fe incorporation.

- **Examples (Low Fe/Hf)**:
  - **4-aminobenzoic acid**
  - **4-hydroxybenzoic acid**
  - **5-formyl-2-hydroxybenzoic acid**
  - **3-(4-hydroxyphenyl)propanoic acid**
  - **5-(4-hydroxyphenyl)pentanoic acid**

---

**Rule 6**: **Modifiers with multiple hydroxyl groups adjacent to the carboxylic acid group predict a **low** Fe/Hf value due to intramolecular hydrogen bonding and steric hindrance.**

- **Description**: Multiple hydroxyl groups can form intramolecular hydrogen bonds, occupying potential coordination sites. Steric bulk from these groups can hinder Fe ions from accessing the carboxylate, reducing Fe incorporation.

- **Example (Low Fe/Hf)**:
  - **(2R,3S,4R,5R)-2,3,4,5,6-pentahydroxyhexanoic acid** (Gluconic acid)

---

**Rule 7**: **Modifiers that are simple aliphatic carboxylic acids without additional coordinating functional groups predict a **low** Fe/Hf value.**

- **Description**: Without auxiliary coordination sites beyond the carboxylate group, these modifiers cannot form strong interactions with Fe ions. This limitation results in weaker binding and lower Fe incorporation into the catalyst.

- **Example (Low Fe/Hf)**:
  - **Octanoic acid**

---

**Rule 8**: **Modifiers with highly fluorinated aliphatic chains predict a **low** Fe/Hf value due to decreased electron density and weaker coordination ability.**

- **Description**: Fluorine's high electronegativity withdraws electron density, reducing the basicity of the carboxylate and weakening its ability to bind Fe ions.

- **Example (Low Fe/Hf)**:
  - **2,2,3,3,4,4,5,5,5-nonafluoropentanoic acid**

---

**Rule 9**: **Modifiers containing long flexible chains with multiple ether linkages (-O-) and a terminal carboxylic acid predict a **high** Fe/Hf value due to the ability of ether oxygens to coordinate with Fe ions.**

- **Description**: Ether oxygen atoms can serve as additional coordination sites. The flexibility provided by ether linkages allows the molecule to adopt conformations favorable for chelation, enhancing Fe binding and incorporation.

- **Example (High Fe/Hf)**:
  - **2-[2-(2-methoxyethoxy)ethoxy]acetic acid**

---

**Rule 10**: **Modifiers with aldehyde (-CHO) or ketone (C=O) groups adjacent to the carboxylic acid predict a **low** Fe/Hf value due to competing coordination or steric hindrance.**

- **Description**: Carbonyl groups near the carboxylate can compete with it for Fe coordination or introduce steric hindrance. This competition or hindrance reduces the overall binding of Fe ions, resulting in lower Fe incorporation.

- **Examples (Low Fe/Hf)**:
  - **4-formylbenzoic acid**
  - **5-formyl-2-hydroxybenzoic acid**

---

**Rule 11**: **Modifiers containing amino acids with bulky aromatic side chains predict a **low** Fe/Hf value due to steric hindrance affecting Fe coordination.**

- **Description**: Bulky side chains can obstruct Fe ions from accessing coordination sites or introduce strain in potential chelate rings. This steric hindrance reduces Fe binding effectiveness, lowering Fe incorporation into the catalyst.

- **Example (Low Fe/Hf)**:
  - **(2R)-2-amino-3-(1H-indol-3-yl)propanoic acid** (Tryptophan)

- **Counterexample (High Fe/Hf)**:
  - **(2S)-2-amino-3-phenylpropanoic acid** (Phenylalanine): A less bulky aromatic side chain permits better coordination with Fe ions.

---

**End of Rules**

---

These rules illustrate the relationships between molecular modifiers' structural features and their impact on the Fe/Hf ratio in the catalyst. By combining multiple substructures and considering underlying physicochemical properties—such as electron effects, coordination chemistry, and steric factors—the rules provide a predictive framework for assessing new modifiers.

**Modifiers predicting a High Fe/Hf value generally feature:**

- **Multiple coordination sites**: Presence of amino, thiol, ether oxygen, or pyridine nitrogen groups enhances Fe coordination through chelation.
- **Electron-withdrawing groups at strategic positions**: Increase the acidity of the carboxylic acid, strengthening coordination with Fe ions.
- **Structural flexibility**: Flexible chains and functional groups allow the modifier to adopt conformations favorable for Fe binding.
- **Appropriate positioning of functional groups**: Ensures that coordination sites are accessible and can simultaneously bind to Fe ions.

**Modifiers predicting a Low Fe/Hf value often feature:**

- **Electron-donating groups at key positions**: Hydroxyl, amino, methoxy, or methyl groups can decrease carboxylate acidity, weakening coordination with Fe ions.
- **Steric hindrance or intramolecular interactions**: Bulky substituents or multiple hydroxyl groups near coordination sites can impede Fe binding.
- **Competing coordinating groups**: Additional functional groups like carbonyls may compete with carboxylates for Fe coordination or interfere sterically.
- **Lack of sufficient coordination sites**: Simple carboxylic acids without auxiliary coordinating groups provide inadequate Fe binding capability.
- **Unfavorable coordination geometry**: Certain heterocycles or functional group arrangements may not align properly for effective Fe chelation.

By applying these rules, chemists can rationalize and predict the impact of different molecular modifiers on Fe incorporation within the catalyst. This understanding aids in the design and selection of modifiers to optimize catalyst performance and enhance reaction yields.---------------------------------------------------------------


    Current_Matrix:
    Matrix Generator Message:
Rule 1,Rule 2,Rule 3,Rule 4,Rule 5,Rule 6,Rule 7,Rule 8,Rule 9,Rule 10,Rule 11
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,-1,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,-1
0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,0,0,0,0,-1
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,1,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,-1,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0
0,0,0,0,0,0,0,0,0,0,0

---------------------------------------------------------------


    Train Accuracy: 0.5714285714285714; Test Accuracy: 0.0
    Train Support: 0.05714285714285714; Test Support: 0.0
    Train Confidence: 1.0; Test Confidence: 0.5
    Train Lift: 2.0016339869281046; Test Lift: NONE
    Train Leverage: 0.028571428571428574; Test Leverage: NONE
    ----------------------------------------------------------------------------------

    Current Rule Code:
def rule2matrix(smiles_list):
    # Define the rules with their associated SMARTS patterns and predictions
    rules = [
        {
            'number': 1,
            'description': 'High Fe/Hf value: Linear aliphatic amino acids with amino (-NH2) and carboxylic acid (-COOH) groups at opposite ends of the chain, chain length of five or more carbons.',
            'patterns': [
                # Linear chain of five or more carbons with amino and carboxylic acid groups at the ends
                'NCCCCCC(=O)O',  # Simplified pattern for six-carbon chain
                'NCCCCC(=O)O',   # Five-carbon chain
                # General pattern using recursive SMARTS for chains of five or more carbons
                '[NX3;H2][CH2]{5,}[CX3](=O)[OX2H1]',
            ],
            'prediction': 1
        },
        {
            'number': 2,
            'description': 'High Fe/Hf value: Modifiers containing sulfur-based functional groups, such as thiol (-SH) or thioether (-S-).',
            'patterns': [
                '[#16X2H]',  # Thiol group
                '[#16X2][#6]',  # Thioether group
            ],
            'prediction': 1
        },
        {
            'number': 3,
            'description': 'High Fe/Hf value: Aromatic carboxylic acids with strong electron-withdrawing groups at the para position.',
            'patterns': [
                # Para-substituted aromatic carboxylic acids with electron-withdrawing groups
                'c1ccc(cc1)[CX3](=O)[OX2H1]',  # General aromatic carboxylic acid
                # Electron-withdrawing groups at para position
                'c1cc([NX3](=O)=O)ccc1[CX3](=O)[OX2H1]',  # Nitro group
                'c1cc(Br)ccc1[CX3](=O)[OX2H1]',           # Bromo group
            ],
            'prediction': 1
        },
        {
            'number': 4,
            'description': 'High Fe/Hf value: Modifiers containing pyridine rings with nitrogen atoms available for coordination.',
            'patterns': [
                'c1ccncc1',  # Pyridine ring
                '[n]1ccccc1[CX3](=O)[OX2H1]',  # Pyridine connected to carboxylic acid
            ],
            'prediction': 1
        },
        {
            'number': 5,
            'description': 'Low Fe/Hf value: Aromatic carboxylic acids with strong electron-donating groups at ortho or para positions.',
            'patterns': [
                # Aromatic carboxylic acids with electron-donating groups
                '[OX2H][c]',  # Phenol group
                '[NX3;H2][c]',  # Aromatic amine
                'c1cc([OX2H])ccc1[CX3](=O)[OX2H1]',  # Hydroxyl at para position
                'c1cc([NX3;H2])ccc1[CX3](=O)[OX2H1]',  # Amino at para position
            ],
            'prediction': -1
        },
        {
            'number': 6,
            'description': 'Low Fe/Hf value: Modifiers with multiple hydroxyl groups adjacent to the carboxylic acid group.',
            'patterns': [
                '[CX4H](O)[CX4H](O)[CX3](=O)[OX2H1]',  # Adjacent hydroxyl groups
            ],
            'prediction': -1
        },
        {
            'number': 7,
            'description': 'Low Fe/Hf value: Simple aliphatic carboxylic acids without additional coordinating functional groups.',
            'patterns': [
                '[CX3](=O)[OX2H1]',  # Carboxylic acid group
                '[C][C][C][C][C][C](=O)[O]',  # Aliphatic chain
            ],
            'exclude_patterns': [
                '[N,S,O]',  # Exclude presence of other heteroatoms
            ],
            'prediction': -1
        },
        {
            'number': 8,
            'description': 'Low Fe/Hf value: Modifiers with highly fluorinated aliphatic chains.',
            'patterns': [
                '[C](F)(F)(F)',  # Trifluoromethyl group
                '[C](F)(F)F',
            ],
            'prediction': -1
        },
        {
            'number': 9,
            'description': 'High Fe/Hf value: Modifiers containing long flexible chains with multiple ether linkages (-O-) and a terminal carboxylic acid.',
            'patterns': [
                '[OX2][CX4][OX2][CX4][OX2][CX4][OX2][CX3](=O)[OX2H1]',  # Multiple ether linkages ending with carboxylic acid
            ],
            'prediction': 1
        },
        {
            'number': 10,
            'description': 'Low Fe/Hf value: Modifiers with aldehyde (-CHO) or ketone (C=O) groups adjacent to the carboxylic acid.',
            'patterns': [
                '[CX3](=O)[CX3](=O)[OX2H1]',  # Ketone adjacent to carboxylic acid
                '[CX3H1](=O)[CX3](=O)[OX2H1]',  # Aldehyde adjacent to carboxylic acid
            ],
            'prediction': -1
        },
        {
            'number': 11,
            'description': 'Low Fe/Hf value: Modifiers containing amino acids with bulky aromatic side chains.',
            'patterns': [
                '[NX3;H2][CX4][CX3](=O)[OX2H1]',  # Amino acid backbone
                'c1ccccc1',  # Aromatic ring (phenyl group)
            ],
            'prediction': -1
        },
    ]

    # Compile SMARTS patterns
    for rule in rules:
        try:
            rule['compiled_patterns'] = [Chem.MolFromSmarts(pat) for pat in rule['patterns']]
            if 'exclude_patterns' in rule:
                rule['compiled_exclude_patterns'] = [Chem.MolFromSmarts(pat) for pat in rule['exclude_patterns']]
        except Exception as e:
            # Handle compilation errors
            rule['compiled_patterns'] = []
            rule['compiled_exclude_patterns'] = []

    # Initialize results list
    results = []

    # Process each SMILES string
    for smi in smiles_list:
        mol = Chem.MolFromSmiles(smi)
        if mol is None:
            # If the molecule cannot be parsed, append a row of zeros
            results.append([0]*len(rules))
            continue
        row = []
        for rule in rules:
            try:
                match = False
                # Check exclude patterns first
                if 'compiled_exclude_patterns' in rule:
                    for pat in rule['compiled_exclude_patterns']:
                        if mol.HasSubstructMatch(pat):
                            match = False
                            break
                    else:
                        match = True
                else:
                    match = True
                # Check if all patterns are matched
                if match:
                    for pat in rule['compiled_patterns']:
                        if not mol.HasSubstructMatch(pat):
                            match = False
                            break
                # Assign prediction based on match
                if match:
                    row.append(rule['prediction'])
                else:
                    row.append(0)
            except Exception:
                # In case of any error, append 0
                row.append(0)
        results.append(row)
    # Create DataFrame with results
    df = pd.DataFrame(results, columns=[f'Rule {rule["number"]}' for rule in rules])
    return df
--------------------------------------------------